\section{Contact structure based on thermodynamic principles}
\label{sec:thermodynamics}
It has already been argued in the past by several authors that contact geometry is the natural framework for thermodynamics by i.a. \citet{Arnold1991,Arnold1989a,Arnold1989,Arnold1989b}, \citet{Bamberg1988}, \citet{Burke1985} and \citet{Hermann1973}, ultimately leading back to the seminal work of \citet{Gibbs1873}. It is a testament to the brilliance of Gibbs' work that he managed to recognize and describe the correct geometric framework well before the required mathematical infrastructure even came to invention \cite{Wightman1979}. 
In recent years, the contact Hamiltonian formalism has been succesfully applied to thermodynamic theory by e.g. \citet{Mrugala1991,Mrugala2000,Mrugala1984,Mrugala1985,Mrugala1993,Mrugala1996}, \citet{Balian2001}, \citet{VanderSchaft2021a,VanderSchaft2018}, \citet{Maschke2018}, \citet{Bravetti2015}, and \citet{Simoes2020}. 

On the other hand, the applicability of the contact Hamiltonian formalism for mechanical systems with dissipation has been described already by \citet{Bravetti2017}, in particular for the damped harmonic oscillator. However, we argue that his argument is purely mathematical (that is, it produces the correct equations of motion) without interpretation. Indeed, the case is made here that it is also essential to recognize the Hamiltonian function as the total energy in the system, even for dissipative systems: this point is also not addressed by \citeauthor{Bravetti2017}. Precisely these insights lead to a constructive approach for dissipative mechanical systems.

The contact structure in thermodynamics arises as a consequence of the First Law, which asserts that the change in internal energy of the system is equal to the difference between the heat added \emph{to} the system and the work performed \emph{by} the system. Formally, this is stated as
\begin{equation}
    \dd{U} = \eta - \beta,
    \label{eq:thermo_first_law}
\end{equation}
where $U$ is the internal energy of the system, $\eta$ the heat added to the system and $\beta$ the work done by the system on its environment \cite{Bamberg1988,Frankel2012}. Both $\eta$ and $\beta$ are 1-forms that are not exact. This is why it makes no sense (in the context of exterior systems) to denote them by and $\dd{W}$, or worse, using the `inexact' surrogate notation \dj\xspace or $\delta$. The essence of the First Law really is that the difference of the heat and work forms is \emph{closed}. Locally, it can then be written as the gradient of a function, called the \emph{internal energy} $U$ of the system. As a result, the form 
$$ \alpha = \dd{U} - \eta + \beta $$
should pull back to zero over the `allowable' states of the systems.

Classical thermodynamics is usually geared towards systems containing expanding gases or chemical mixtures, and not purely mechanical systems. This is why the next section is concerned with a simple thermodynamic system to elucidate the significance of contact geometry in thermodynamics, after which we proceed in \cref{ssec:thermo_dho} with the application to purely mechanical systems.

\subsection{Contact geometry in thermodynamics} 
%<symbol: P> <expl: Pressure> <tags: letter, thermo>
%<symbol: V> <expl: Volume> <tags: letter, thermo>
%<symbol: T> <expl: Temperature> <tags: letter, thermo>
%<symbol: R> <expl: Universal gas constant> <tags: letter, thermo>
%<symbol: n> <expl: Amount of substance> <tags: letter, thermo>
The thermodynamic state of a system is given by a collection of thermodynamic state variables (or `properties'). For example, for an ideal gas in a piston, we may consider its volume $V$, temperature $T$ and pressure $P$. However, we also know that, for an ideal gas
\begin{equation}
    PV = nRT,
    \label{eq:ideal_gas}
\end{equation}
with $n$ is the amount of substance (measured in \si{\mole}), and $R = \SI{8.314}{\joule \per \mole \per \kelvin}$ is the ideal gas constant.  Hence, for a constant number of moles the actual state of the system is dictated only by two state properties, for the ideal gas law allows us to find the other if two out of three are given. The states of the system that are thermodynamically meaningful therefore live on a \emph{two-dimensional submanifold} of $\real^3$. Any selection of two state properties may serve as coordinates for this submanifold. However, due to this ambiguity, it is usually more convenient to consider the larger three-dimensional manifold together with the constraint as opposed to `spending' it \cite{Balian2001, Giancoli2014}.

Now, if we are allowed to add heat to the gas in the piston, or we use its expansion to perform work on the environment, \cref{eq:ideal_gas} will not suffice, because it does not contain \emph{all} the thermodynamic information of the system. The additional information is supplied (for example) in terms of the entropy $S$ in the system. A \emph{fundamental thermodynamic relation}, expresses a thermodynamic potential, such as the internal energy $U$, in terms of the extensive variables in the system. For the ideal gas, the fundamental relation is of the form $U = U(S, V)$, for the entropy $S$ and the volume $V$ are the extensive state properties of the system. The choice of the internal energy as the thermodynamic potential is certainly not unique; we may also invert the relation in favor of the entropy or use other potentials obtained through a Legendre transform, such as the Gibbs free energy, Helmholtz free energy, enthalpy etc. In particular, we refer to the specification of a system in terms of internal energy as the \emph{energy representation}, and to a specification in terms of entropy as the \emph{entropy representation} \cite{VanderSchaft2021a}.

In the spirit of the preceding discussion, we now consider a five-dimensional space to describe the complete thermodynamic state of the system. Coordinates for this space are the internal energy and entropy in addition to the pressure, volume and temperature considered earlier. This space is referred to as the \emph{thermodynamic phase space}. Again, we are not to choose these variables completely independent from each other, since they are subject to constraints. The First Law of thermodynamics states that
$$ \dd{U} = \eta - \beta, $$
%<symbol: U> <expl: Internal energy> <tags: letter, thermo>
%<symbol: E> <expl: (Mechanical) energy> <tags: letter, thermo>
%<symbol: \eta> <expl: Heat 1-form> <tags: greek, thermo>
%<symbol: \beta> <expl: Work 1-form> <tags: greek, thermo>
%<symbol: S> <expl: Entropy> <tags: letter, thermo>
%<symbol: p> <expl: Momentum> <tags: letter, physics>
%<symbol: q> <expl: Position> <tags: letter, physics>
where we have that $ \beta = P\dd{V} $ and, according to the Second Law of Thermodynamics, $\eta = T\dd{S}$. As such, the First Law states that the form
\begin{equation} 
    \alpha_\text{G} \coloneq \dd{U} - T\dd{S} + P\dd{V}
    \label{eq:gibbs_relation}
\end{equation}
should pull back to zero on the allowable states. This is known as Gibbs' fundamental relation. By definition --- given that the internal energy is a function of the extensive state variables ---  we furthermore know that
$$ \dd{U} \coloneq \pdv{U}{V}\dd{V} + \pdv{U}{S}\dd{S}.$$
As such, the condition that $\alpha = 0$ defines an two-dimensional submanifold of the larger five-dimensional space determined by the conditions
\begin{equation}
    T = \pdv{U}{S} \qquad P = -\pdv{U}{V}. 
\end{equation}
The form $\alpha_\text{G}$ given by Gibbs' relation is a contact form on the thermodynamic phase space, since
$$ \wedgep{\alpha_G}{(\dd{\alpha_G})^2} = 2\,\dd{U}\wedgep{\wedgep{\dd{S}}{\dd{T}}}{\wedgep{\dd{P}}{\dd{V}}}, $$
which is a top (or volume) form on the thermodynamic phase space.\footnote
{
    Because 
    \begin{equation*} 
        \begin{split}
            (\dd{\alpha_\text{G}})^2 &= (\wedgep{\dd{S}}{\dd{T}} + \wedgep{\dd{P}}{\dd{V}})^2 \\
                            &= \wedgep{\wedgep{\dd{S}}{\dd{T}}}{\wedgep{\dd{P}}{\dd{V}}} + \wedgep{\wedgep{\dd{P}}{\dd{V}}}{\wedgep{\dd{S}}{\dd{T}}} \\
                            &= 2\wedgep{\wedgep{\dd{S}}{\dd{T}}}{\wedgep{\dd{P}}{\dd{V}}} \\
        \end{split}
    \end{equation*}
    since the permutation $ (S, T, P, V) \mapsto (P, V, S, T) $ is even.
}
%<symbol: \wedgep{}{}> <expl: Wedge (or exterior) product> <tags: misc, math>
%<symbol: \intpr{}{}> <expl: Interior product> <tags: misc, math>
%<symbol: \dd{}> <expl: Exterior derivative> <tags: misc, math>
%<symbol: \lied{X}{}> <expl: Lie derivative with respect to the vector field $X$> <tags: misc, math>

%<symbol: M> <expl: Phase space; general manifold> <tags: letter, math>
%<symbol: Q> <expl: Configuration space> <tags: letter, math>
Submanifolds of the thermodynamic phase space on which $\alpha_\text{G}$ pulls back to zero are called integral submanifolds of $\alpha_\text{G}$. Due to the nondegeneracy of the contact form, integral submanifolds are at most two-dimensional; the \emph{maximal} integral submanifolds are called \emph{Legendre submanifolds}. Clearly, Legendre submanifolds play a pivotal role in this framework because they define the thermodynamically allowable states (\citet{Balian2001} call them \emph{thermodynamic manifolds}). Trajectories in the thermodynamic phase space are only physically meaningful if they lie in Legendre submanifolds.

\subsection{Contact structure of the damped oscillator}
\label{ssec:thermo_dho}

%\paragraph{Extensive and intensive variables} In contrast to thermodynamics, there does not seem to be an unequivocal distinction between extensive and intensive variables for mechanical systems. Although it is not strictly a problem from a mathematical standpoint, the internal energy is usually stated to be a function of the extensive state properties. To incorporate kinetic energy, the internal energy function should be a function of either momentum or velocity: the former is used necessarily used in the Hamiltonian formalism. However, it is not so clear whether momentum is intensive rather than extensive. For example, \citet{Franksen1969} argues that momentum should be considered as extensive, for mass is related to the `size' of the system. 
When applying the thermodynamic framework discussed in the previous section to mechanical systems, we make the distinction between macroscopic and microscopic states. That is, energy can be stored in the movement of small particles, which does not manifest itself as an \emph{observable} movement of the overall system, but rather as \emph{temperature}. The associated kinetic energy is called internal energy $U$. On the other hand, the movement of the mass in the oscillator system \emph{is} observable, and we consider its kinetic energy to be of a different kind. In addition, there is the energy which arises as a consequence of external potentials. Both the macroscopic kinetic energy and potential energy are subsumed in the \emph{mechanical energy} $E$. This distinction between mechanical and internal energy is rather artificial, but it fits better in the notational and conceptual conventions of both mechanics and thermodynamics. The total energy in the system is then the sum of its total mechanical energy and total internal energy.

\subsubsection{Thermodynamics of the damped oscillator}
In the damped oscillator system, internal energy can be stored either in the form of macroscopic kinetic energy in the mass, potential energy in the spring and as microscopic kinetic energy of the `heat bath'. The notion of a `heat bath' is rather loosely defined: it can encompass the fluid in the damper, a body of surrounding air (or both), or anything to which we may attach the conceptual picture of a reservoir that absorbs the dissipated energy in the form of heat. If the heat bath is heterogeneous (for example, containing damper fluid and the surrounding air), it will not have a single temperature. We will not be concerned with all these possibilities and consider a single heat bath with single temperature: generalizations to more complex thermodynamic systems are immediate.

The overall system (i.e. mass, spring and heat bath) is assumed to be completely isolated: there is no exchange of energy nor matter with the environment. We therefore have, according to the First Law:
\begin{equation}
    \dd{(U + E)} = 0. 
    \label{eq:dho_first_law}
\end{equation}
The mechanical energy of the mass-spring-damper system is a function of the position $q$ of the mass and the momentum $p$ of the mass, that is
\begin{equation}
    E \coloneq E(p, q) = \frac{p^2}{2m} + \frac{1}{2}kq^2. 
    \label{eq:dho_mech_energy}
\end{equation}
Furthermore, we assume that the heat bath is the only part of the system that can store entropy, and that it has no other degrees of freedom:
\begin{equation}
    U \coloneq U(S).  
    \label{eq:dho_int_energy}
\end{equation}
Let uw now decompose the system analogous to $E$ and $U$ into two subsystems, one containing the mass and the spring and one the heat bath, as illustrated in \cref{fig:oscillator_thermo}. 
\begin{figure}[ht!]
    \centering
    \input{media/tikz/damper_oscillator_thermo}
    \caption{System boundaries of the damper-oscillator system. The mechanical subsystem stores mechanical energy $E$ in the form of kinetic and potential energy, while the heat bath stores internal energy in the form of heat. They interface through the action of the damper.}
    \label{fig:oscillator_thermo}
\end{figure}
Through the dissipative action of the damper, energy flows from the mechanical subsystem to the heat bath. We can apply the First Law to the subsystems separately, too: the first subsystem performs work on the damper, which manifests itself as heat added to the heat bath. We therefore have
\begin{equation}
    \begin{split}
        \dd{E} &= \pdv{E}{p}\dd{p} + \pdv{E}{q}\dd{q} = -\beta, \\[0.2cm]
        \dd{U} &= \pdv{U}{S}\dd{S} = \eta, \\
    \end{split}
\end{equation}
where $\beta$ is the (differential) work done \emph{by} the mechanical subsystem on the damper and $\eta$ is the (differential) heat added \emph{to} the second subsystem as a result of this. From the preceding discussion we have that, because the total system is isolated, that $ \beta = \eta $; i.e. all the work done by the damper enters the fluid as heat. For a linearly damped system, the work form is by definition equal to 
\begin{equation}
    \beta \coloneq \gamma p \dd{q},
    \label{eq:dho_work_form}
\end{equation}
with $\gamma$ being the damping coefficient as defined in \cref{tab:dho_params}. The above equations dictate a contact structure on the three-dimensional phase space $M$ constituted by the internal energy $U$, the momentum $p$ and the position $p$, or equivalently, on the `other' space $\tilde{M}$ with the mechanical energy $E$, $p$ and $q$:
$$ \dd{U} - \gamma p \dd{q} \: \in \: \ctbundle{M}, \qquad \quad \dd{E} + \gamma p \dd{q} \: \in \: \ctbundle{\tilde{M}}. $$
Formally, we have that the position $q$ is a coordinate of the configuration space $Q$, to which we attach the cotangent bundle whose fibers contain the momentum: $ (q, p) \in \ctbundle{Q}$. The latter space is then extended with a single dimension for either $U$ or $E$. Both spaces $M$ and $\tilde{M}$ are isomorphic, but are equipped with a different contact structure; i.e. $M \cong \tilde{M} = \real \times \ctbundle{Q} \cong \real^3$. Because the topology of these spaces is trivial, we assume the contact forms to be defined globaly: they are \emph{exact} contact manifolds.

In the following section, we define the contact Hamiltonian system on $M$ (i.e. in terms of the internal energy), and denote the associated contact form by $\alpha$, i.e.
\begin{equation}
    \alpha \coloneq \dd{U} - \gamma p \dd{q}
    \label{eq:dho_contact_form_thermo}
\end{equation}
It is important to keep in mind that contact forms are by definition nonunique: $\alpha$ is only determined up to multiplication by a function $f \in \functions{M}$ without zeros --- that is to say, any of those forms gives rise to the same contact \emph{structure}.

%As such, the contact form dictated by the First Law on the three-dimensional manifold constituted by the internal energy of the heat bath $U$, the momentum of the mass $p$ and the position of the mass $q$
%\begin{equation}
%    \alpha_2 = \dd{U}_2 - \gamma p \dd{q};
%    \label{eq:dho_contact_form_thermo}
%\end{equation}
%or equivalently
%\begin{equation*}
%    \alpha_1 = -\dd{U}_1 + \gamma p \dd{q}.
%\end{equation*}
\subsubsection{Contact Hamiltonian function for the damped oscillator}
A contact Hamiltonian system is a triple $(M, \alpha, H)$, where $M$ is a manifold, $\alpha \in \ctbundle{M}$ is a contact form on the manifold and $H \in \functions{M}$ is the Hamiltonian function that generates the dynamics. Given the contact form in \cref{eq:dho_contact_form_thermo}, we are now to find the contact Hamiltonian function to complete the picture of the contact Hamiltonian system. Just like in the conservative case with a symplectic structure, the contact structure provides a mapping between the functions on the manifold and the `contact Hamiltonian vector fields' on that manifold. For \emph{any} given function $H$ (which does not necessarily has to be `the' Hamiltonian), the associated \emph{Hamiltonian vector field} is denoted by $X_H$. This mapping is discussed in detail in \cref{sec:contact_ham_systems}. We really are interested in the \emph{inverse} mapping, that is to say, from the vector field to the Hamiltonian function, since the dynamics of the damped oscillator can be easily derived from Newtonian mechanics (\cref{eq:dho_eom}). 

The trick is to separate the Hamiltonian vector field into a \emph{horizontal} vector field $X^\text{hor}_H$  and a vertical vector field $X^\text{ver}_H$; according to the following decomposition of the tangent bundle to $M$ \cite{Libermann1987}
$$ \tbundle{M} = \ker \alpha \oplus \ker \dd{\alpha},$$
where the vertical field is in the kernel of $ \dd{\alpha}$, the horizontal vector field in the kernel of $\alpha$, and $\oplus$ denotes the Whitney sum. The Hamiltonian vector field is then 
$$ X_H = X_H^\text{ver} + X_H^\text{hor.}, $$
with $X_H^\text{ver} \in \ker \dd{\alpha}$ and $X_H^\text{hor} \in \ker \alpha$.

Furthermore, we impose two conditions on the Hamiltonian vector field $X_H$ associated to the Hamiltonian $H$:
\begin{itemize}
    \item First, we have that $ H = -\intpr{X_H}{\alpha} $. 
    \item Secondly, $\lied{X_H}\alpha = s \alpha $ with $s$ some function; which is to say that $X_H$ is an infinitesimal contact transformation. 
\end{itemize}

The vertical part of the vector field is easy to find based on the first condition, and is equal to
\begin{equation}
    X_H^\text{ver} = - H R_\alpha, 
    \label{eq:vertical_vf}
\end{equation}
where $R_\alpha$ refers to the Reeb vector field of the contact form. In components, the Reeb vector field is
$$ 
    R_\alpha = \pdv{}{U}.
$$ 
\begin{remark}
    Clearly, the vertical part of the vector field is always colinear with the Reeb vector field. However, this does not preclude the horizontal vector field to have a component in the direction of the Reeb vector field as well; as long as it is part of the kernel of $\alpha$. It is therefore not the case that the horizontal vector field is symplectic, which one might intuitively assume.
\end{remark}

For reasons that will become later, it is the horizontal part is our prime interest, rather than the vertical part. The horizontal vector field is obtained using the second (and first) condition, which is equivalent to (by virtue of Cartan's magic formula, see \cref{sec:contact_ham_systems})
\begin{equation}
    \intpr{X_H^\text{hor}}{\dd{\alpha}} = \dd{H} - s \alpha, 
    \label{eq:hor_vfield_condition}
\end{equation}
with $s = \intpr{R_\alpha}{\dd{H}} = \pdv{H}{U}$. Hence, the function $s$ reflects the dependence of the Hamiltonian function on the variable $U$. Let us now reason from the standpoint of a classical `symplectic' Hamiltonian system. In that case, the Hamiltonian would be equal to the mechanical energy, and the Hamiltonian vector field (associated to $E$) is defined through the relation
\begin{equation}
    \intpr{X_E}{\omega} = \dd{E}, 
    \label{eq:symplectic_ideal}
\end{equation}
with $\omega = \wedgep{\dd{q}}{\dd{p}}$ being the symplectic 2-form. Furthermore, observe that 
$$
    \dd{\alpha} = \gamma \wedgep{\dd{q}}{\dd{p}} = \gamma\,\omega. 
$$
As such, \cref{eq:hor_vfield_condition} becomes
$$
    \gamma \qty( \intpr{X_H^\text{hor}}{\omega} ) = \underbrace{\dd{H} - \pdv{H}{U}\dd{U}}_\text{closed form} + \underbrace{\pdv{H}{U} \gamma p\dd{q}}_\text{dissipation}.
$$
The left hand side of the above expression and the symplectic case given by \cref{eq:symplectic_ideal} look very much alike. The interior product of $X_H$ and $\omega$ can decidedly not produce a closed form (which the left two terms on the right hand side are), because then $X_H$ would be a symplectic vector field. Hence, the rightmost term represents the `deficit' from a purely symplectic vector field: the work form multiplied by $\pdv{H}{U}$. The other part of the right hand side should then be analogous to the purely symplectic case (multiplied by $\gamma$); that is to say, it is equal to $\dd{E}$. This means that 
$$ \dd{H}  = \gamma \dd{E} + \pdv{H}{U}\dd{U}. $$
Furthermore, choose $ \displaystyle \pdv{H}{U} \coloneq \gamma $, such that
$$ \dd{H} = \gamma (\dd{E} + \dd{U}). $$
Therefore the contact Hamiltonian is equal to
\begin{equation}
    H = \gamma (E + U) = \gamma \qty(\frac{p^2}{2m} + \frac{1}{2}kq^2 + U), 
\end{equation}
at least up to the addition of a closed form (i.e. a first integral or total differential). The Hamiltonian is therefore equal to the total energy of the system multiplied by the damping coefficient. The horizontal component of the Hamiltonian vector field is then
$$ 
    X^\text{hor}_H = \frac{p}{m}\pdv{}{q} - ( kq + \gamma p)\pdv{}{p} - \gamma \frac{p^2}{m}\pdv{}{U}.
$$
This vector field gives the correct dynamics for $q$ and $p$. The rate of change of $U$ (by the horizontal vector field) is given by the $ 
\gamma \frac{p^2}{m}$, which is precisely equal to the power dissipated by the damper. As such, it seems that the correct dynamics are entirely represented by the horizontal vector field. On the other hand, the vertical vector field, given by \cref{eq:vertical_vf}, is proportional to the numerical value of the Hamiltonian, and it also contributes to the time-rate of change of $U$. The presence of the vertical vector field gives rise to an additional exponential growth (since $X_H^\text{ver}$ is proportional to the Hamiltonian, which contains $U$ itself). Hence, if we we want to impose that $U$ indeed be the internal energy of the heat bath, the \emph{vertical vector field must vanish}. This is only the case if the Hamiltonian is numerically equal to zero, i.e. $H = 0$. From a thermodynamic standpoint, energy is only determined up to an additive constant, so this assertion would be admissible from a conceptual standpoint. Additionally, a value of 0 for the total energy is a common convention in literature, see for example \citet{Fermi1936}. 

The preceding arguments do not provide a sound mathematical basis for this particular assumption (that $H = 0$). Indeed, we could (and should) be leery of cancelling terms using zero factors, for it often leads to unanticipated consequences or even downright contradictions. The fact that $H = 0$ is crucial for its interpretation as (the scaled) total energy of the system; this point is missed entirely by many applied texts on this subject, including \citet{Bravetti2017}, but also \citet{valcazar2019}. Leaving the vertical vector field in leads to extra `parasetic' dynamics that are unphysical and delude us from the actual significance of the variable $U$.

Now to the mathematics. Recall that by definition $H = \intpr{X_H}{\alpha}$. In the previous section we defined Legendre submanifolds as manifolds on which the contact form pulls back to zero: in other words, tangent vectors to a Legendre manifold produce zero when contracted with the contact form. So, $H$ measures in essence how `non-Legendrian' an integral manifold of $X_H$ is. We have stipulated earlier that Legendre submanifolds are the only ones with physical meaning, which is why this condition makes sense. If $H \neq 0$, trajectories either approach a Legendre submanifold (stable), i.e. becoming tangent in the limit for time to infinity, or diverge from it (unstable). Furthermore, since the Hamiltonian is defined through the contact structure, and the contact structure is only defined up to a 

