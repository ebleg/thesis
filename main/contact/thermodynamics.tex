\section{Contact structure from thermodynamics}
\label{sec:thermodynamics}
It has already been argued in the past by several authors that contact geometry is the natural framework for thermodynamics by i.a. \citet{Arnold1991,Arnold1989a,Arnold1989,Arnold1989b}, \citet{Bamberg1988}, \citet{Burke1985} and \citet{Hermann1973}, ultimately leading back to the seminal work of \citet{Gibbs1873}. It is a testament to the brilliance of Gibbs' work that he managed to recognize and describe the correct geometric framework well before the required mathematical infrastructure even came to invention \cite{Wightman1979}. 
In recent years, the contact Hamiltonian formalism has been succesfully applied to thermodynamic theory by e.g. \citet{Mrugala1991,Mrugala2000,Mrugala1984,Mrugala1985,Mrugala1993,Mrugala1996}, \citet{Balian2001}, \citet{VanderSchaft2021a}, \citet{Bravetti2015}, and \citet{Simoes2020}. Interestingly, the applicability of the contact Hamiltonian formalism for mechanical systems with dissipation has been described already by \citet{Bravetti2017}, in particular for the damped harmonic oscillator. However, we argue that his argument is purely mathematical (that is, it produces the correct equations of motion) without interpretation. Indeed, the case is made here that it is also essential to recognize the Hamiltonian function as the total energy in the system, even for dissipative systems; this point is also not addressed by \citeauthor{Bravetti2017}. Precisely these insights lead allow us to use the theory from thermodynamics to find a constructive approach to dissipative systems.

The contact structure in thermodynamics arises as a consequence of the First Law, which says that the change in internal energy of the system is equal to the difference between the heat added \emph{to} the system and the work performed \emph{by} the system. Formally, this is stated as
\begin{equation}
    \dd{U} = \eta - \beta,
    \label{eq:thermo_first_law}
\end{equation}
where $U$ is the internal energy of the system, $\eta$ the heat added to the system and $\beta$ the work done by the system on its environment \cite{Bamberg1988,Frankel2012}. Both $\eta$ and $\beta$ are 1-forms that are not exact.  This is why it makes no sense (in the context of exterior systems) to denote them by \dj and $\dd{W}$, or worse, using the `inexact' surrogate notation $\text{Ä‘}$ or $\delta$. The essence of the First Law really is that the difference of the heat and work forms is \emph{closed}. Locally, it can then be written as the gradient of a function, called the \emph{internal energy} $U$ of the system. As a result, the form 
$$ \alpha = \dd{U} - \eta + \beta $$
should pull back to zero over the `allowable' states of the systems.

Classical thermodynamics is usually geared towards systems containing expanding gases or chemical mixtures, and not purely mechanical systems. This is why in the next section is first applied to a simple thermodynamic system to elucidate the significance of contact geometry in thermodynamics, after which \cref{ssec:thermo_dho} is concerned with the application to purely mechanical systems.

\subsection{Contact structures in thermodynamics} 
%<symbol: P> <expl: Pressure> <tags: letter, thermo>
%<symbol: V> <expl: Volume> <tags: letter, thermo>
%<symbol: T> <expl: Temperature> <tags: letter, thermo>
%<symbol: A> <expl: Test> <tags: letter, thermo>
%<symbol: R> <expl: Universal gas constant> <tags: letter, thermo>
%<symbol: n> <expl: Amount of substance> <tags: letter, thermo>
The thermodynamic state of a system is given by a collection of thermodynamic state variables (or `properties'). For example, for an ideal gas in a piston, we may consider its volume $V$, temperature $T$ and pressure $P$. However, we also know, that for an ideal gas, the following relation must hold:
\begin{equation}
    PV = nRT,
    \label{eq:ideal_gas}
\end{equation}
with $n$ is the amount of substance (measured in \si{\mole}), and $R = \SI{8.314}{\joule \per \mole \per \kelvin}$ is the ideal gas constant.  Hence, for a constant number of moles the actual state of the system is dictated only by two state properties, for the ideal gas law allows us to find the other if two out of three are given. The states of the system that are thermodynamically meaningful therefore live on a \emph{two-dimensional submanifold} of $\real^3$. Any selection of two state properties may serve as coordinates for this submanifold. However, due to this ambiguity, it is usually more convenient to consider the larger three-dimensional manifold together with the constraint  \cite{Balian2001, Giancoli2014}.

Now, if we are allowed to add heat to the gas in the piston, or we use its expansion to perform work on the environment, \cref{eq:ideal_gas} will not suffice because it does not contain \emph{all} the thermodynamic information of the system. The additional information is supplied (for example) in terms of the entropy $S$ in the system. A \emph{fundamental thermodynamic relation}, expresses a thermodynamic potential, such as the internal energy $U$, in terms of the extensive variables in the system. For the ideal gas, the fundamental relation is of the form $U = U(S, V)$, for the entropy $S$ and the volume $V$ are the extensive state properties of the system. The choice of the internal energy as the thermodynamic potential is certainly not unique; we may also invert the relation in favor of the entropy or use other potentials obtained through a Legendre transform, such as the Gibbs free energy, Helmholtz free energy, enthalpy etc. In particular, we refer to the specification of a system in terms of internal energy as the \emph{energy representation}, and to a specification in terms of entropy as the \emph{entropy representation} \cite{VanderSchaft2021a}.

In the spirit of the preceding discussion, we now consider a five-dimensional space to describe the complete thermodynamic state of the system. Coordinates for this space are the internal energy and entropy in addition to the pressure, volume and temperature considered earlier. This space is referred to as the \emph{thermodynamic phase space} $M$. Again, we are not to choose these variables completely independent from each other, since they are subject to constraints. The First Law of thermodynamics states that
$$ \dd{U} = \eta - \beta, $$
where we have that $ \beta = P\dd{V} $ and, according to the Second Law of Thermodynamics, $ \eta = T\dd{S} $. As such, the First Law states that the form
\begin{equation} 
    \alpha = \dd{U} - T\dd{S} + P\dd{V}
    \label{eq:gibbs_relation}
\end{equation}
should pull back to zero on the allowable states. This relation is known as Gibbs' fundamental relation. By definition --- given that the internal energy is a function of the extensive state variables ---  we furthermore have that
$$ \dd{U} \coloneq \pdv{U}{V}\dd{V} + \pdv{U}{S}\dd{S}.$$
As such, the condition that $\alpha = 0$ defines an two-dimensional submanifold of the larger five-dimensional space for which we have:
\begin{equation}
    T = \pdv{U}{S} \qquad P = -\pdv{U}{V}. 
\end{equation}
The form $\alpha$ given by Gibbs' relation is a contact form on the thermodynamic phase space, since
$$ \wedgep{\alpha}{(\dd{\alpha})^2} = 2\,\dd{U}\wedgep{\wedgep{\dd{S}}{\dd{T}}}{\wedgep{\dd{P}}{\dd{V}}}, $$
which is a top form on the thermodynamic phase space.\footnote
{
    Because 
    \begin{equation*} 
        \begin{split}
            (\dd{\alpha})^2 &= (\wedgep{\dd{S}}{\dd{T}} + \wedgep{\dd{P}}{\dd{V}})^2 \\
                            &= \wedgep{\wedgep{\dd{S}}{\dd{T}}}{\wedgep{\dd{P}}{\dd{V}}} + \wedgep{\wedgep{\dd{P}}{\dd{V}}}{\wedgep{\dd{S}}{\dd{T}}} \\
                            &= 2\wedgep{\wedgep{\dd{S}}{\dd{T}}}{\wedgep{\dd{P}}{\dd{V}}} \\
        \end{split}
    \end{equation*}
    since the permutation $ (S, T, P, V) \mapsto (P, V, S, T) $ is even.
}
Manifolds on which $\alpha$ pulls back to zero are called integral submanifold. Due to the nondegeneracy of the contact form, these submanifolds are of dimension 2; these maximal integral submanifolds are called \emph{Legendre submanifolds}. Clearly, Legendre submanifolds play a pivotable role in this framework because they define the thermodynamically allowable states (\citet{Balian2001} call them \emph{thermodynamic manifolds}).

\subsection{Thermodynamics of the damped oscillator}
\label{ssec:thermo_dho}
\paragraph{Extensive and intensive variables} In contrast to thermodynamics, there does not seem to be an unequivocal distinction between extensive and intensive variables for mechanical systems. Although it is not strictly a problem from a mathematical standpoint, the internal energy is usually stated to be a function of the extensive state properties. To incorporate kinetic energy, the internal energy function should be a function of either momentum or velocity: the former is used necessarily used in the Hamiltonian formalism. However, it is not so clear whether momentum is intensive rather than extensive. For example, \citet{Franksen1969} argues that momentum should be considered as extensive, for mass is related to the `size' of the system. 

\paragraph{Contact structure} For the damped harmonic oscillator, we consider the \emph{overall} system to be completely isolated: that is, there is no energy in the form of work or heat added to the system (for we consider the damper part of the system itself). As a result, the First Law simply states that
$$ \dd{U} = 0. $$
The internal energy of the mass-spring-damper system is a function of the position $q$ of the mass, the momentum $p$ of the mass and the entropy $S$ generated by the damper, i.e.
$$ U = U(q, p, S). $$
In this system, internal energy can be stored either in the form of macroscopic kinetic energy in the mass, potential energy in the spring and as microscopic kinetic energy of the damper fluid. Please note that the damper fluid is rather loosely defined: it can also encompass a body of surrounding air, or anything to which we may attach the conceptual picture of a `heat bath' that absorbs the dissipated energy in the form of heat. Furthermore, we assume that the heat bath is the only part of the system that can store entropy. Let uw now decompose the system into two subsystems: first, the mass-spring system storing the mechanical energy. 
The total internal energy then becomes:
$$ U(q, p, S) = U_1(q, p) + U_2(S) = \frac{p^2}{2m} + \frac{1}{2}kq^2 + U_2(S). $$
If specific assumptions are made about the nature of the heat bath, an explicit expression for $U_2$ may be found as well (e.g. an ideal gas), but we will leave this possibility open for now. The decomposition into the two subsystems is illustrated by \cref{fig:oscillator_thermo}.
\begin{figure}[ht!]
    \centering
    \input{media/tikz/damper_oscillator_thermo}
    \caption{Blabla}
    \label{fig:oscillator_thermo}
\end{figure}
Because there is transfer of energy within the system, we must apply the First Law these two subsystems separately as well. We know that the first subsystem performs work on the damper fluid, which manifests itself as heat added to the second subsystem. We therefore have
\begin{equation}
    \begin{split}
        \dd{U}_1 &= -\beta_1, \\
        \pdv{U_1}{p}\dd{p} + \pdv{U_1}{q}\dd{q} &= -\beta_1, \\[0.2cm]
        \dd{U}_2 &= \eta_2, \\
        \pdv{U_2}{S}\dd{S} &= \eta_2, \\
    \end{split}
\end{equation}
where $\beta_1$ is the (differential) work done by the mechanical subsystem and $\eta_2$ is the (differential) heat added to the second subsystem. From the preceding discussions we have that, because the total system is isolated, that $ \beta_1 = \eta_2 $; i.e. all the work done by the damper enters the fluid as heat. For a linearly damped system, the work form is equal to 
$$ \beta \coloneq \gamma p \dd{q}. $$
As such, the contact form dictated by the First Law on the three-dimensional manifold constituted by the internal energy of the heat bath $U_2$, the momentum of the mass $p$ and the position of the mass $q$
\begin{equation}
    \alpha_2 = \dd{U}_2 - \gamma p \dd{q};
    \label{eq:dho_contact_form_thermo}
\end{equation}
or equivalently
\begin{equation*}
    \alpha_1 = -\dd{U}_1 + \gamma p \dd{q}.
\end{equation*}

Given this contact structure, we are now to find the contact Hamiltonian function to complete the picture of the contact Hamiltonian system. A contact Hamiltonian system is a triple $(M, \alpha, H)$, where $M$ is a manifold, $\alpha$ is a contact structure on the manifold and $H$ is the Hamiltonian function that generates the dynamics. Just like in the conservative symplectic case the contact structure provides a mapping between the functions on the manifold and the `contact Hamiltonian vector fields' on that manifold. This mapping is discussed in detail in \cref{sec:contact_ham_systems}. The trick is to decompose the Hamiltonian vector field into a horizontal and a vertical vector field; that is
$$ \tbundle{M} = \ker \alpha \oplus \ker \dd{\alpha},$$
where the vertical component is in the kernel of $ \dd{\alpha}$, and the horizontal vector field in the kernel of $ \alpha $. The Hamiltonian vector field is then 
$$ X_H = X_H^\text{ver} + X_H^\text{hor.}, $$
with $X_H^\text{ver} \in \ker \dd{\alpha}$ and $X_H^\text{hor} \in \ker \alpha$.
Furthermore, we impose two conditions on the Hamiltonian vector field $X_H$ associated to the Hamiltonian $H$. First, we have that $ H = = \intpr{X_H}{\alpha} $. The second condition is that $\lied{X_H}\alpha = s \alpha $ with $s$ some function; which is to say that $X_H$ is an infinitesimal contact transformation. 

The vertical part of the vector field is easy to find based on the first condition, and is equal to
$$ X_H^\text{ver} = -H R_\alpha. $$
However, for reasons that will become later, the horizontal part is of our prime interest. This part is obtained using the second condition, which is equivalent to
\begin{equation}
    \intpr{X_H^\text{hor}}{\dd{\alpha}} = \dd{H} - (\intpr{R_\alpha}{\dd{H}}) \alpha 
    \label{eq:hor_vfield_condition}
\end{equation}

Now, recall that for a purely symplectic (i.e. energy-conserving) Hamiltonian system, the relation between the Hamiltonian vector field and the Hamiltonian is given by (see \cref{app:symplectic_geometry} for details) 
$$ \dd{H} = \intpr{X_H}{\omega}, $$
where $\omega$ is the symplectic form, in this case $\omega = \wedgep{\dd{q}}{\dd{p}}$. By definition, we have that the form $\dd{\alpha}$ is also symplectic; it is easily checked that we have that $\dd{\alpha} = \omega$. The relation above then becomes 
$$ \dd{U_1} = \intpr{X_{U_1}}{\dd{\alpha}} - \text{dissipation}, $$
since the Hamiltonian of this system will be purely given by the mechanical energy in the absence of a dissipative element. Naturally, the system at issue is \emph{not} conservative, which is why we cannot expect the symplectic relation to hold. Instead, we expect to see a defect that measures the deviation from the ideal symplectic situation in the form of an extra term appearing in the above relation, representing the `leakage' of mechanical energy from the system. This is indeed what is obsered from \cref{eq:hor_vfield_condition}: the second term appearing on the right represents the dissipative action. Based on the expression for the contact form in \cref{eq:dho_contact_form_thermo}, we have
\begin{equation} 
    \begin{split}
        \intpr{X_H^\text{hor}}{\dd{\alpha}} &= \dd{H}  - \pdv{H}{U_2}U_2 + \pdv{H}{U_2}\gamma p\dd{q} \\
        \intpr{X_H^\text{hor}}{\dd{\alpha}} - \pdv{H}{U_2}\gamma p\dd{q} &= \dd{H}  - \pdv{H}{U_2}\dd{U_2}
    \end{split}
\end{equation}
As such, we recover the expected expression stated above \emph{if} $\dd{H} - \pdv{H}{U_2}\dd{U_2} = \dd{U_1}$. Let us make the convenient choice that $\pdv{H}{U_2} = 1$, which means that 
$$ H = U = U_1 + U_2, $$
at up to an arbitrary additive constant, which we choose to be zero. Hence, the \emph{contact Hamiltonian is equal to the total internal energy in the system}.

The contact Hamiltonian vector field then becomes  
$$ \text{derive equations of motion} $$

The vertical vector field is proportional to the numerical value of the Hamiltonian, and it contributes to the time-rate of change of the heat bath internal energy $U_2$. However, we have stipulated earlier that the change in $U_2$ is equal to the work done by the damper, and this term is entirely represented in the horizontal part of the Hamiltonian vector field. The presence of the vertical vector field gives rise to an additional exponential growth (since $X_H^\text{ver}$ is proportional to the Hamiltonian, which contains $U_2$ itself). Hence, if we we want to impose that $U_2$ indeed represents the internal energy of the heat bath, the \emph{vertical vector field must vanish}. This is only the case if the Hamiltonian is numerically equal to zero, i.e. $H = 0$.

The fact that $H = 0$ is crucial, and it has been overlooked in the work of \citet{Bravetti2017} which is the go-to reference for the application of contact Hamiltonian systems. There are at least two more arguments why this is a valid (and necessary) choice to make. We first remark that it is also makes sense to choose the internal energy of a system to be zero, as stated by \cite{Fermi1936}, but this does not give a satisfactory mathematical explanation.
\begin{itemize}
\item A first mathematical argument, given by \cite{Mrugala1991} is as follows. Submanifolds of $M$ on which the contact form pulls back to zero are called \emph{Legendre submanifolds}.
A vector field is tangent to a Legendre submanifold if it vanishes when contracted with the contact form, or $ \intpr{X_H}{\alpha} = 0$. But, this condition is precisely equal to the definition of the contact Hamiltonian! Hence, to remain on the same Legendre submanifold, the Hamiltonian function must amount to zero. 
\item A second argument can be given from the fact that in case the Hamiltonian is not zero, its value depends on the contact \emph{form}. Although mathematically allowed, this is not desirable from a conceptual perspective, since contact forms are only unique up to a nonzero multiplicative constant, in the sense that they define the same contact structure. If we want to demand that the Hamiltonian system only depends on the contact structure, the Hamiltonian must be zero.
\end{itemize}

