\section{Symplectic mechanical systems}
\label{sec:symplectic}

In the traditional sense, Hamiltonian mechanics take place on \emph{symplectic manifolds}. A symplectic manifold $(M, \omega)$ is a smooth manifold $M$ equipped with a \emph{closed}, \emph{nondegenerate} 2-form $\omega$. Because $\omega$ must be nondegenerate, symplectic manifolds are necessarily even-dimensional. The celebrated Darboux theorem states that locally, all symplectic manifolds of the same dimension (say $2n$) are all symplectomorphic to each other. As a result, we define the prototypical symplectic 2-form that serves as a representative for \emph{all} symplectic structures of that dimension as
\begin{equation}
    \omega = \sum_{i = 1}^n \wedgep{\dd{q_i}}{\dd{p_i}},
    \label{eq:darboux_symplectic_form}
\end{equation}
where $p_i$ and $q_i$ are coordinates for the manifold $M$. A coordinate chart in which the symplectic 2-form has the above form is called a \emph{Darboux charts}, and the associated coordinates \emph{Darboux coordinates} \cite{Cannas2001, Arnold1989}.

In mechanics, the \emph{configuration manifold} $Q$: is the manifold specified by all the possible generalized positions $q_i$ (or configurations) of the mechanical system. The \emph{generalized momenta} associated with each of the generalized positions live in the collection of cotangent spaces to the configuration manifold. This is because from the Lagrangian viewpoint the generalized momenta are given by\footnote
{
    In coordinate-free language, the Liouville 1-form is defined pointwise through its action on a tangent vector $\vec{\xi}$ to $\ctbundle{Q}$ as follows
    $$ \theta(\vec{\xi}) = (x \circ \pi_*) (\vec{\xi}). $$
    Here $\pi_*$ is the pushforward of the bundle projection map $\pi: \ctbundle{Q} \to Q: (\vec{q}, \vec{p}) mapsto \vec{q}$. The point $x \in \ctbundle{Q}$ is interpreted as a map on the tangent space to $\pi(x)$ on the base manifold.
}
$$ p_i = \pdv{L}{q_i}, $$
and the vector of $p_i$'s is a cotangent vector to $Q$. Hence, the \emph{cotangent bundle} of the configuration manifold contains all the possible position and momentum pairs. 

The structure that associates each position with its corresponding momentum is given by the \emph{Liouville 1-form} \footnote
{
    The Liouville 1-form makes its appearance in literature under a myriad of names, such as the canonical 1-form, tautological 1-form, Poincar√© 1-form or the symplectic potential.
}
$\theta$ on $\ctbundle{Q}$. The Liouville form is defined at every point $ (q_1, \ldots, q_n, p_1, \ldots, p_n) \in \ctbundle{M} $ as
\begin{equation}
    \theta = \sum_{i = 1} p_i\dd{q_i}.
\end{equation}
Hence, the Liouville form tells us which momentum coordinate corresponds to a given position coordinate and vice versa. This turns out to be an essential piece of the geometric structure that underpins classical mechanics.

Every cotangent bundle is canonically endowed with a Liouville form. The exterior derivative of the Liouville form produces a \emph{symplectic} 2-form. By convention, we define this symplectic form as follows:\footnote
{
    In this text, the `$q$-first' sign convention used by \citet{Abraham1978} and \citet{Cannas2001} is observed and maintained in the following sections concerning contact and Jacobi manifolds.
}
$$ \omega = -\dd{\theta} = \sum_{i = 1}^n \wedgep{\dd{q_i}}{\dd{p_i}}. $$
Hence, the space of generalized positions and momenta (i.e. the cotangent bundle the configuration manifold $Q$) is canonically symplectic. The symplectic structure pairs the corresponding position and momentum coordinates in a skew-symmetric fashion.

The idea of Hamiltonian mechanics is that the equations of motion are generated by \emph{Hamilton's equations}
$$ \dot{q}_i = \pdv{H}{p_i} \qquad \dot{p}_i = -\pdv{H}{q_i} $$
given the Hamiltonian function $H$, which is equal to the mechanical energy in the system. Observe that the above equation assumes that the pairing between the positions and momenta is known a priori. 

In the language of differential geometry, Hamilton's equations are specified by a symplectic structure on $\ctbundle{Q}$ and an appropriate Hamiltonian function on that manifold: the pairing between the positions and momenta is therefore built in. A generic Hamiltonian system is a triple $ (M, \omega, H), $ where $ (M, \omega) $ is a symplectic manifold. In mechanics, we have that $ M = \ctbundle{Q} $.
To produce the equations of motion, the symplectic structure provides a mapping between the smooth functions on the manifold and the Hamiltonian vector fields on the manifold\footnote{These are a special class of vector fields on $M$ that arise as a result of this mapping.}. First, define the mapping 
$$ \toDual{\omega}: \tbundle{M} \to \ctbundle{M}: X \mapsto \intpr{X}{\omega}. $$
Because $\omega$ is nondegenerate by definition, the mapping $\toDual{\omega}$ is an isomorphism. Thus, the inverse mapping is well-defined, and is denoted by $\fromDual{\omega}$. 

This isomorphism specified by $\omega$ allows us to find the corresponding Hamiltonian vector field $X_H$ to a Hamiltonian function, given by:
$$ X_H = \fromDual{\omega}(\dd{H}). $$
In (Darboux) coordinates, the action of $ \fromDual{\omega}$ on the basis 1-forms is  
$$ \dd{p}_i \mapsto \pdv{}{q_i} \qquad \dd{q}_i \mapsto -\pdv{}{p_i}. $$ 
The minus sign arises as a consequence of the anticommutativity of the wedge product in appearing in $\omega$.

A classical example of this formalism is the harmonic oscillator (undamped) shown in \cref{fig:ho}, with Hamiltonian function
$$ H = \frac{p^2}{2m} + \frac{1}{2}kq^2,$$
where $m$ is the mass and $k$ the spring constant. The Hamiltonian vector field is then 
$$ X_H = \frac{p}{m}\pdv{}{q} - kq \pdv{}{p}, $$
or stated as a system of differential equations
$$ \dot{q} = \frac{p}{m} \qquad \dot{p} = -kq. $$
\begin{figure}[ht!]
    \centering
    \input{media/tikz/harmonic_oscillator.tex}
    \caption{Blabla}
    \label{fig:ho}
\end{figure}

In the context of bond graphs, the symplectic form represent the dual nature of a bond. That is to say, a bond represents an exchange of both an effort and a flow, and they are inherently tied to each other. The flow is a change in position or generalized velocity, and the effort is a change in momentum. The effort and flow associated to a bond are conjugate: the symplectic form provides precisely the structure that is visually present in a bond graph (e.g. \cref{fig:ho}).

The symplectic form endows the manifold $M$ also with a \emph{Poisson structure}, i.e. a Lie algebra structure on the vector space space of functions on $M$. The commutator of this algebra structure is the \emph{Poisson bracket},
\begin{equation}
    \begin{split}
        \poisson{\,}{}: \functions{M} \times \functions{M} \to \functions{M}: 
        \poisson{f}{g} &= \omega\qty(\fromDual{\omega}\dd{f}, \fromDual{\omega}\dd{g})  \\
                       &= \omega\qty(X_f, X_g) \\
                       &= \lied{X_f}{g}.
    \end{split}
\end{equation}
Poisson brackets are anticommutative, bilinear and satisfy the Jacbobi identity. Additionally, they also satisfy the \emph{Leibniz rule}, 
$$ \poisson{f}{gh} = \poisson{f}{g}h + \poisson{f}{h}g. $$
Due to the Poisson structure, symplectic manifolds are also Poisson manifolds. In \cref{sec:contact,sec:jacobi} the notion of Poisson manifolds will be generalized to \emph{Jacobi manifolds} to cover more general mechanical systems. In contrast to the Poisson structure, does the Jacobi structure not have the Leibniz property. The usefulness of Poisson brackets is due to the fact that they provide a convenient way to calculate the time-rate of change of an observable $f$: 
$$
    \dv{f}{t} = \poisson{f}{H} + \pdv{f}{t}.
$$

If the Hamiltonian does not depend on time, it is conserved under its own Hamiltonian vector field. This is easily seen from the anticommutativity of Poisson brackets ($\poisson{H}{H}$). Therefore, Hamiltonian systems conserve energy; they do not allow for dissipative (friction) forces in a straightforward manner, unless included in the form of an explicit time depence. This is clearly a consequence of the symplectic structure. In the next section we will extend the Hamiltonian formalism to a related type of geometry called \emph{contact geometry} to incorporate dissipation in the Hamiltonian system.
