\section{Contact mechanical systems}
\label{sec:contact}

[Part of the intro]
In this section, the thermodynamic principles and their relation with contact geometry are used to establish a contact Hamiltonian system for the damped harmonic oscillator. In contrast to the conservative system discussed in \cref{sec:symplectic} (cf. \cref{fig:ho}), a dissipative element is now present in the system. This precludes the damped harmonic oscillator from being modeled by a symplectic Hamiltonian system that is not explicitly time-dependent. Time-dependence indicate a nonautonomous system, and they are typically reserved for either external control inputs or disturbance inputs. The control inputs are meant to drive the system to a specific state. The disturbance input are (potentially stochastic) external inputs that cannot be controlled but influence the system is some specified manner. 

What both disturbances and control inputs have in common, is that they are inherently \emph{exogenous}: they are not part of the system itself. In contrast, the dissipative element in the form of the damper \emph{is} part of the system (endogenous). From both conceptual and practical standpoint, modeling dissipation as a time-dependence, and therefore and exogenous phenomenon, is not desirable. This is why, in this section, we aim to use contact geometry to include the dissipation as an intrinsic component of the overall system.

\subsection{Contact manifolds}
In contrast to symplectic manifolds, contact manifolds are odd-dimensional. A contact manifold $(M, \xi)$ is a smooth manifold $M$ of dimension $2n + 1$ equipped with a maximally non-integrable hyperplane distribution $\xi$. That is to say, at every point $x \in M$ the contact structure specifies a $2n$-dimensional linear subspace (i.e. a hyperplane) of $\tbundle{M}$. Locally\footnote
{
    Contact structures which are globally defined by a 1-form are called \emph{exact} or \emph{strictly} contact structures. This is the case when the quotient line bundle $ \tbundle{M}/\xi$ is orientable. 
}
, the hyperplane distribution is specified as the kernel of a 1-form on $M$, which must be nondegenerate:\footnote{Equations of the form $ \alpha = 0$, where $\alpha$ is a 1-form, determine so-called \emph{Pfaffian equations} \cite{Libermann1987}.} \cite{Geiges2008, Arnold1989, Cannas2001}
$$ \xi\vert_x = \ker{\alpha}\vert_x. $$
It is worth pointing out that the correspondence between a hyperplane and the kernel of a 1-form is not one-to-one. Indeed, multiplying $\alpha$ by any nonzero function yields a different 1-form with the same kernel. The contact forms are different, but they give rise to the same contact structure. This ambiguity is very important, and will play a vital role in the process of symplectification discussed in \cref{ssec:symplectification}.

Nonintegrability of the hyperplane distribution means that we cannot find codimension-1 foliations that are everywhere tangent to the distribution of hyperplanes. This is analogous to a nonholonomic constraint on a mechanical system: these constraints cannot be integrated to obtain a submanifold of the configuration space that contains all the allowable positions. Indeed, the condition for nonholomicity applies here as well: for $\xi$ to be nonintegrable, the associated contact form $\alpha$ must satisfy the Frobenius condition 
$$ \wedgep{\alpha}{\dd{\alpha}} \neq 0, $$
or equivalently, that $\wedgep{\alpha}{(\dd{\alpha})^n}$ is a volume form on $M$. 

Contact geometry is closely related to symplectic geometry, for the nonintegrability condition implies that $\dd{\alpha}$ implies that $\dd{\alpha}\vert_{\xi}$ is a symplectic form. There also an extenison of the Darboux theorem to contact manifold, which says that locally, every contact form can be written as
\begin{equation}
    \dd{q}_0 - \sum_i^n p_i \dd{q}_i, 
    \label{eq:contact_darboux}
\end{equation} 
the coordinates $(q_0, q_1, \ldots, q_n, p_1, \ldots, p_n)$ are then called \emph{Darboux coordinates}.

For a slightly more comprehensive introduction to contact geometry, the reader is referred to \cref{app:contact_geometry}. More extensive literature are, among others, the works of \citet{Geiges2008}, \citet{Libermann1987}, \citet{Arnold1989,Arnold1989a} and \citet{Godbillon1969}.

\subsection{Contact Hamiltonian systems}
Similar to symplectic Hamiltonian systems, a \emph{contact Hamiltonian system} needs three ingredients: a smooth manifold $M$, a contact form $\alpha$ on that manifold, and a Hamiltonian function on the manifold. The contact structure then provides a mapping between the smooth functions on the manifold and the contact Hamiltonian vector fields on the manifold. As such, the contact structure generates the contact verison of Hamilton's equations.

The mapping $\Psi_\alpha$ that relates the smooth functions and contact Hamiltonian vector fields, given a contact 1-form $\alpha$, is defined as follows:
\begin{equation}
    \Psi_\alpha: \vsfields{c}{X}{M} \to \functions{M}: \quad X_H \mapsto H = \intpr{X_H}{\alpha}, 
    \label{eq:psi_definition}
\end{equation}
where $\vsfields{c}{X}{M}$ is the collection of infinitesimal strict contactomorphisms. These are vector fields that preserve the strictly contact structure specified by $\alpha$, and are subject to the following condition:
\begin{equation}
    \lied{X_H}{\alpha} = s \alpha, 
    \label{eq:contact_vf_condition}
\end{equation}
where $s$ is an arbitrary smooth function on $M$. This condition is based on the fact any nonzero multiple of a given contact form specifies the same contact structure.

To obtain the vector field from a Hamiltonian function, we are interested in the inverse mapping $\Psi^{-1}_\alpha$. This mapping is not quite straightforward, for it has to map the general class of smooth functions back to a very \emph{specific} subclass of vector fields. The trick is to decompose the vector field $X_H$ according to the following splitting of the tangent bundle of $M$:
$$ \tbundle{M} = \ker \alpha \oplus \ker \dd{\alpha}, $$
where $\oplus$ denotes the Whitney sum. Vector fields that are in the kernel of $\alpha$ are called \emph{horizontal}. Conversely, vector fields that are in the kernel of $\dd{\alpha}$ are \emph{vertical}. We therefore have 
$$ X_H = X_H^\text{hor} + X_H^\text{ver} \qquad \intpr{X_H^\text{hor}}{\alpha} = 0,\:\: \intpr{X_H^\text{ver}}{\dd{\alpha}} = 0. $$

The vertical component of $X_H$ is easily obtained from the definition of $\Psi_\alpha$:
\begin{equation}
    X_H^\text{ver} = H R_\alpha,
    \label{eq:vertical_vf}
\end{equation}
where $R_\alpha$ is the \emph{Reeb vector field}\footnote{
    The Reeb vector field is defined by two conditions: \cite{Libermann1987}
        $$ \intpr{R_\alpha}{\alpha} = 1 \qquad \intpr{R_\alpha}{\dd{\alpha}} = 0.$$
    In the Darboux coordinates as given in \cref{eq:contact_darboux}, the Reeb vector field has the form
        $$ R_\alpha = \pdv{}{q_0}. $$} 
associated to the contact form $\alpha$.

Finding the horizontal component is more involved; a detailed account of the required technicalities is given in \cref{app:contact_geometry}. In short, we again need a mapping similar to the one defined in \cref{eq:symplectic_isomorphism}, but now defined in terms of $\dd{\alpha}$ instead:
$$ \toDual{\dd{\alpha}}(X) \coloneq \intpr{X}{\dd{\alpha}}. $$
However, this is not an isomorphism between $\tbundle{M}$ and $\ctbundle{M}$, for it will annihilate any vertical component $X$. However, it \emph{is} an isomorphism from the horizontal vector fields to their image under $\toDual{\dd{\alpha}}$; which is a specific class of 1-forms that are called \emph{semi-basic} forms\footnote
{
    Semi-basic forms are forms that vanish when contracted with a vertical vector field \cite{Libermann1987}. 
}. 
Likewise, the inverse mapping $\fromDual{\dd{\alpha}}$ takes a semi-basic form as an argument and produces a vertical vector field. 

The horizontal component of the Hamiltonian vector field is equal to this mapping applied to $\dd{H}$, projected to the space of semi-basic forms:
\begin{equation}
    X_H^\text{hor} = \fromDual{\dd{\alpha}}\qty(\dd{H} - (\intpr{R_\alpha}{\dd{H}})\alpha).
    \label{eq:horizontal_vf}
\end{equation}

Hence, the Hamiltonian vector field is equal to
\begin{equation}
    X_H = \Psi^{-1}_\alpha(H) = H R_\alpha + \fromDual{\dd{\alpha}}\qty(\dd{H} - (\intpr{R_\alpha}{\dd{H}})\alpha).
    \label{eq:contact_hamiltonian_vf}
\end{equation}

To apply the contact Hamiltonian formalism to dissipative mechanical systems, we first require a manifold with a suitable contact structure. This contact structure is derived from the principles of thermodynamics in the next section. Subsequently, the contact Hamiltonian system and the equations of motion are set up in \cref{ssec:contact_dissipation}.

%One of most prominent applications of contact geometry in physics is the theory of thermodynamics. We will use the principles from thermodynamics to construct a suitable contact Hamiltonian system for dissipative systems in \cref{ssec:contact_dissipation}. First, however, the role of contact geometry in thermodynamics is explained in \cref{ssec:contact_thermodynamics}. 

\subsection{Contact geometry in dissipative mechanics}
\label{ssec:contact_dissipation}
As mentioned the contact structure will be derived based on thermodynamic reasoning. Therefore, the next section first discusses the traditional role of contact geometry in thermodynamics, after it will be applied to dissipative mechanics.

\subsubsection{Contact geometry in classical thermodynamics}
It has been argued in the past by several authors that contact geometry is the natural framework for thermodynamics by i.a. \citet{Arnold1991,Arnold1989a,Arnold1989,Arnold1989b}, \citet{Bamberg1988}, \citet{Burke1985} and \citet{Hermann1973}, ultimately leading back to the seminal work of \citet{Gibbs1873}. It is commonly seen as a testament to the brilliance of Gibbs' work that he managed to recognize and describe the correct geometric framework well before the required mathematical infrastructure came to invention \cite{Wightman1979}. In recent years, the contact Hamiltonian formalism has been succesfully applied to thermodynamic theory by e.g. \citet{Mrugala1991,Mrugala2000,Mrugala1984,Mrugala1985,Mrugala1993,Mrugala1996}, \citet{Balian2001}, \citet{VanderSchaft2021a,VanderSchaft2018}, \citet{Maschke2018}, \citet{Bravetti2015}, and \citet{Simoes2020}. 

Contact geometry arises in thermodynamics as a consequence of the First Law, which asserts that the change in internal energy of the system is equal to the difference between the heat added \emph{to} the system and the work performed \emph{by} the system. 

\paragraph{First Law of thermodynamics} To state the First Law in the language of exterior forms, define the 1-forms $\eta$ and $\beta$ as the differential amounts of heat and work (in respective order) added to the system. $\eta$ and $\beta$ are 1-forms that are generally \emph{not} closed \cite{Bamberg1988,Frankel2012}. However, the First Law states that the difference between them \emph{is} a closed form. Locally, this closed form  can be written as the gradient of a function called the \emph{internal energy} $U$. Hence, we state the first law as\footnote{By using differential forms, the inexactness of the heat and work differentials need not be explicitly emphasized using additional notation such as $\delta$ or \dj.}:
\begin{equation}
    \dd{U} = \eta - \beta.
    \label{eq:thermo_first_law}
\end{equation}
This equation can be equivalently expressed as the fact that the 1-form
\begin{equation}
    \alpha = \dd{U} - \eta + \beta
    \label{eq:first_law_contact}
\end{equation}
should pull back to zero over the physical trajectories of the systems.

\paragraph{The Gibbs form} For the purposes of illustration, we now apply this concept to what is arguably the most simple thermodynamic system: the ideal gas in a piston. 

The ideal gas is characterized by five thermodynamic properties: the temperature $T$, entropy $S$, volume $V$, pressure $P$ and the internal energy $U$. We call the five-dimensional space containing all the possible states the \emph{thermodynamic phase space}.

For the ideal gas, we have that the work done by the system is equal to the pressure multiplied with the change in volume, i.e. $\beta = P\dd{V}$. Furthermore, heat added to the system is given by the temperature multiplied by the change of energy: $\eta = T\dd{S}$ \cite{Arnold1989b,Wightman1979,Bamberg1988}. Therefore, \cref{eq:first_law_contact} becomes
\begin{equation}
    \alpha_\text{\tiny G} \coloneq \dd{U} - T\dd{S} + P\dd{V},
    \label{eq:gibbs_form}
\end{equation}
which is called the \emph{Gibbs form} (hence the subscript). It is clear that the Gibbs form defines a contact structure on the thermodynamic phase space (these are Darboux coordinates). Along the physically allowable trajectories, the Gibbs form must pull back to zero.

\paragraph{Legendre submanifolds} In contact geometry, submanifolds on which the contact form vanishes everywhere are called \emph{Legendre submanifolds}. As such, these submanifolds are vital in thermodynamics, because they contain the allowable states (\citet{Balian2001} call them thermodynamic manifolds). Due to the nonintegrability condition on the contact structure, Legendre submanifolds have at most dimension $n$, if the overall contact manifold is of dimension $2n + 1$.

For the ideal gas, the Legendre submanifolds are two-dimensional. They can be computed explicitly by integrating the Gibbs form. To do so, we need two additional \emph{equations of state}, 
\begin{equation}
    U = c\, n_\text{s}\, R_\text{g}\, T \qquad P \, V = n_\text{s} \, R_\text{g} \, T,
\end{equation}
where $n_\text{s}$ is the amount of substance, $R_\text{g} = \SI{8.314}{\joule \per \mole \per \kelvin}$ is the ideal gas constant and $c$ is another constant dependent on the molecular nature of the gas\footnote{For a monatomic gas, $c = \tfrac{3}{2}$.}. 

In addition, the internal energy is, by definition, a function of the extensive state properties: in this case, the entropy and the volume. We can therefore integrate the Gibbs form by rearranging the equations of state to express $T$ and $P$ in terms of $S$ and $V$ as well. Integrating \cref{eq:gibbs_form} yields
$$
    U = \log(C_0) \: \ec^{\tfrac{S}{cn_\text{s}R_\text{g}}} \: V^{\tfrac{-1}{c}},
$$
where $C_0$ is an integration constant. Since $ U = U(S, V)$, we have that
$$ \dd{U} = \pdv{U}{S}\dd{S} + \pdv{U}{V}\dd{V}. $$
Hence, we can fully specify a Legendre submanifold by the integrated equation and following conditions
$$ T = \pdv{U}{S} \qquad P = -\pdv{U}{V}. $$

\subsubsection{Contact geometry of the damped harmonic oscillator}
The damped harmonic oscillator is shown in \cref{fig:dho}, together with its bond graph representation. We assume here that this system is completely isolated: there is no exchange of energy nor matter with the environment.  
%The damping force of the damper is proportional to the relative velocity of its connection points. That is, $F_\text{d} = b \dot{q} = \gamma p $, where $\gamma \coloneq b/m$ is the damping coefficient.
\begin{figure}[ht!]
    \centering
    \input{media/tikz/damper_oscillator}
    \caption{The left figure shows a schematic of the mechanical damped harmonic oscillator wisth mass $m$, spring constant $k$ and damping constant $b$. The bond graph representation is shown on the right. In addition to the I- and R-element in \cref{fig:ho}, there is now an R-element as well.}
    \label{fig:dho}
\end{figure}

\paragraph{Energy storage} We distinguish two types of energy that can be stored in the damped oscillator system: microscopic and macroscopic energy.

Microscopic energy consists of the kinetic energy of particles that does not result in an overall observable motion of the system. This energy is called internal energy $U$ and manifests itself as temperature. 

Internal energy is stored in a `heat bath'. This is to be interpreted loosely: it can be the damper fluid, but also the surrounding air (although a heteregeneous medium will not allow for an unambiguous notion of temperature). We will not be concerned with all these possibilities and consider a single heat bath with a single temperature: generalizations to more complex thermodynamic systems are immediate. 

In contrast, macroscopic energy \emph{is} observable, either due to an observable motion of the system (kinetic energy) or the energy resulting from external force potentials (potential energy). Their sum is called \emph{mechanical energy} $E$: in the damped harmonic oscillator, it is the sum of the kinetic energy stored in the mass (I-element) and the potential energy stored in the spring (C-element).

Since the system is isolated, the First Law states that 
\begin{equation}
    \dd{(E + U)} = 0. 
    \label{eq:dho_first_law}
\end{equation}

Let us now decompose the system into two subsystems, one containing the mass and the spring and one the heat bath, as illustrated in \cref{fig:oscillator_thermo}. 
\begin{figure}[ht!]
    \centering
    \input{media/tikz/damper_oscillator_thermo}
    \caption{System boundaries of the damper-oscillator system. The mechanical subsystem stores mechanical energy $E$ in the form of kinetic and potential energy, while the heat bath stores internal energy in the form of heat. They interface through the action of the damper.}
    \label{fig:oscillator_thermo}
\end{figure}

Through the dissipative action of the damper, energy flows from the mechanical subsystem to the heat bath. We can apply the First Law to the subsystems separately, too: the first subsystem performs work on the damper, which manifests itself as the heat added to the heat bath. We therefore have
\begin{equation}
    \begin{split}
        \dd{E}  = -\beta, \\[0.2cm]
        \dd{U} = \eta, \\
    \end{split}
    \label{eq:dho_energy_balance}
\end{equation}
where $\beta$ is the (differential) work done \emph{by} the mechanical subsystem on the damper and $\eta$ is the (differential) heat added \emph{to} the second subsystem as a result of this. 

As a consequence of \cref{eq:dho_first_law}, we have that $ \beta = \eta $; i.e. all the work done by the damper enters the fluid as heat. For a linearly damped system, the work form is by definition equal to 
\begin{equation}
    \beta \coloneq \gamma p \dd{q},
    \label{eq:dho_work_form}
\end{equation}
with $\gamma \coloneq b/m$ being the damping coefficient of the damped oscillator. 

\paragraph{Contact structure} We now define the phase space of the system to be equal to $M = \real \times \ctbundle{Q}$, where $Q$ is the configuration space considered in \cref{sec:symplectic}. For the damped harmonic oscillator, $Q = \real$. With coordinates for $M$ being $U, q$ and $p$, we can define a \emph{contact form} on this space by combining \cref{eq:dho_energy_balance} and \cref{eq:dho_work_form}: 
\begin{equation}
    \alpha = \dd{U} - \gamma p \dd{q}.
    \label{eq:dho_contact_form}
\end{equation}
This contact form specifies precisely how energy is dissipated in the system and enters the `reservoir' that is the heat bath, characterized by its internal energy $U$.

Observe from \cref{eq:dho_contact_form} that $\dd{\alpha} = \gamma \wedgep{\dd{q}}{\dd{p}}$, i.e. a multiple of the symplectic form used in \cref{sec:symplectic}. As such, the contact form contains \emph{both} information about the rate of dissipation present in the system, and about the pairing of the conjugate variables $p$ and $q$. We get the latter `for free' in this particular instance, since the pairing in this simple three-dimensional is rather trivial.

It is important to note that, in the general case, a 1-form that describes the dissipation in the system is \emph{under no obligation} to be of this very specific form (that is, one that pairs the conjugate variables). As such, we can not expect this situation to occur in general: this is subject of \cref{sec:jacobi}.

\subsubsection{The contact Hamiltonian system for the damped harmonic oscillator}
With the contact structure defined, we can now establish the contact Hamiltonian system for the damped harmonic oscillator using \cref{eq:vertical_vf,eq:horizontal_vf,eq:contact_hamiltonian_vf}.

Recall that the Hamiltonian vector field is split into a horizontal and vertical componet being part of the kernel of $\alpha$ and $\dd{alpha}$ respectively.

\paragraph{Vertical component} The Reeb vector field $R_\alpha$ associated with the contact form given in \cref{eq:dho_contact_form} is 
$$ R_\alpha = \pdv{}{U}. $$
As such, the vertical component of the Hamiltonian vector field is, in accordance with \cref{eq:vertical_vf}:
$$ X_H^\text{ver} = H\pdv{}{U}. $$
However, we can only guess as to what the Hamiltonian function might be. Indeed, its definition is rather circular, since the vertical part of the vector field is \emph{defined} in terms of the vertical part and vice versa.

\paragraph{Horizontal component} The horizontal part is obtained by projecting $\dd{H}$ (an arbitrary exact form) to a \emph{semi-basic} form in the following fashion
$$ \dd{H} - (\intpr{R_\alpha}{\dd{H}}\alpha). $$
In the purely symplectic case with no dissipation, we would have 

The Hamiltonian is a function on the contact manifold $M$, i.e. $H = H(U, q, p)$. As such, the above form is, in coordinates
$$ \qty(\pdv{H}{q} - \gamma p)\dd{q} + \pdv{H}{p}\dd{p} $$




\subsection{Symplectification of contact Hamiltonian systems}
\label{ssec:symplectification}





