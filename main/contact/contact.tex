\section{Contact mechanical systems}
\label{sec:contact}

[Part of the intro]
In this section, the thermodynamic principles and their relation with contact geometry are used to establish a contact Hamiltonian system for the damped harmonic oscillator. In contrast to the conservative system discussed in \cref{sec:symplectic} (cf. \cref{fig:ho}), a dissipative element is now present in the system. This precludes the damped harmonic oscillator from being modeled by a symplectic Hamiltonian system that is not explicitly time-dependent. Time dependence indicates a nonautonomous system, and they are typically reserved for either external control inputs or disturbance inputs. The control inputs are meant to drive the system to a specific state. The disturbance inputs are (potentially stochastic) external inputs that cannot be controlled but influence the system in some specified manner. 

What both disturbances and control inputs have in common, is that they are inherently \emph{exogenous}: they are not part of the system itself. In contrast, the dissipative element in the form of the damper \emph{is} part of the system (endogenous). From both conceptual and practical standpoint, modeling dissipation as a time-dependence, and therefore an exogenous phenomenon, is not desirable. This is why, in this section, we aim to use contact geometry to include dissipation as an intrinsic component of the overall system.

\subsection{Contact manifolds}
In contrast to symplectic manifolds, contact manifolds are odd-dimensional. A contact manifold \((M, \xi)\) is a smooth manifold \(M\) of dimension \(2n + 1\) equipped with a maximally non-integrable hyperplane distribution \(\xi\). That is to say, at every point \(x \in M\) the contact structure specifies a \(2n\)-dimensional linear subspace (i.e. a hyperplane) of \(\tbundle{M}\). Locally\footnote
{
    Contact structures which are globally defined by a 1-form are called \emph{exact} or \emph{strictly} contact structures. This is the case when the quotient line bundle \( \tbundle{M}/\xi\) is orientable. 
}
, the hyperplane distribution is specified as the kernel of a 1-form on \(M\), which must be nondegenerate:\footnote{Equations of the form \( \alpha = 0\), where \(\alpha\) is a 1-form, determine so-called \emph{Pfaffian equations} \cite{Libermann1987}.} \cite{Geiges2008, Arnold1989, Cannas2001}
\begin{equation}
     \xi\vert_x = \ker{\alpha}\vert_x.
\end{equation}
It is worth pointing out that the correspondence between a hyperplane and the kernel of a 1-form is not one-to-one. Indeed, multiplying \(\alpha\) by any nonzero function yields a different 1-form with the same kernel. The contact forms are different, but they give rise to the same contact structure. This ambiguity is very important and will play a vital role in the process of symplectification discussed in \cref{ssec:symplectification}.

Nonintegrability of the hyperplane distribution means that we cannot find codimension-1 foliations that are everywhere tangent to the distribution of hyperplanes. This is analogous to a nonholonomic constraint on a mechanical system: these constraints cannot be integrated to obtain a submanifold of the configuration space that contains all the allowable positions. Indeed, the condition for nonholomicity applies here as well: for \(\xi\) to be nonintegrable, the associated contact form \(\alpha\) must satisfy the Frobenius condition 
\begin{equation}
     \wedgep{\alpha}{\dd{\alpha}} \neq 0,
\end{equation}
or equivalently, that \(\wedgep{\alpha}{(\dd{\alpha})^n}\) is a volume form on \(M\). 

Contact geometry is closely related to symplectic geometry, for the nonintegrability condition implies that \(\dd{\alpha}\) implies that \(\dd{\alpha}\vert_{\xi}\) is a symplectic form. There also an extension of the Darboux theorem to contact manifold, which says that locally, every contact form can be written as
\begin{equation}
    \dd{q^0} - \sum_i^n p_i \dd{q^i}, 
    \label{eq:contact_darboux}
\end{equation} 
the coordinates \(\qty(q^0, q^1, \ldots, q^n,\, p_1, \ldots, p_n)\) are then called \emph{Darboux coordinates}.

For a slightly more comprehensive introduction to contact geometry, the reader is referred to \cref{app:contact_geometry}. More extensive literature are, among others, the works of \citet{Geiges2008}, \citet{Libermann1987}, \citet{Arnold1989,Arnold1989a} and \citet{Godbillon1969}.

\subsection{Contact Hamiltonian systems}
\label{ssec:contact_ham_systems}
Similar to symplectic Hamiltonian systems, a \emph{contact Hamiltonian system} needs three ingredients: a smooth manifold \(M\), a contact form \(\alpha\) on that manifold, and a Hamiltonian function \(K\) on the manifold. The contact structure then provides a mapping between the smooth functions on the manifold and the contact Hamiltonian vector fields on the manifold. As such, the contact structure generates the contact version of Hamilton's equations.

The mapping \(\Psi_\alpha\) that relates the smooth functions and contact Hamiltonian vector fields, given a contact 1-form \(\alpha\), is defined as follows:
\begin{equation}
    \Psi_\alpha: \vsfields{c}{X}{M} \to \functions{M}: \quad X_K \mapsto K = -\intpr{X_K}{\alpha}, 
    \label{eq:psi_definition}
\end{equation}
where \(\vsfields{c}{X}{M}\) is the collection of infinitesimal strict contactomorphisms. These are vector fields that preserve the strictly contact structure specified by \(\alpha\), and are subject to the following condition:
\begin{equation}
    \lied{X_K}{\alpha} = s \alpha, 
    \label{eq:contact_vf_condition}
\end{equation}
where \(s\) is an arbitrary smooth function on \(M\). This condition is based on the fact any nonzero multiple of a given contact form determines the same contact structure.

\subsubsection{Horizontal and vertical vector fields} 
To obtain the vector field from a Hamiltonian function, we are interested in the inverse mapping \(\Psi^{-1}_\alpha\). This mapping is not quite straightforward, for it has to map the general class of smooth functions back to a very \emph{specific} subclass of vector fields. The trick is to use a splitting of the (co)tangent bundle, decomposing the vector field into two components. 

The nonintegrability condition on the contact structure ensures that \(\wedgep{\alpha}{\dd{\alpha}} \neq 0\). As such, at every point, we have at any \(x\in M\):
\begin{equation}
     \ker{\alpha}\vert_x \cap \ker{\dd{\alpha}}\vert_x = \qty{\mathbf{0}},
\end{equation}
i.e. they can only coincide at the origin. Consequently, we can define the following splitting of the tangent bundle:
\begin{equation}
     \tbundle{M} = \ker{\alpha}\oplus\ker{\dd{\alpha}},
\end{equation}
where \(\oplus\) denotes the Whitney sum\footnote{The Whitney sum applies to vector bundles, roughly speaking, a `fibered' version of the direct sum for vector spaces. The Whitney sum of two vector bundles (over the same base space) is a vector bundle over that base space, with every fiber being the direct sum of the fibers of the original vector bundles.}. Vector fields that are in the kernel of \(\alpha\) are called \emph{horizontal}; they form a subbundle of rank \(2n\), which coincides with the hyperplane distribution specified by the contact structure. In contrast, \emph{vertical} vector fields are in the kernel of \(\dd{\alpha}\), which is a subbundle of rank 1 \cite{Libermann1987}.

The \emph{Reeb vector field} \(R_\alpha\) associated with \(\alpha\) is a `unit' vertical vector field, defined by the conditions\footnote{The Reeb vector field is not uniquely associated with a contact structure and depends on the particular choice of contact form.}
    \begin{equation}
     \intpr{R_\alpha}{\alpha} = 1 \qquad \intpr{R_\alpha}{\dd{\alpha}} = 0.
\end{equation}
In the Darboux coordinates as given in \cref{eq:contact_darboux}, the Reeb vector field is
    \begin{equation}
     R_\alpha = \pdv{}{q^0}.
\end{equation} 
Because the space of vertical vector fields is of rank 1, every vertical vector field is colinear with the Reeb vector field.

An arbitrary vector field \(X \in \vfields{M}\) can be canonically decomposed into a horizontal and a vertical component as follows:
\begin{equation}
    X = \underbrace{(\intpr{X}{\alpha})R_\alpha}_\text{vertical} + \underbrace{X - (\intpr{X}{\alpha})R_\alpha}_\text{horizontal}.
    \label{eq:vfield_splitting}
\end{equation}

\begin{figure}[ht!]
    \centering
    \input{media/tikz/contact_spaces}
    \caption{Splitting of the tangent and cotangent bundle using the structure provided by the contact form, with \(\text{dim} M = 3\). The left figure shows the cotangent space to \(M\) at some point \(x\), where the blue plane contains the semi-basic forms. The other subbundle is of rank 1 and consists of all the scalar multiples of the contact form \(\alpha\). On the right, the tangent space to \(M\) at \(x\) is depicted, with the red plane containing the horizontal vector fields. The blue line is spanned by the vertical vector fields.}
    \label{fig:contact_spaces}
\end{figure}

\subsubsection{Semi-basic forms} 
Similar to the splitting of the tangent bundle, the cotangent bundle may be decomposed into two subbundles as well. The first subbundle consists of the annihilators of the horizontal vector fields. This is a subbundle of rank 1 that contains all the multiples of the contact form; they generate the contact structure. The other subbundle contains the \emph{semi-basic forms}, which annihilate the vertical vector fields \cite{Libermann1987}.

Any 1-form \(\zeta \in \bsection{\ctbundle{M}}\) can be canonically decomposed into a semi-basic component and a multiple of \(\alpha\) as follows:
\begin{equation}
    \zeta = \underbrace{(\intpr{R_\alpha}{\zeta})\alpha}_\text{contact struct.} + \underbrace{\zeta - (\intpr{R_\alpha}{\zeta})\alpha}_\text{semi-basic}. 
    \label{eq:form_splitting}
\end{equation}
In Darboux coordinates, semi-basic forms are forms that have no component in \(\dd{q^0}\).

The decompositions of \(\ctbundle{M}\) and \(\tbundle{M}\) for the three-dimensional case are shown in \cref{fig:contact_spaces}. They also play an important role in \cref{sec:jacobi}.

\subsubsection{The Hamiltonian isomorphism for contact manifolds}
To find the Hamiltonian vector field \(X_K\) associated with a Hamiltonian \(K\), we decompose \(X_K\) into a horizontal and a vertical component:
\begin{equation}
     X_K = X_K^\text{hor} + X_K^\text{ver}.
\end{equation}

The vertical component of \(X_K\) is easily obtained from the definition of \(\Psi_\alpha\):
\begin{equation}
    X_K^\text{ver} = -K R_\alpha,
    \label{eq:vertical_vf}
\end{equation}
where \(R_\alpha\) is the \emph{Reeb vector field}\footnote{
    The Reeb vector field is defined by two conditions: \cite{Libermann1987}
        \begin{equation}
     \intpr{R_\alpha}{\alpha} = 1 \qquad \intpr{R_\alpha}{\dd{\alpha}} = 0.
    \end{equation}
    In the Darboux coordinates as given in \cref{eq:contact_darboux}, the Reeb vector field has the form
    \begin{equation}
     R_\alpha = \pdv{}{q^0}.
    \end{equation}
} 
associated to the contact form \(\alpha\).

Finding the horizontal component is more involved; a detailed account of the required technicalities is given in \cref{app:contact_geometry}. In short, we again need a mapping similar to the one defined in \cref{eq:symplectic_isomorphism}, but now defined in terms of \(\dd{\alpha}\) instead:
\begin{equation}
    \toDual{\dd{\alpha}}(X) \coloneq \intpr{X}{\dd{\alpha}}.
    \label{eq:contact_isomorphism}
\end{equation}
However, this is not an isomorphism between \(\tbundle{M}\) and \(\ctbundle{M}\), for it will annihilate any vertical component \(X\). However, it \emph{is} an isomorphism from the horizontal vector fields to the semi-basic forms (respectively the red and blue planes in \cref{fig:contact_spaces}). Likewise, the inverse mapping \(\fromDual{\dd{\alpha}}\) takes a semi-basic form as an argument and produces a vertical vector field. 

The horizontal component of the Hamiltonian vector field is equal to this mapping applied to \(\dd{K}\), canonically projected to the space of semi-basic forms (cf. \cref{eq:form_splitting}):
\begin{equation}
    X_K^\text{hor} = \fromDual{\dd{\alpha}}\qty(\dd{K} - (\intpr{R_\alpha}{\dd{K}})\alpha).
    \label{eq:horizontal_vf}
\end{equation}

Hence, the Hamiltonian vector field is equal to
\begin{equation}
    X_K = \Psi^{-1}_\alpha(K) = K R_\alpha + \fromDual{\dd{\alpha}}\qty(\dd{K} - (\intpr{R_\alpha}{\dd{K}})\alpha).
    \label{eq:contact_hamiltonian_vf}
\end{equation}

To apply the contact Hamiltonian formalism to dissipative mechanical systems, we first require a manifold with a suitable contact structure. This contact structure is derived from the principles of thermodynamics in the next section. Subsequently, the contact Hamiltonian system and the equations of motion are set up in \cref{ssec:contact_dissipation}.

%One of most prominent applications of contact geometry in physics is the theory of thermodynamics. We will use the principles from thermodynamics to construct a suitable contact Hamiltonian system for dissipative systems in \cref{ssec:contact_dissipation}. First, however, the role of contact geometry in thermodynamics is explained in \cref{ssec:contact_thermodynamics}. 

\subsection{Contact geometry in dissipative mechanics}
\label{ssec:contact_dissipation}
As mentioned the contact structure will be derived based on thermodynamic reasoning. Therefore, the next section first discusses the traditional role of contact geometry in thermodynamics, after it will be applied to dissipative mechanics.

\subsubsection{Contact geometry in classical thermodynamics}
It has been argued in the past by several authors that contact geometry is the natural framework for thermodynamics by i.a. \citet{Arnold1991,Arnold1989a,Arnold1989,Arnold1989b}, \citet{Bamberg1988}, \citet{Burke1985} and \citet{Hermann1973}, ultimately leading back to the seminal work of \citet{Gibbs1873}. It is commonly seen as a testament to the brilliance of Gibbs' work that he managed to recognize and describe the correct geometric framework well before the required mathematical infrastructure was invented \cite{Wightman1979}. In recent years, the contact Hamiltonian formalism has been succesfully applied to thermodynamic theory by e.g. \citet{Mrugala1991,Mrugala2000,Mrugala1984,Mrugala1985,Mrugala1993,Mrugala1996}, \citet{Balian2001}, \citet{VanderSchaft2021a,VanderSchaft2018}, \citet{Maschke2018}, \citet{Bravetti2015}, and \citet{Simoes2020}. 

Contact geometry arises in thermodynamics as a consequence of the first law, which asserts that the change in internal energy of the system is equal to the difference between the heat added \emph{to} the system and the work performed \emph{by} the system. 

\paragraph{The first law of thermodynamics} To state the first law in the language of exterior forms, define the 1-forms \(\eta\) and \(\beta\) as the differential amounts of heat and work (in respective order) added to the system. \(\eta\) and \(\beta\) are 1-forms that are generally \emph{not} closed \cite{Bamberg1988,Frankel2012}. However, the first law states that the difference between them \emph{is} a closed form. Locally, this closed form  can be written as the gradient of a function called the \emph{internal energy} \(U\). Hence, we state the first law as\footnote{By using differential forms, the inexactness of the heat and work differentials need not be explicitly emphasized using additional notation such as \(\delta\) or \dj.}:
\begin{equation}
    \dd{U} = \eta - \beta.
    \label{eq:thermo_first_law}
\end{equation}
This equation can be equivalently expressed as the fact that the 1-form
\begin{equation}
    \alpha = \dd{U} - \eta + \beta
    \label{eq:first_law_contact}
\end{equation}
should pull back to zero over the physical trajectories of the systems.

\paragraph{The Gibbs 1-form} For the purposes of illustration, we now apply this concept to what is arguably the most simple thermodynamic system: the ideal gas in a piston. 

The ideal gas is characterized by five thermodynamic properties: the temperature \(T\), entropy \(S\), volume \(V\), pressure \(P\), and the internal energy \(U\). We call the five-dimensional space containing all the possible states the \emph{thermodynamic phase space}.

For the ideal gas, we have that the work done by the system is equal to the pressure multiplied by the change in volume, i.e. \(\beta = P\dd{V}\). Furthermore, heat added to the system is given by the temperature multiplied by the change of energy: \(\eta = T\dd{S}\) \cite{Arnold1989b,Wightman1979,Bamberg1988}. Therefore, \cref{eq:first_law_contact} becomes
\begin{equation}
    \alpha_\text{\tiny G} \coloneq \dd{U} - T\dd{S} + P\dd{V},
    \label{eq:gibbs_form}
\end{equation}
which is called the \emph{Gibbs form} (hence the subscript). It is clear that the Gibbs form defines a contact structure on the thermodynamic phase space (these are Darboux coordinates). Along the physically allowable trajectories, the Gibbs form must pull back to zero.

\paragraph{Legendre submanifolds} In contact geometry, submanifolds on which the contact form vanishes everywhere are called \emph{Legendre submanifolds}. As such, these submanifolds are vital in thermodynamics, because they contain the allowable states (\citet{Balian2001} call them thermodynamic manifolds). Due to the nonintegrability condition on the contact structure, Legendre submanifolds have at most dimension \(n\), if the overall contact manifold is of dimension \(2n + 1\).

For the ideal gas, the Legendre submanifolds are two-dimensional. They can be computed explicitly by integrating the Gibbs form. To do so, we need two additional \emph{equations of state}, 
\begin{equation}
    U = c\, n_\text{s}\, R_\text{g}\, T \qquad P \, V = n_\text{s} \, R_\text{g} \, T,
\end{equation}
where \(n_\text{s}\) is the amount of substance, \(R_\text{g} = \SI{8.314}{\joule \per \mole \per \kelvin}\) is the ideal gas constant and \(c\) is another constant dependent on the molecular nature of the gas\footnote{For a monatomic gas, \(c = \tfrac{3}{2}\).}. 

In addition, the internal energy is, by definition, a function of the extensive state properties: in this case, the entropy and the volume. We can therefore integrate the Gibbs form by rearranging the equations of state to express \(T\) and \(P\) in terms of \(S\) and \(V\) as well. Integrating \cref{eq:gibbs_form} yields
\begin{equation}
     U = \log(C_0) \: \ec^{\tfrac{S}{cn_\text{s}R_\text{g}}} \: V^{\tfrac{-1}{c}},
\end{equation}
where \(C_0\) is an integration constant. Since \( U = U(S, V)\), we have that
\begin{equation}
     \dd{U} = \pdv{U}{S}\dd{S} + \pdv{U}{V}\dd{V}.
\end{equation}
Hence, we can fully specify a Legendre submanifold by the integrated equation and the following conditions
\begin{equation}
     T = \pdv{U}{S} \qquad P = -\pdv{U}{V}.
\end{equation}

\subsubsection{Contact geometry of the damped harmonic oscillator}
The damped harmonic oscillator is shown in \cref{fig:dho}, together with its bond graph representation. We assume here that this system is completely isolated: there is no exchange of energy or matter with the environment.  
%The damping force of the damper is proportional to the relative velocity of its connection points. That is, \(F_\text{d} = b \dot{q} = \gamma p \), where \(\gamma \coloneq b/m\) is the damping coefficient.
\begin{figure}[ht!]
    \centering
    \input{media/tikz/damper_oscillator}
    \caption{The left figure shows a schematic of the mechanical damped harmonic oscillator with mass \(m\), spring constant \(k\), and damping constant \(b\). The bond graph representation is shown on the right. In addition to the I- and R-element in \cref{fig:ho}, there is now an R-element as well.}
    \label{fig:dho}
\end{figure}

\paragraph{Energy balance of the damped oscillator} We distinguish two types of energy that can be stored in the damped oscillator system: microscopic and macroscopic energy.

Microscopic energy consists of the kinetic energy of particles that do not result in an overall observable motion of the system. This energy is called internal energy \(U\) and manifests itself as temperature. 

Internal energy is stored in a `heat bath'. This is to be interpreted loosely: it can be the damper fluid, but also the surrounding air (although a heterogeneous medium will not allow for an unambiguous notion of temperature). We will not be concerned with all these possibilities and consider a single heat bath with a single temperature: generalizations to more complex thermodynamic systems are immediate. 

In contrast, macroscopic energy \emph{is} observable, either due to an observable motion of the system (kinetic energy) or the energy resulting from external force potentials (potential energy). Their sum is called the mechanical energy \(E\): in the damped harmonic oscillator, it is the sum of the kinetic energy stored in the mass (I-element) and the potential energy stored in the spring (C-element).

Since the system is isolated, the first law states that 
\begin{equation}
    \dd{(E + U)} = 0. 
    \label{eq:dho_first_law}
\end{equation}

Let us now decompose the system into two subsystems, one containing the mass and the spring and one the heat bath, as illustrated in \cref{fig:oscillator_thermo}. 
\begin{figure}[ht!]
    \centering
    \input{media/tikz/damper_oscillator_thermo}
    \caption{System boundaries of the damper-oscillator system. The mechanical subsystem stores mechanical energy \(E\) in the form of kinetic and potential energy, while the heat bath stores internal energy in the form of heat. The damper forms an interface between them.}
    \label{fig:oscillator_thermo}
\end{figure}

Through the dissipative action of the damper, energy flows from the mechanical subsystem to the heat bath. We can apply the first law to the subsystems separately, too: the first subsystem performs work on the damper, which manifests itself as the heat added to the heat bath. We therefore have
\begin{equation}
    \begin{split}
        \dd{E}  = -\beta, \\[0.2cm]
        \dd{U} = \eta, \\
    \end{split}
    \label{eq:dho_energy_balance}
\end{equation}
where \(\beta\) is the (differential) work done \emph{by} the mechanical subsystem on the damper and \(\eta\) is the (differential) heat added \emph{to} the second subsystem as a result of this. 

As a consequence of \cref{eq:dho_first_law}, we have that \( \beta = \eta \); i.e. all the work done by the damper enters the fluid as heat. For a linearly damped system, the work form is by definition equal to 
\begin{equation}
    \beta \coloneq \gamma p \dd{q},
    \label{eq:dho_work_form}
\end{equation}
with \(\gamma \coloneq b/m\) being the damping coefficient of the damped oscillator. 

\paragraph{Contact structure for the damped oscillator} We now define the phase space of the system to be equal to \(M = \real \times \ctbundle{Q}\), where \(Q\) is the configuration space considered in \cref{sec:symplectic}. For the damped harmonic oscillator, \(Q = \real\). With coordinates for \(M\) being \(U, q\) and \(p\), we can define a \emph{contact form} on this space by combining \cref{eq:dho_energy_balance} and \cref{eq:dho_work_form}: 
\begin{equation}
    \alpha = \dd{U} - \gamma p \dd{q}.
    \label{eq:dho_contact_form}
\end{equation}
This contact form specifies precisely how energy is dissipated in the system and enters the `reservoir' that is the heat bath, characterized by its internal energy \(U\).

Observe from \cref{eq:dho_contact_form} that \(\dd{\alpha} = \gamma \wedgep{\dd{q}}{\dd{p}}\), i.e. a multiple of the symplectic form used in \cref{sec:symplectic}. As such, the contact form contains \emph{both} information about the rate of dissipation present in the system, and about the pairing of the conjugate variables \(p\) and \(q\). We get the latter `for free' in this particular instance, since the pairing in this simple three-dimensional is rather trivial.

It is important to note that, in the general case, a 1-form that describes the dissipation in the system is \emph{under no obligation} to be of this very specific form (that is, one that pairs the conjugate variables). As such, we can not expect this situation to occur in general: this is the subject of \cref{sec:jacobi}.

\subsubsection{Contact Hamiltonian system for the damped harmonic oscillator}
With the contact structure defined, we can now establish the contact Hamiltonian system for the damped harmonic oscillator using \cref{eq:vertical_vf,eq:horizontal_vf,eq:contact_hamiltonian_vf}.

Recall that the Hamiltonian vector field is split into a horizontal and vertical component, which belong respectively to the kernel of \(\alpha\) and \(\dd{\alpha}\).

\paragraph{Vertical component of the Hamiltonian vector field} The Reeb vector field \(R_\alpha\) associated with the contact form given in \cref{eq:dho_contact_form} is 
\begin{equation}
     R_\alpha = \pdv{}{U}.
\end{equation}
As such, the vertical component of the Hamiltonian vector field is, in accordance with \cref{eq:vertical_vf}:
\begin{equation}
    X_K^\text{ver} = -K\pdv{}{U}.
    \label{eq:dho_vertical}
\end{equation}
However, we can only guess what the Hamiltonian function might be. Indeed, its definition is rather circular, since the vertical part of the vector field is \emph{defined} in terms of the vertical part and vice versa.

\paragraph{Horizontal component of the Hamiltonian vector field} The horizontal part is obtained by projecting \(\dd{K}\) (an arbitrary exact form) to a \emph{semi-basic} form, and mapping it to a vector field using the isomorphism \(\fromDual{\dd{\alpha}}\) like so:
\begin{equation}
     X_K^\text{hor} = \fromDual{\dd{\alpha}}(\dd{K} - \qty(\intpr{R_\alpha}{\dd{K}})\alpha).
\end{equation}
The Hamiltonian is a function on the contact manifold \(M\), i.e. \(K = K(U, q, p)\). In coordinates, the projected form is
\begin{equation}
    \pdv{K}{q}\dd{q} + \pdv{K}{p}\dd{p} + \pdv{K}{U} \gamma p \dd{q}.
    \label{eq:contact_semi-basic}
\end{equation}
The projection thus removes any term in \(\dd{U}\) (which makes it semi-basic).

Recall that \(\dd{\alpha} = \gamma \omega \). Therefore, we can compare the above equation to the purely symplectic case without dissipation, where the isomorphism is provided by \(\omega\) (cf. \cref{eq:symplectic_hamiltonian_vf}). The difference here is (apart from the factor \(\gamma\)) that we have to project \(\dd{K}\) by means of the term \(\qty(\intpr{R_\alpha}{\dd{K}}\alpha)\).

In the conservative case, we have that \(H = E = \frac{p^2}{2m} + \frac{1}{2}kq^2\). It is, therefore, reasonable to expect that the form in \cref{eq:contact_semi-basic} contains the differential of \(E\) (representing the conservative side, or the I- and C-element) plus an extra term that enforces the dissipation (R-element). 

Clearly, the rightmost term in \cref{eq:contact_semi-basic} \emph{is} the work form of the damper, i.e. the amount of energy escaping from \(E\). We can thus conjecture that the first two terms in \cref{eq:contact_semi-basic} amount to \(\dd{E}\).

However, there is one complication: \(\dd{\alpha}\) contains the factor \(\gamma\). To cancel this factor out, we include \(\gamma\) in the Hamiltonian as well. That is
\begin{equation}
     \pdv{K}{q}\dd{q} + \pdv{K}{p}\dd{p} = \gamma \qty(\pdv{E}{q}\dd{q} + \pdv{E}{p}\dd{p})
\end{equation}
and 
\begin{equation}
     \pdv{K}{U} = \gamma.
\end{equation}
As a result, the gradient of the Hamiltonian is equal to 
\begin{equation}
     \dd{K} = \gamma (\dd{E} + \dd{U}),
\end{equation}
and we obtain the correct Hamiltonian up to a closed form
\begin{equation} 
    K = \gamma (E + U) = \gamma\qty( \frac{p^2}{2m} + \frac{1}{2}kq^2 + U). 
    \label{eq:dho_hamiltonian}
\end{equation} 
Hence, the Hamiltonian function is equal to the total amount of energy in the system, both mechanical and internal, multiplied by the damping coefficient.

Now to derive the horizontal component of the vector field. The interior product of \(\omega\) with the basis vectors yields:
\begin{equation}
    \intpr{\pdv{}{q}}{\dd{\alpha}} = \gamma \dd{p} \qquad \intpr{\pdv{}{p}}{\dd{\alpha}} = -\gamma \dd{q}
\end{equation}
Clearly, the image of this mapping for any vector field is a semi-basic form. The inverse mapping must, to qualify as an isomorphism, map a semi-basic form back to a horizontal vector field (i.e. one that is in the kernel of \(\alpha\)). Hence, we have that
\begin{equation} 
    \fromDual{\dd{\alpha}}\qty(\dd{q}) = -\frac{1}{\gamma} \pdv{}{p} \qquad 
    \fromDual{\dd{\alpha}}\qty(\dd{p}) = \frac{1}{\gamma}\pdv{}{q} +  p \pdv{}{U}. 
\end{equation}
The term in \(\dd{U}\) ensures that the vector field is horizontal. Using this mapping, and expression for the Hamiltonian in \cref{eq:dho_hamiltonian}, we obtain the horizontal component of the Hamiltonian vector field:
\begin{equation} 
    X_K^\text{hor} = \frac{p}{m}\pdv{}{q} - (\gamma p + kq)\pdv{}{p} + \gamma \frac{p^2}{m} \pdv{}{U}.
    \label{eq:dho_horizontal}
\end{equation}

\paragraph{Equations of motion} Combining \cref{eq:dho_vertical} and \cref{eq:dho_horizontal}, the Hamiltonian vector field is
\begin{equation}
     X_K = \frac{p}{m}\pdv{}{q} - (\gamma p + kq)\pdv{}{p} + \qty(\gamma \frac{p^2}{m} - K)\pdv{}{U}.
\end{equation}
The corresponding equations of motion are 
\begin{equation}
    \begin{split}
        \dot{q} &= \frac{p}{m} \\
        \dot{p} &= -kq -\gamma p \\
        \dot{U} &= \gamma \frac{p^2}{m} - K(q, p, U) = \gamma p\dot{q} - K(q, p, U). \\
    \end{split}
\end{equation}
The correct dynamics are certainly obtained for \(p\) and \(q\). However, from a physical standpoint, we expect \(\dot{U}\) to be the rate of energy (i.e. the power) dissipated by the damper, i.e. equal to \(\gamma p \dot{q}\). However, the additional term \(-K(q, p, U)\) (a result of the vertical component of the vector field) contributes to the rate of change of \(U\) as well, `spoiling' the physical dynamics.

If we wish to impose that \(U\) indeed be the internal energy of the heat bath, the \emph{vertical vector field must vanish}. This is the case only if the Hamiltonian is numerically equal to zero, i.e. \(K = 0\). This equation is a so-called \emph{weak equality}, as opposed to a \emph{strong} or \emph{identical} equality. In the former case, the Hamiltonian is numerically equal to zero, but its partial derivatives do not vanish. That is to say, there is a specific submanifold of \(M\) on which \(K\) vanishes, but we are allowed to make variations that are not necessarily tangent to this submanifold (see \citet{Dirac1950} for further details). On this submanifold, the equations of motion read
\begin{equation}
    \begin{split}
        \dot{q} &= \frac{p}{m} \\
        \dot{p} &= -kq -\gamma p \\
        \dot{U} &= \gamma p\dot{q},\\
    \end{split}
\end{equation}
which indeed represent the damped harmonic oscillator with \(U\) being the dissipated energy.

From a thermodynamic standpoint, energy is only determined up to an additive constant, so this assertion would be admissible from a conceptual standpoint. Additionally, a value of 0 for the total energy is a common convention in literature, see for example \citet{Fermi1936}.

It is here that our result differs from the existing literature on this subject. The applicability of contact Hamiltonian systems has already been recognized from a mathematical standpoint by \citet{Bravetti2017}, resulting in the equations of motion including the vertical vector field. However, when the variables are given a physical interpretation (in particular, the `extra dimension' represented by \(U\)) as we do here, the vanishing of the Hamiltonian is crucial.
Leaving the vertical vector field in leads to extra `parasitic' dynamics that are unphysical and delude us from the intended meaning of the variable \(U\).

\paragraph{Why the Hamiltonian must vanish} The assumption that the contact Hamiltonian should be equal to zero is rather striking, and the preceding arguments do not provide a sound mathematical basis for it. Indeed, we could (and should) be quite leery of canceling terms using zero factors, for it often leads to unanticipated consequences or even downright contradictions. This is why we provide some more mathematically oriented arguments to show that this is indeed allowed.

\begin{figure}[ht!]
    \centering
    \input{media/tikz/dho_trajectories}
    \caption{Integral curves of \(X_K\) for \(b = \SI{0.3}{\kilogram \per \second}\), \( m = \SI{1}{\kilogram}\) and  \(k = \SI{10}{\kilogram \per \second \squared}\). The left plot shows the physical trajectory (\(K = 0\)) in black, together with some neighboring non-physical trajectories that approach the black trajectory with increasing time. The trajectories on the right are all unphysical but show the case where we would choose a zero initial value for \(U\) (also with some perturbations). The `wobble' is caused by the exponentially decaying value of the Hamiltonian being counterbalanced with the nonuniform decrease of the mechanical energy in the system. In this case, \(U\) clearly does \emph{not} represent the internal energy of the heat bath or any other physical variable.}
    \label{fig:dho_trajectories}
\end{figure}

Recall from \cref{eq:psi_definition} that, by definition, \(K = -\intpr{X_K}{\alpha}\). In the previous section, we defined Legendre submanifolds as manifolds on which the contact form pulls back to zero: in other words, tangent vectors to a Legendre manifold produce zero when contracted with the contact form. So, \(K\) measures in essence how `non-Legendrian' an integral manifold of \(X_K\) is. We have stipulated earlier that Legendre submanifolds contain physically meaningful trajectories. That is, the dynamics must take place on a Legendre submanifold to be physical, which is why \(K = 0\).

As an additional argument, we can show that
\begin{equation}
     \lied{X^{\text{hor}}_K}{K} = 0 \quad \Rightarrow \quad \dv{K}{t} = \lied{X^{\text{ver}}_K}{K} = -K\pdv{K}{U}.
\end{equation}
Hence, if the Hamiltonian does not vanish, it changes exponentially over time (for its change is proportional to its own value). If \(\gamma > 0\), the Hamiltonian decays exponentially from its initial value:
\begin{equation} 
    K(t) = K_0\,\ec^{-\gamma t}.
    \label{eq:contact_ham_growth}
\end{equation}
As a result, any nonphysical trajectories will approach a Legendre submanifold as time proceeds; the associated vector fields also become ever more tangent to the Legendre submanifold. 

Based on the expression for \(K\), an expression for \(U\) may also be derived:
\begin{equation}
     U(t) = \frac{1}{\gamma}\,\qty( K_0\,\ec^{-\gamma t} - E ).
\end{equation}
If \(K = 0\), the internal energy is equal to the negative of the mechanical energy in the system. These findings are illustrated by \cref{fig:dho_trajectories}: the left plot shows perturbations of the `ideal' physical trajectory. The right plot shows the trajectories for an initial value of \(U = 0\) (also with perturbations); as a result of the above equation, \(U\) `wobbles' around its zero point; but it is clearly not a physical trajectory.

Finally, recall that the contact form \(\alpha\) is not uniquely determined with respect to the associated contact structure. It can be multiplied with any nonzero function and still represent the same contact structure.

We can regard this ambiguity as a gauge transformation of the system (cf. \citet{Balian2001}). However, the Hamiltonian is not intrinsically invariant under these transformations; if \( \alpha' = f \alpha \) (\(f\) being a function without zeros), then the mapping \(\Psi_\alpha'\) and the corresponding Hamiltonians are also different: \cite[p. 321]{Libermann1987} 
\begin{equation}
    \Psi^{-1}_{\alpha'}(K) = \Psi^{-1}_{\alpha}\qty(\frac{1}{f}\,K).
    \label{eq:contact_ham_scaling}
\end{equation}
The vertical component \emph{is} directly dependent on the numerical value of the Hamiltonian. As a result, the \emph{only} way to maintain invariance under the gauge transformation (which we assert to be crucial for it to be of physical significance) is to set \(K = 0\).

[intro to symplectification]

\subsection{Symplectification of contact Hamiltonian systems}
\label{ssec:symplectification}
In this section, we use a procedure called \emph{symplectification} to cast the contact manifold of the previous section on a symplectic manifold in a canonical fashion. The advantage of this method is that the calculations for the dynamics are considerably simplified since we can use the theory outlined in \cref{sec:symplectic}. To quote Vladimir Arnol'd, who originally came up with the concept of symplectification, `one is advised to calculate symplectically but to think rather in contact geometry termsâ€™ \cite{VanderSchaft2021a,Arnold1989a}.

In addition, we show that the resulting `symplectified' Hamiltonian system explains the particular form of a popular existing model for the damped harmonic oscillator, using an explicit time-dependence: the Caldirola-Kanai Hamiltonian.

\subsubsection{Symplectification of contact manifolds}
To make the process of symplectification mathematically precise, we first need to move to a slightly different space than the manifold \(M\) used in the previous section. \(M\) is the product manifold of the cotangent bundle of \(Q\) (the space of the position \(q\)) with the real line to accommodate \(U\). In contrast, we now start with the \emph{extended configuration manifold} \(Q_e \cong \real^2\), equipped with an extra position coordinate \(q_e\)\footnote{In this case, the `0' is a label for the extra position coordinate $q_e$ --- we wish not to refer to the other position as $q^1$ because there is only one real position of the mass. Because the other coordinates are not numbered, we do not make the notational distinction between contravariant and covariant components, and use a subscript to label the extra coordinates.}. That is,
\begin{equation}
     (q_e, q) \in Q_e.
\end{equation}

\paragraph{The manifold of contact elements} Consider now the \emph{manifold of contact elements} of \(Q_e\). This is a fiber bundle with base \(Q_e\), and the fibers at each point are the space of lines (through the origin) in the tangent space to \(Q_e\) at that specific point. For more details about the manifold of contact elements, the reader is referred to \cref{app:contact_geometry}.

The fibers of this bundle are projective spaces; more specifically, they are diffeomorphic to the one-dimensional real projective line \(\mathbb{P}\real\). The fibers are therefore compact. It can be shown that the manifold of contact elements of \(Q_e\) (or any manifold) is diffeomorphic to the projectivization of its tangent bundle: we denote this by \(\pctbundle{Q_e}\) \cite{Cannas2001,Arnold1989,Libermann1987}.

\begin{figure}
    \centering
    \input{media/tikz/contact_element_2}
    \caption{A contact element on the manifold \(Q_e\) is a line through the origin in the tangent space. The manifold of contact elements of \(Q_e\) is the space of all contact elements at every tangent space to \(Q_e\).}
    \label{fig:manifold_contact_elements}
\end{figure}

The manifold \(\pctbundle{Q_e}\) is three-dimensional. Consider the following chart for \(\pctbundle{Q_e}\) with coordinates:
\begin{equation}
     (q_e, q, p)
\end{equation}
where \(p\) represents the \emph{slope} of the line in the tangent space, illustrated in \cref{fig:manifold_contact_elements}. This chart cannot cover the entire manifold, for the fiber is compactified at the point \(p = \infty\) (in this specific chart). 

Because \(p\) is meant to represent momentum just like in the previous section, and infinite momentum lies outside our realm of interest, this space can be thought of as roughly equivalent (for practical purposes) to \(M\). That is to say, by disregarding the point \(p = \infty\), we end up with a manifold that is diffeomorphic to \(M\).

The manifold of contact elements \(\pctbundle{Q_e}\) is equipped with a natural contact structure \cite{Arnold1989}, represented by
\begin{equation}
    \alpha_e = \dd{q}_0 - p\dd{q}.
\end{equation}
Observe the similarity with the contact form \(\alpha\) defined in \cref{eq:dho_contact_form}: 
\begin{equation}
     \alpha_e = \frac{1}{\gamma}\alpha, \qquad q_e = \frac{U}{\gamma}.
\end{equation}
Because the contact forms differ simply by multiplication, they represent the same contact structure (provided that \(\gamma\) is nonzero).

\paragraph{Contact Hamiltonian system in Darboux coordinates} The contact Hamiltonian system \((M, \alpha, K)\) damped harmonic oscillator can be defined on the manifold of contact elements as well, with the silent understanding that \(M\) and \(\pctbundle{Q_e}\) are slightly different from a topological perspective. Since the new contact form is scaled by \(\tfrac{1}{\gamma}\), we can use relation \cref{eq:contact_ham_scaling} to find the new Hamiltonian \(K_e\):
\begin{equation}
     K_e = \frac{1}{\gamma} K.
\end{equation}
Furthermore, because \(U = \gamma q_e\), the contact Hamiltonian in the new coordinates is
\begin{equation}
    K_e(q_e, q, p) = \frac{p^2}{2m} + \frac{1}{2}kq^2 + \gamma q_e.
    \label{eq:dho_contact_hamiltonian_e}
\end{equation}
Numerically, \(K_e\) is equal to the total energy in system (the scaling factor is removed). Observe also that the units of the Hamiltonian have been changed from power to energy.

The corresponding Hamiltonian vector field is then
\begin{equation}
    X_{K_e} = \frac{p}{m}\pdv{}{q} + (\gamma p - kq) \pdv{}{p} + \qty[\frac{p^2}{m} - K_e(q_e, q, p)]\pdv{}{q_e}. 
    \label{eq:ham_vf_e}
\end{equation}
If we enforce that \(K = 0\) (as motivated in the previous section), then \(K_e\) vanishes as well and the vector field becomes 
\begin{equation}
    X_{K_e}\vert_{K_e = 0} = \frac{p}{m}\pdv{}{q} + (\gamma p - kq) \pdv{}{p} + \frac{p^2}{m}\pdv{}{q_e}.
    \label{eq:ham_vf_e_liouville}
\end{equation}

This contact Hamiltonian system can be lifted to the symplectification of the contact manifold \(\pctbundle{Q_e}\).

\paragraph{Symplectification of a contact Hamiltonian system} The procedure known as symplectification of a contact manifold turns a contact manifold in a symplectic manifold, thereby raising its dimension by one. The power of this method resides in the fact that this can be done in a canonical fashion: it is uniquely determined by the contact structure of the contact manifold \cite{Arnold1989}.

The symplectification procedure exploits the natural ambiguity that contact forms have, and that has been pointed out already. Multiplying the contact form \(\alpha_e\) with any nonzero real number\footnote
{
    \(\real^\times\) denotes both the real multiplicative group and the underlying set, being the real line excluding zero. 
} \(\lambda \in \real^\times\)
\begin{equation}
    \lambda (\dd{q_e} - p \dd{q}). 
    \label{eq:lambda_alpha}
\end{equation}
The above expression gives a representation of \emph{al} the contact forms that give rise to the same contact structure as \(\alpha_e\). Hence, if \(\lambda\) is considered to be an additional coordinate in its own right, we move to a four-dimensional space with coordinates \((q_e, q, p, \lambda)\); this is the space of all contact forms on the contact manifold. 

We now effect the following coordinate transform:
\begin{equation}
     \rho \coloneq -\lambda p \qquad \rho_e \coloneq \lambda. \
\end{equation} 
Hence, \cref{eq:lambda_alpha} becomes 
\begin{equation}
    \rho_e\dd{q_e} + \rho \dd{q} \equalscolon \theta_e
    \label{eq:liouville_form_extended}
\end{equation}
which is the Liouville form on the cotangent bundle \(\ctbundle{Q_e}\) in Darboux coordinates, denoted by \(\theta_e\). From this form, we obtain the canonical symplectic structure on 
\(\ctbundle{Q_e}\) as follows
\begin{equation}
    \omega_e \coloneq -\dd{\theta} = \wedgep{\dd{q_e}}{\dd{\rho_e}} + \wedgep{\dd{q}}{\dd{\rho}}.
    \label{eq:symplectic_form_extended}
\end{equation}

The coordinate \(\lambda\), and therefore \(\rho_e\) and \(\rho\), are not canonical coordinates, for they depend on the particular choice of the contact form, to begin with. Indeed, in this particular choice of \(\alpha_e\) one point in the fiber is left out (\(p = \infty\)), which effectively rules all the points for which \(\rho_e = 0\). 

In reality, only the points for which \emph{both} \(\rho\) and \(\rho_e\) vanish should be taken out of the manifold, because the other cases can be covered by picking a different coordinate chart (this will be made clear later). The resulting space is the cotangent bundle of \(Q_e\) without its zero section, denoted by \( \ctzbundle{Q_e}\) \cite{VanderSchaft2021a,Libermann1987}.

As illustrated by the point above, the former discussion relies heavily on the choice of the particular coordinate chart. Therefore, we wish to make the symplectification procedure more mathematically precise using the language of principal bundles.

\subsubsection{Liouville geometry and principal G-bundles}
A \emph{principal} \(G\)\emph{-bundle} is a smooth bundle \(\bundle{P}{\sigma}{B}\) if \(P\) is equipped with a \emph{free} right \(G\)-action \(\raction{}\), where \(G\) is a Lie group. Furthermore, let  
\begin{center}
    \begin{tikzcd} 
        P \arrow[d, "\sigma" ]\\
        B
    \end{tikzcd}
    \(\quad \cong_\text{\tiny bundle} \quad \)
    \begin{tikzcd} 
        P \arrow[d, "\sigma'" ]\\
        P/G
    \end{tikzcd}
\end{center}
where \(\sigma'\) is the quotient map that sends each point in \(P\) to the corresponding point in the orbit space \(P/G\). In other words, if we define the equivalence relation between two points \(x_1, x_2 \in P\) as
\begin{equation}
     x_1 \sim x_2 \quad \Leftrightarrow \quad \exists g \in G:\: x_2 = x_1 \raction{g},
\end{equation}
then 
\begin{equation}
     \sigma':\: P \to P/G:\quad x \mapsto [x]_\sim,
\end{equation}
with \([x]_\sim\) being the equivalence class with respect to \(\sim\) and \(P/G = P/\sim\).\footnote{This is the definition used in the lectures of F. P. Schuller, see \cite{Schuller2014}.}

\paragraph{Principal \texorpdfstring{\(\real^\times\)}{R}-bundles} In our context of symplectification, the Lie group in question is the real multiplicative group \(\real^\times\). The group acts on the cotangent bundle of \(Q_e\) without zero section\footnote
{
    The zero section must be removed from the cotangent bundle because otherwise, the group action defined above is not free (the origin of any cotangent space is stabilized by the entire group). If the group action is free, the orbits are diffeomorphic to the group itself. if this is not the case, not all the orbits are diffeomorphic to each other, and the `bundle of orbits' would not be a fiber bundle. In this case, the origin (being the orbit of the origin) is of course not diffeomorphic to the other orbits (lines with a point removed).
}
(i.e. \ctzbundle{Q_e}) through \emph{dilation of its fibers}. In the coordinates defined above, we define the group action \(\raction{\real^\times}\) as:
\begin{equation}
     \raction: \ctzbundle{Q_e}\times\mgroup \to \ctzbundle{Q_e} : \quad (q_e, q, \rho_e, \rho) \blacktriangleleft \lambda = (q_e, q, \lambda \rho_e, \lambda \rho ) \qquad \lambda \in \mgroup.
\end{equation}

The orbit space of \(\ctzbundle{Q_e}\) with respect to \(\raction{\real^\times}\) is precisely equal to the projectivization of the cotangent bundle \(\pctbundle{Q_e}\). As a result, we have the principal \(\mgroup\)-bundle structure given by the following diagram:
\begin{center}
    \begin{tikzcd}
        \ctzbundle{M} \\ \ctzbundle{M} \arrow[u, "\raction{\mgroup}"] \arrow[d, "\sigma"] \\ \pctbundle{M}.
    \end{tikzcd}
\end{center}

The symplectification \(\ctzbundle{Q_e}\) is therefore a principal \(\mgroup\)-bundle, with as base manifold the contact manifold \(\pctbundle{Q_e}\). The projection map \(\sigma\) is equal to
\begin{equation}
     \sigma: \ctzbundle{Q_e} \to \pctbundle{Q_e}: \quad (q_e, q, \rho_e, \rho) \mapsto (q_e, q, -\rho/\rho_e).
\end{equation}

A geometric perspective of this construction is given in \cref{fig:principal_bundle}. Both \(\ctzbundle{Q_e}\) and \(\pctbundle{Q_e}\) are also bundles over the extended configuration space \(Q_e\). At a specific point of \(Q_e\), say \(x\), we have two fibers. The fiber \(\ctzspace{x}{Q_e}\) is the cotangent space to \(x\) without the origin. The group action \(\rangle{\mgroup}\) manifests itself as dilations of the fiber: this is indicated by the arrows. The \emph{orbits} of this group are lines through the origin, with the origin removed (which is topologically the same space as \(\mgroup\) itself, since the action is free). 
\begin{figure}[ht!]
    \centering
    \input{media/tikz/principal_bundle}
    \caption{Illustration of the principal \(\mgroup\)-bundle \(\bundle{\ctzbundle{M}}{\pi}{\pctbundle{M}}\). \(x\) is a point in the extended configuration space \(Q_e\), where we attach fibers \(\ctzspace{x}{Q_e}\) and \(\pctspace{x}{Q_e}\). The orbits of the group action \(\raction{\mgroup}\) on \(\ctzbundle{Q_e}\) are identified by \(\sigma\) and mapped to the orbit space \(\pctbundle{M}\). }
    \label{fig:principal_bundle}
\end{figure}

The space of all orbits is a circle with antipodal points identified, which also has the topology of a circle: this is the space \(\mathbb{P}\real\), and it is the fiber \(\pctspace{x}{Q_e}\) of \(\pctbundle{Q_e}\) at the point \(x\). The projection map that takes a point in \(\pctbundle{x}{Q_e}\) to its associated orbit in the orbit space is \(\sigma\). 

In \cref{fig:principal_bundle}, the coordinate chart used for \(\pctbundle{Q_e}\) is indicated as well: \(p = -\rho/\rho_e\), which is as the negative of the slope of that line. This coordinate chart covers almost the entire fiber, apart from one `point' (i.e. orbit): the north and south poles of the circle on the right.

From the perspective of \(\pctbundle{Q_e}\), \(\rho_e\) and \(\rho\) can also be seen as \emph{homogeneous coordinates} for this space.

\paragraph{Principal bundles in system theory}
To illustrate the concept of principal bundles and their relevance, we give an instructive example of principal bundles in control theory. For more information, the reader is referred to \citet{Hermann1984}. 

LTI systems can be represented both as a collection of state-space matrices or in the frequency domain using a transfer matrix. The state-space representation is typically given in the specified by a collection of four matrices: \(A, B, C, D\). For an LTI system with \(n\) states, \(m\) inputs and \(o\) outputs, we have:
\begin{equation}
     A \in \real^{n \times n} \quad B \in \real^{n \times m} \quad C \in \real^{o \times n} \quad D \in \real^{o \times m}.
\end{equation}
Hence, the `manifold of LTI systems' given these dimensions is diffeomorphic to \cite{Verhaegen2007} \begin{equation}
     \real^{\ell}, \quad \ell = n^2 + nm + on + om.
\end{equation}  
This is the total space of the principal bundle.

A state space representation of a transfer matrix is not unique: any similarity transform of the state space yields different state space matrices that correspond to the same transfer matrix. Hence, the \emph{structure group} is in this case the general linear group of dimension \(n\), \(\glgroup{n}{\real}\), which contains all the similarity transforms. The group action \(\raction{\glgroup{n}{\real}} \) is defined as follows:
\begin{equation}
     (A, B, C, D) \raction{T} = (T A T^{-1}, TB, CT^{-1}, D).
\end{equation}

The orbit space \(\real^\ell/\glgroup{n}{\real}\) can be identified with the space of transfer matrices. The projection map that takes the state space representation to a transfer matrix is given by
\begin{equation}
     \sigma(A, B, C, D) = C(s I - A )^{-1} B + D,
\end{equation}
which is invariant with respect to group action.

The topology of the orbit space, and therefore of the space of transfer matrices, is highly nontrivial. This makes the process of system identification very challenging, for there are usually no easy coordinate charts of this space \cite{Verhaegen2007,Hermann1984}.

\subsubsection{Homogeneous Hamiltonian systems}
In this section, we will lift the contact Hamiltonian system defined in \cref{ssec:contact_dissipation} to the symplectified manifold, resulting in a symplectic Hamiltonian system with an \emph{Liouville structure} additional structure.

\paragraph{Liouville structures} The symplectified space \(\ctzbundle{Q_e}\) has a symplectic structure because the cotangent bundle (with zero section removed) is canonically equipped with one. Moreover, the group action that makes it into a principal bundle provides an additional structure: a \emph{symplectic Liouville structure}, which requires that the symplectic 2-form is \emph{homogeneous of degree 1} with respect to the group action \(\raction{\mgroup}\). That is,
\begin{equation}
     (\raction{\lambda})^* \omega_e = \lambda\,\omega_e, \qquad \lambda \in \mgroup,
\end{equation}
which is indeed the case for \(\omega_e\) as defined in \cref{eq:symplectic_form_extended} \cite{Libermann1987}. Because the group action \(\raction{\mgroup}\) is free, the symplectic Liouville structure is said to be \emph{fibered} \cite{Libermann1987}.

It can be shown that there is again a mapping between the smooth functions on the manifold with Liouville structure and vector fields that preserve this structure\footnote
{For a vector field \(X\) to preserve the Liouville structure means (i) that it preserves \(\omega_e\), i.e. \(\lied{X}{\omega_e} = 0\), and (ii) that it is invariant under the group action: \( (\raction{\lambda})_* X = X\) (\(\lambda \in \mgroup)\). }, along the same line as for the symplectic manifolds in \cref{sec:symplectic} and the contact manifolds earlier in this section.

The smooth functions, in this case, are not completely arbitrary, since they must also comply with the Liouville structure. More precisely, they must be \emph{homogeneous} of degree 1 with respect to the group action \(\raction{\mgroup}\). For a function \(\mathscr{H}\) on \(\ctzbundle{Q_e}\) to be homogeneous means it must satisfy the following condition
\begin{equation}
     (\raction \lambda )^* \mathscr{H} = \lambda \mathscr{H}.
\end{equation}
In the coordinates defined above, this is equivalent to:
\begin{equation}
     \mathscr{H}(q_e, q, \lambda \rho_e, \lambda \rho) = \lambda\mathscr{H}(q_e, q, \rho_e, \rho) \qquad \lambda \in \mgroup,
\end{equation}
which is to say that \(\mathscr{H}\) \emph{commutes} with the group action.

Thus, we have an isomorphism between the vector fields preserving the Liouville structure and the homogeneous functions on the manifold. 
This manifold is symplectic, so isomorphism is defined in terms of the symplectic form \(\omega_e\) like so (and in an identical fashion to \cref{eq:symplectic_isomorphism}),
\begin{equation}
     \fromDual{\omega_e}(\dd{\mathscr{H}}) = X_\mathscr{H}.
\end{equation}

This gives rise to the notion of \emph{homogeneous Hamiltonian systems}, consisting of a manifold with fibered symplectic Liouville structure and a homogeneous Hamiltonian function \(\mathscr{H}\).

\paragraph{Equations of motion for the symplectified system} The contact Hamiltonian system for the damped harmonic oscillator, as defined by \cref{eq:dho_contact_hamiltonian_e}, can now be lifted to a homogeneous Hamiltonian system on the symplectified space. The relation between the contact Hamiltonian and the corresponding homogeneous Hamiltonian is defined as \cite{VanderSchaft2021a,Libermann1987,Arnold1989}
\begin{equation}
     K_e(q_e, q, p) = \mathscr{H}(q_e, q, -1, \rho),
\end{equation}
or equivalently
\begin{equation}
    K_e\qty(q_e, q, -\frac{\rho}{\rho_e}) = \mathscr{H}(q_e, q, \rho_e, \rho). 
    \label{eq:H_contact_homo}
\end{equation}

Based on \cref{eq:dho_contact_hamiltonian_e}, we obtain the following expression for the homogeneous Hamiltonian:
\begin{equation}
    \mathscr{H}(q_e, q, \rho_e, \rho) = -\rho_e\,\qty[\frac{1}{2m}\qty(-\frac{\rho}{\rho_e})^2 + \frac{1}{2}kq^2 + \gamma q_e]. 
    \label{eq:H_dho_homo}
\end{equation}

The Hamiltonian vector field is easily obtained, for we can use the mapping \(\fromDual{\omega_e}\). As already mentioned this is a major advantage of performing calculations in the symplectified space. We have
\begin{equation}
     X_\mathscr{H} = \fromDual{\omega_e}(\dd{\mathscr{H}}),
\end{equation} 
with
\begin{equation}
     \dd{\mathscr{H}} = \pdv{\mathscr{H}}{q_e}\dd{q_e} 
                      + \pdv{\mathscr{H}}{q}\dd{q}
                      + \pdv{\mathscr{H}}{\rho_e}\dd{\rho_e}
                      + \pdv{\mathscr{H}}{\rho}\dd{\rho}.
\end{equation}

It is instructive to first specify the partial derivatives of \(\mathscr{H}\) in terms of \(K_e\), so as to compare the generic equations of motion obtained from \(\mathscr{H}\) to those obtained from \(K_e\) (cf. \cref{eq:ham_vf_e}). Using \cref{eq:H_contact_homo}, the partial derivatives can be expressed in terms of the contact Hamiltonian \(K_e\):
\begin{equation}
    \begin{split}
        \pdv{\mathscr{H}}{q} &= -\rho_e \pdv{K_e}{q}, \\
        \pdv{\mathscr{H}}{q_e} &= -\rho_e \pdv{K_e}{q_e}, \\
        \pdv{\mathscr{H}}{\rho} &= -\rho_e \pdv{K_e}{p}\pdv{p}{\rho} = \pdv{K_e}{p}, \\
        \pdv{\mathscr{H}}{\rho_e} &= -H - \rho_e \pdv{K_e}{p}\pdv{p}{\rho_e} = -K_e - \pdv{H}{p}\frac{\rho}{\rho_e} = \pdv{H}{p}p - K_e.\\
    \end{split}
    %\label{eq:partial_relation}
\end{equation}
The homogeneous Hamiltonian vector field is then
\begin{equation}
    X_\mathscr{H} = \qty(\pdv{K_e}{p}p - K_e)\pdv{}{q_e}
                    + \pdv{K_e}{p}\pdv{}{q}
                    + \rho_e\pdv{K_e}{q_e}\pdv{}{\rho_e}
                    + \rho_e\pdv{K_e}{q}\pdv{}{\rho}.
    \label{eq:hom_ham_vf}
\end{equation}
%\begin{equation}
%    \begin{split}
%        &\dot{q}_0      = \pdv{H}{p}p - H, \\
%        &\dot{q}        = \pdv{H}{p}, \\
%        &\dot{\rho}_0   = \rho_e\pdv{H}{q_e}, \\
%        &\dot{\rho}     = \rho_e \pdv{H}{q}.
%    \end{split}
%\end{equation}
The equations of motion \(q_e\) and \(q\) remain identical to those obtained earlier; this is to be expected since otherwise, the dynamics would not correspond. 

For \(\rho_e\), we have
\begin{equation}
     \dot{\rho}_0 = \rho_e \pdv{K_e}{q_e} = \rho_e \pdv{K_e}{q_e}  = \gamma\rho_e \quad \Rightarrow \quad \rho_e = C\ec^{\gamma t},
\end{equation} 
where \(C\) is an integration constant which we can choose to be 0, so \(\rho_e(t) = \ec^{\gamma t}\).

In addition, \(\dot{\rho} = \rho_e kq = \ec^{\gamma t} kq\). Since \(p = -\rho/\rho_e\), the dynamics of \(p\) can be obtained from  \(\dot{\rho}_0\) and \(\dot{\rho}\) using the product rule:
\begin{equation} 
    \dot{p} = -\frac{\dot{\rho}}{\rho_e} + \frac{\rho}{\rho_e}\frac{\dot{\rho}_0}{\rho_e} = -kq - \gamma p,
    \label{eq:pdot}
\end{equation}
which is equivalent to the expression obtained in \cref{ssec:contact_dissipation}.

Observe that these equations of motion are invariant under the earlier defined group action \(\raction{\mgroup}\), which means that the vector field indeed preserves the Liouville structure. The other condition is that it preserves \(\omega_e\), but this is satisfied rather trivially as a result of the mapping \(\fromDual{\omega_e}\).
%The Hamiltonian vector field then becomes
%\begin{equation}
%    X_{\mathscr{H}} = -\frac{1}{m}\frac{\rho}{\rho_e}\pdv{}{q}\: + \: \qty[\frac{1}{2m}\qty(\frac{\rho}{\rho_e})^2 - \frac{1}{2}kq^2 - \gamma q_e]\pdv{}{q_e}\: + \: \rho_e kq \pdv{}{\rho}\: + \: \gamma \rho_e \pdv{}{\rho_e}.
%    \label{eq:homo_vf}
%\end{equation}

\paragraph{Liouville submanifolds} In \cref{ssec:contact_dissipation} we devoted considerable attention to the fact that the contact Hamiltonian should numerically be equal to zero for the equations of motion to represent a physical trajectory. This is equivalent to stating that the trajectories lie in Legendre submanifolds.

As pointed out by \citet{VanderSchaft2021a} and \citet{Libermann1987}, because of the equivalence between contact and Liouville structures, the notion of Legendre submanifolds can be lifted to the symplectified space as well. Indeed, from \cref{eq:liouville_form_extended} we can observe that if \(\alpha_e\) pulls back to zero on the trajectories in the contact manifold, so should \(\theta_e\) on the lifted trajectories, for they only differ by multiplication with \(\rho_e\). These are called \emph{Liouville submanifolds} and are a special subclass of Lagrangian submanifolds\footnote{Lagrangian submanifolds satisfy the weaker condition that the symplectic 2-form \(\omega_e\) vanishes when restricted to them. This is also the case when \(\theta_e\) vanishes, but the converse is not necessarily true.}

Using \cref{eq:hom_ham_vf}, we find that 
\begin{equation}
     \intpr{X_\mathscr{H}}{\theta_e} = -K_e,
\end{equation}
which means that the contact Hamiltonian (i.e. the total energy in the system)
must be equal to zero for the lifted trajectories to lie in a Liouville submanifold.

For yet another perspective regarding this point, we can make use of the symplectic nature of the homogeneous Hamiltonian. Indeed, no matter what the value of \(K_e\), the homogeneous Hamiltonian \(\mathscr{H}\) \emph{must} be constant over time because it does explicitly depend on it. Since the dynamics are symplectic, we can simply use Poisson brackets to support this fact:
\begin{equation}
     \dot{\mathscr{H}} = \poisson{\mathscr{H}}{\mathscr{H}} + \pdv{\mathscr{H}}{t} = 0.
\end{equation}

Hence, we can set the Hamiltonian equal to a constant, say \(\mathscr{H}(t) = \mathscr{H}_0\). But, we also know from \(\mathscr{H} = \rho_e K_e = \ec^{\gamma t} K_e\). Hence, it is now very easy to see that \(K_e\) either  decays exponentially (if \(\gamma > 0\)), for it then cancels exactly the exponential growth of \(\rho_e\), or it equals to zero. This is equivalent to \cref{eq:contact_ham_growth}. On Liouville submanifolds, both the homogeneous Hamiltonian and the contact Hamiltonian vanish, which amounts to the particular choice that \(\mathscr{H}_0 = 0\).

If we assume that the dynamics take place on a Liouville submanifold, the Hamiltonian vector field becomes
\begin{equation}
     X_\mathscr{H}\vert_{\mathscr{H}_0 = 0} =  -\frac{1}{m}\frac{\rho}{\rho_e}\pdv{}{q}\: + \: \pdv{}{q_e}\: + \: \rho_e kq \pdv{}{\rho}\: + \: \gamma \rho_e \pdv{}{\rho_e}.
\end{equation}
If this vector field is be projected to \(\pctbundle{Q_e}\) using the pushforward of the projection map \(\sigma\), we obtain \cref{eq:ham_vf_e_liouville}.\footnote{This is the `differential geometric' way of deriving the equation for \(\dot{p}\) as we did above.}

\subsubsection{Relation with the Caldirola-Kanai Hamiltonian}
In this section, we show that the homogeneous Hamiltonian is equivalent to a well-known existing model for the damped harmonic oscillator, the Caldirola-Kanai Hamiltonian (and Lagrangian).

The Caldirola-Kanai Hamiltonian, commonly attributed to \citet{Caldirola1941} and \citet{Kanai1948}, is a method to describe the linearly damped harmonic oscillator using a Lagrangian or Hamiltonian function that explicitly depends on time. It was originally motivated for the purposes of quantum mechanics.

We depart from the Lagrangian function for it depends directly on physical coordinates \(q\) and \(\dot{q}\), as opposed to the Hamiltonian. The Caldirola-Kanai Lagrangian is
\begin{equation}
    \Lck(q, \dot{q}, t) = \ec^{\gamma t}\qty(\frac{1}{2}m\dot{q}^2 - \frac{1}{2}kq^2).
    \label{eq:lag_CK}
\end{equation}
The correct equations of motion are readily derived through the Euler-Lagrange equations:
\begin{equation}
    \begin{split}
        \dv{}{t}\qty(\pdv{\Lck}{\dot{q}}) - \pdv{\Lck}{q} &= 0, \\
        \dv{}{t}\qty(\ec^{\gamma t } m \dot{q}) + \ec^{\gamma t} kq &= 0, \\
        \ec^{\gamma t } \qty(m\ddot{q} + m\gamma\dot{q} + kq)  &= 0, \\
        m\ddot{q} + m\gamma\dot{q} + kq &= 0. \\
    \end{split}
\end{equation}

The Caldirola-Kanai Hamiltonian is obtained from the Lagrangian by means of a Legendre transform. The Legendre transform is effected with respect to the \emph{canonical momentum}
\begin{equation}
     \rho = \pdv{\Lck}{\dot{q}} = \ec^{\gamma t} m \dot{q},
\end{equation}
which is manifestly different from the kinematic momentum \(p = m\dot{q} = \rho \ec^{-\gamma t}\).

The Hamiltonian is then equal to
\begin{equation}
     \Hck = \rho\dot{q} - \Lck =  \frac{\Pcan^2}{2m}\ec^{-\gamma t} + \frac{1}{2}kq^2\ec^{\gamma t}.
\end{equation}
Because the Hamiltonian is explicitly time-dependent, the associated Hamiltonian vector field will be time-dependent as well\footnote
{A \emph{time-dependent vector field} on a manifold \(N\) is a mapping \(X: N\times\real \to \tbundle{N}\) such that for each \(t \in \real\), the restriction \(X_t\) of \(X\) to \(N \times \{t\}\) is a vector field on \(N\). \cite{Libermann1987} An additional construction of importance, called the \emph{suspension} of the vector field, is the mapping \begin{equation}
     \tilde{X}: \real \times N \to \tbundle{(\real \times N)} \quad (t, n) \mapsto ((t, 1), (n, X(t, n))),
\end{equation} that is to say, the suspension lifts the vector field to the extended space that also includes \(t\) and assigns the time coordinate with a trivial velocity of 1 \cite{Abraham1978}.}.

The construction of the vector field associated with a time-dependent Hamiltonian follows the same construction rules as a normal Hamiltonian using the isomorphism given by \(\fromDual{\omega}\), but `frozen' at each instant of \(t\). The Hamiltonian vector field on \(\ctbundle{Q}\) is
\begin{equation}
     X_{\Hck} = -\ec^{\gamma t}kq\pdv{}{\Pcan} + \ec^{-\gamma t}\frac{\Pcan}{m}\pdv{}{q}.
\end{equation}

The suspension of this vector field on \(\ctbundle{Q}\times \real\) is
\begin{equation}
     \tilde{X}_{\Hck} = -\ec^{\gamma t}kq\pdv{}{\Pcan} + \ec^{-\gamma t}\frac{\Pcan}{m}\pdv{}{q} + \pdv{}{t}.
\end{equation}
The suspension is important because it allows us to perform the time-dependent transformation from the canonical momentum \(\rho\) to the kinematic momentum \(p\):
\(\phi: (q, \Pcan, t) \mapsto (q, \ec^{\gamma t}p, t).\)
The transformed vector field in terms of the physical coordinates \(p, q, t\) is
\begin{equation}
     \phi_*(\tilde{X}_{\Hck}) = \qty(-kq - \gamma p)\pdv{}{p} + \frac{p}{m}\pdv{}{q} + \pdv{}{t}.
\end{equation}
The extra term in \(p\) arises as a consequence of the fact that the mapping from \(\rho\) to \(p\) depends also on \(t\). 

The similarity between the derivation of the equations of motion --- in particular, the crucial role of the product rule --- and the one given by \cref{eq:pdot} is striking. Indeed, if we substitute into the Caldirola-Kanai Hamiltonian \(-\rho_e = \ec^{\gamma t}\), we obtain
\begin{equation}
     \Hck = -\frac{\rho^2}{2m\rho_e} - \rho_e \frac{1}{2}kq^2 = -\rho_e \qty (\frac{1}{2m}\qty(\frac{\rho}{\rho_e})^2 + \frac{1}{2}kq^2),
\end{equation}
which is precisely equal to the homogeneous Hamiltonian given in \cref{eq:H_dho_homo} excluding the term in \(q_e\). The dependence on \(q_e\) is not required, since it is replaced by an explicit dependence on time that would otherwise generate the exponential factor \(\ec^{\gamma t}\). 

Many interpretations have already been given for the particular form of \(\Hck\); for example through time-dependent canonical transformations, or by a rescaling of time itself (see i.a. \citet{Tokieda2021}, \citet{Caldirola1941} and \citet{Bravetti2017}). Here we can see that the Caldirola-Kanai can be regarded as  directly equivalent to the homogeneous Hamiltonian system, where the dynamics of the additional coordinates \(\rho_e\) and \(q_e\) are replaced by their explicit solution in time. Additionally, the role of the `mysterious' canonical momentum \(\rho\) is explained as being a coordinate of the symplectified space, or homogeneous coordinate for the underlying contact space\footnote{This has caused considerable confusion in literature, as stated by \citet{Schuch1997}.}.

\subsection{The harmonic oscillator with serial damping}
\label{ssec:serial_damping}
In this section, we extend the method outlined in \cref{ssec:contact_dissipation} to a harmonic oscillator with two dampers: one in series and one in parallel. This system will play an important role in \cref{chap:quaternion}.
\begin{figure}[ht!]
    \centering
    \input{media/tikz/double_damped_oscillator}
    \caption{Schematic of the harmonic oscillator with two dampers: one in series and one in parallel. The corresponding bond graph representation is shown on the right.}
    \label{fig:double_damped_osc}
\end{figure}

\subsubsection{System dynamics}
The harmonic oscillator with two dampers is shown in \cref{fig:double_damped_osc}, together with the corresponding bond graph representation. Comparing this to \cref{fig:dho}, there is another 0-junction present in the system that compares flows (velocities) rather than efforts (forces). The equations of motion can be readily derived:
\begin{equation}
    \begin{split}
        m\ddot{q}_1 &= -kq - b_p \dot{q}_1 \\
        kq &= b_s(\dot{q}_1 - \dot{q}) \\
    \end{split}
    \label{eq:serial_eom_raw}
\end{equation}
Due to the presence of the serial damper, the situation is somewhat curious, since there are two positions in the system; one measuring the spring deflection \(q\) and the position of the mass \(q_1\). The subscript `1' refers to the fact that \(q_1\) is the position measured at the 1-junction in the bond graph shown in \cref{fig:dho}. However, the node connecting the serial damper and the spring has no mass, and therefore no second-order dynamics: as such, the overall order of the system is two. 

In accordance with the economic analogy, we will say that position is stored in the spring, but momentum is stored in a mass.
Hence, we let \(p = m\dot{q}_1\) --- but \(\dot{q} \neq p/m\) in general. That is to say, the spring is naturally associated with a position coordinate, while the mass has momentum, though its position does not partake in the dynamics directly.

Using the damping coefficients defined in \cref{tab:ddho_params}, the equations of motion become:
\begin{equation}
    \begin{split}
        \dot{q} &= -\gamma_s q + p/m  \\
        \dot{p} &= -\gamma_p p - kq.
    \end{split}
    \label{eq:serial_eom_pq}
\end{equation}

%In addition to \(q_1\) being the position measured at the 1-juncton, we can also measure the momentum at the 0-junction, this momentum is \(p_0 \coloneq m\dot{q}\). Again, the subscript `0` refers to the fact that is momentum is based on the 0-junction, along the same line as the position coordinate \(q_1\). Hence, we have four coordinates, two of which  (\(p\) and \(q\)), are natural because they are measured at the component of the where they are effectively stored. In addition there are \(p_0\) and \(q_1\), which are somewhat artificial definitions.
\begin{table}[ht!]
    \caption{Substitution parameters for the harmonic oscillator with serial and parallel damping, shown in \cref{fig:double_damped_osc}.}
    \label{tab:ddho_params}
    \centering
    \begin{tabular}{llll}
        \toprule
        \textbf{Name} & \textbf{Symbol} & \textbf{Value} & \textbf{Units} \\
        \midrule
            Serial damping coefficient & \(\gamma_s\) & \(k/b_s\) & \si{\per \second} \\
            Parallel damping coefficient & \(\gamma_p\) & \(b_p/m\) & \si{\per \second} \\
            Natural frequency & \(\Omega_n\) & \(\sqrt{k/m}\) & \si{\per \second} \\
            Damped frequency & \(\Omega_d\) &  & \si{\per \second} \\
        \bottomrule
    \end{tabular}
\end{table}

\subsubsection{Contact Hamiltonian system} 
In order to establish the contact structure for the harmonic oscillator with two dampers, we must find the expression for the work done by the system on the dampers. We will do so using the structure of the bond graph shown in \cref{fig:double_damped_osc}. 

Bonds carry two signals: an effort and a flow. Both can be assigned a `direction'; they are always opposite. The direction indicates whether either the effort or flow should be regarded as the `input' of the model. For example, \emph{traditionally} (though this is a matter of convention), an I-element takes efforts as an input, and returns a flow. That is to say, one applies a force to a mass, with a change in velocity as a result. Conversely, when a spring is stretched along a certain distance to return a force proportional to it; it takes a flow and returns an effort \cite{Borutzky2010}. In a bond graph, this is indicated by a causality stroke, which is placed at the side of the bond that determines the flow.

If a causality convention is chosen, all the I- and C-elements in the bond graph should conform to this convention\footnote{Not doing so leads to a differential algebraic system (DAE).}. This is \emph{not} the case for R-elements; they are \emph{indifferent to causality}. The reason for this is that there is no integral/derivative present in the mathematical description of their dynamic behavior: they relate an effort and flow, which are both time derivatives. So, depending on the system architecture, a particular R-element may receive an effort and return a flow, or vice versa \cite{Borutzky2010}.

This can be observed from \cref{fig:double_damped_osc}: the serial damper (on the 0-junction) receives an effort and returns a flow, while the parallel damper receives a flow and returns an effort (1-junction). This distinction is reflected in the work form associated with the damper. For the parallel damper, we have
\begin{equation}
     \beta_p = \underbrace{\gamma_p p}_\text{\textsc{effort}} \times \underbrace{\dd{q}.}_\text{\textsc{flow}}
\end{equation}
The variable that is `varied' externally is the flow, hence \(\dd{q}\) 

For the serial damper, we have the opposite situation. Here, the effort is varied externally, which is equal to \(-\dd{p}\). The minus sign is a consequence of the power direction in the bond connecting the 1-junction and 0-junction\footnote{Intuitively, it is clear from \cref{fig:double_damped_osc} that the force acting \emph{on} the damper is proportional to the \emph{decrease} in momentum. Also, in \cref{eq:serial_eom_pq} we can observe that the damping force is negatively proportional to \(\dot{q}_1\), which is itself positively proportional to the momentum of the mass.}. The flow is equal to \(\dot{q}_1 - \dot{q} = kq/b_s = \gamma_s q\) (using \cref{eq:serial_eom_raw}). Hence, we have
\begin{equation}
     \beta_s = \underbrace{\gamma_s q}_\text{\textsc{flow}} \times \underbrace{-\dd{p}.}_\text{\textsc{effort}}
\end{equation}

Combining these work forms, we find the contact form for the system with two dampers:
\begin{equation}
    \alpha = \dd{U} - \gamma_p p\dd{q} + \gamma_s q \dd{p}.
    \label{eq:serial_dho_contact_form}
\end{equation}
The exterior derivative of the contact form \(\alpha\) is then equal to
\begin{equation}
     \dd{\alpha} = (\gamma_s + \gamma_p) \wedgep{\dd{q}}{\dd{p}},
\end{equation}
and the Reeb vector field is simply
\begin{equation}
     R_\alpha = \pdv{}{U}.
\end{equation}

Now to find the Hamiltonian and the system dynamics. In the following, we will only consider the horizontal component of the Hamiltonian vector field, for the various reasons pointed out in \cref{ssec:contact_dissipation,ssec:symplectification}. The horizontal component is given by (cf. \cref{eq:horizontal_vf}):
\begin{equation}
    \begin{split}
        X^\text{hor}_K &= \fromDual{\dd{\alpha}}\qty(\dd{K} - (\intpr{R_\alpha}{\dd{K}})\alpha) \\
                       &= \fromDual{\dd{\alpha}}\qty(\qty(\pdv{K}{q} + \gamma_p p \pdv{K}{U})\dd{q} + \qty(\pdv{K}{p} - \gamma_s q \pdv{K}{U})\dd{p}).
    \end{split}
\end{equation}

The mapping \(\fromDual{\dd{\alpha}}\) acts on the basis 1-forms as follows:
\begin{equation}
     \fromDual{\dd{\alpha}}(\dd{p}) = \frac{1}{\gamma_s + \gamma_p}\qty(\pdv{}{q} + \gamma_p p\pdv{}{U}) \qquad
    \fromDual{\dd{\alpha}}(\dd{q}) = \frac{1}{\gamma_s + \gamma_p}\qty(-\pdv{}{p} + \gamma_s q\pdv{}{U}).
\end{equation}
The extra terms in \(\pdv{}{U}\) appear again to ensure that the vector field is horizontal.

Using the same reasoning applied in \cref{ssec:contact_dissipation}, we can observe that the contact Hamiltonian must be proportional to the sum of the mechanical and internal energy of the system. In addition, we wish to cancel the factor \((\gamma_s + \gamma_p)\) present in the mapping \(\fromDual{\dd{\alpha}}\) by multiplying the contact Hamiltonian with the same factor. Hence we, have
\begin{equation}
     K = (\gamma_s + \gamma_p)\qty(\frac{p^2}{2m} + \frac{1}{2}kq^2 + U).
\end{equation}

Assuming again that \(K = 0\), the contact Hamiltonian vector field is then:
\begin{equation}
     X_K = X_K^\text{hor} = \qty(\frac{p}{m} - \gamma_s q)\pdv{}{q} + \qty(-kq -\gamma_p p)\pdv{}{p} + \qty(\gamma_p\frac{p^2}{m} + \gamma_s kq^2 )\pdv{}{U},
\end{equation}
since the cross terms in \(\pdv{}{U}\) cancel out. Next to the familiar dissipated power for the parallel damper, we also have the dissipated power of the serial damper
\begin{equation}
     \gamma_s kq^2 = \underbrace{\gamma_s q}_\text{\textsc{flow}} \: \times \underbrace{kq}_\text{\textsc{effort}},
\end{equation} 
in the dynamics of \(U\). Hence, this vector field yields the correct dynamics for \(p\) and \(q\) as given by \cref{eq:serial_eom_pq}, in addition to the internal energy \(U\).

%<symbol: \gamma> <expl: Damping coefficient> <tags: greek, mech, geometry>

