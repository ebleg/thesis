\chapter{Symplectified Contact Mechanics for Dissipative Systems}

The traditional view is that the methods of analytical mechanics, such as the Lagrangian and Hamiltonian formalisms, are
only suited for conservative systems. However, several attempts, especially in the previous century, have been made to
extend these principles to dissipative systems as well. 

\section{The damped harmonic oscillator}
This chapter (and the application in the following chapter) is
primarily concerned with the prototypical dissipative mechanical system: the linearly damped harmonic oscillator
depicted in \cref{fig:dho}, with the governing second-order differential equation being
\begin{equation}  
  m\ddot{x} + b\dot{x} + kx= 0.
\end{equation}
The choice for this system is rather perspicuous, since it is arguably the `easiest` dissipative system that also
exhibits second-order dynamics and is linear in all terms. Furthermore, as discussed below, it serves as the test case
of the overwhelming majority of research into dissipative Lagrangian and Hamiltonian mechanics
\cite{Dekker1981,Hutters2020b}. However, the method described in this section can be generalized directly to a general
(possibly time-dependent) potential function $V = V(x, t)$.
\begin{figure}
    \begin{center}
        \input{media/tikz/damper_oscillator}
    \end{center}
    \caption{Schematic of the mass-spring-damper system.}
    \label{fig:dho}
\end{figure}

%The first attempt is arguably made in the work of \citet{Bateman1931} in 1931, who used a `mirror` system in
%combination with the real system that runs with an opposite time direction --- as such, the irreversible dynamics are
%compensated by the mirror system, which ensures that the overal system can be cast in the necessarily even-dimensional
%(the Bateman approach automatically doubles the number of dimensions in the system) symplectic setting that underpins
%the Hamiltonian formalism\footnote{Strictly speaking, Bateman only covered the Lagrangian part of the story in his
%paper}.

\section{Historical perspectives}
A traditional, engineering-inclined method to incorporate damping in the framework is to include a Rayleigh damping term
in the Lagrangian to emulate linear damping forces, and this works `mathematically` to derive the correct equations of
motion \cite{Goldstein2011}. Although frequently used for practical problems, this damping term is not really part of
the \emph{actual} Lagrangian --- rather, it simply makes use of the notion of a generalized force that is not inherently
part of the system. As such, this method only `works' on a superficial level: the pristine differential geometric
foundations of mechanics do not leave room for such ad hoc tricks. There is, as a result, also no Hamiltonian
counterpart for this method. 

The historical attempts to do better than the Rayleigh method were primarily motivated by the application of the
(dissipative) Hamiltonian formalism in quantum mechanics through discretization. For this application, a sound
mathematical structure is of the essence, which calls for a more rigorous approach. A celebrated paper by
\citet{Dekker1981} provides an excellent summary of many attempts up to 1981. Indeed, the well-studied approach
developed by \citet{Caldirola1941} and \citet{Kanai1948} was intended exactly for this purpose. This method features an
explicit time-dependence both in the Lagrangian function
\begin{equation}
    \Lck(x, \dot{x}, t) = \ec^{\gamma t}\qty(\frac{1}{2}m\dot{x}^2 - \frac{1}{2}kx^2),
    \label{eq:lag_CK}
\end{equation}
and the corresponding Hamiltonian function:
\begin{equation}
    \Hck(x, \mathfrak{p}, t) = \frac{\mathfrak{p}^2}{2m}\ec^{-\gamma t} + \frac{1}{2}kx^2\ec^{\gamma t}.
    \label{eq:ham_CK}
\end{equation}
In the Hamiltonian equation, $\mathfrak{p}$ refers\footnote{Not to be confused with the conventional notation for (Lie)
algebras.} to a special `canonical momentum' (which is to be made clear later), defined by $\mathfrak{p} = p\ec^{\gamma
t} = m\dot{x}\ec^{\gamma t}$. From either \cref{eq:lag_CK} or \cref{eq:ham_CK}, the equations of motion are readily
derived (for the Hamiltonian case with respect to $\mathfrak{p}$ after which the transformation to $p$ can be effected).
Indeed, after taking the appropriate derivatives, one obtains:
\begin{equation*} 
    \begin{split}
        \dv{}{t}\qty(\pdv{\Lck}{\dot{x}}) - \pdv{\Lck}{x} &= 0 \\
        \Rightarrow \ec^{\gamma t}\qty(m\ddot{x} + m\gamma\dot{x} + kx) &= 0
    \end{split}
\end{equation*}
for the Lagrangian case. Hamilton's equations amount to: \cite{Tokieda2021}
\begin{equation*}
    \begin{split}
        \dot{x} &= \pdv{\Hck}{\mathfrak{p}} = \frac{\mathfrak{p}}{m}\ec^{-\gamma t} =  \frac{p}{m}, \\
        \dot{\mathfrak{p}} &= -\pdv{\Hck}{x} = -kx\ec^{\gamma t}.\\
    \end{split}
\end{equation*}
The relation between the time derivatives of the momenta $\dot{p}$ and $\dot{\mathfrak{p}}$ is slightly more
involved since one must invoke the product rule as a result of their time-dependencent relation:
    $$ \dot{\mathfrak{p}} = \ec^{\gamma t}\qty(\dot{p} + \gamma p). $$
Substition yields the correct equation for $p$, though the equation is again multiplied by $\ec^{\gamma t}$. Because the
latter is very well-behaved (that is, it has no zeros), it can be divided without any problems.

\paragraph{Geometric perspective}
The derivation stated above corresponds to the \emph{suspension} of the time-dependent Hamiltonian vector field: 
\footnote{A \emph{time-dependent vector field} on a manifold $M$ is a mapping $X: N\times\real \to \tbundle{M}$ such that for each $t \in \real$, the
restriction $X_t$ of $X$ to $N \times \{t\}$ is a vector field on $M$. \cite{Libermann1987} An additional construction
of importance, called the \emph{suspension} of the vector field, (...)}
    $$ X_{\Hck} = -kx\ec^{\gamma t}\pdv{}{\mathfrak{p}} + \frac{\mathfrak{p}}{m}\ec^{-\gamma t}\pdv{}{x} + \pdv{}{t}$$
dictated by the symplectic 2-form (in terms of the canonical momentum)
    $$ \vec{\omega} = \wedgep{\dd{x}}{\dd{\mathfrak{p}}}, $$
such that $\intpr{X_{\Hck}\vert_t}{\vec{\omega}} = \dd(H_CK)$ !!! not yet correct

Suspension includes the $\pdv{}{t}$ coordinate in the vector field, see Foundations p. 373

Some peculiarities of the Caldirola-Kanai method deserve to be pointed out, since they will play a vital role in what 
is to come in the remainder of this chapter. [...]

\subsection{Contact manifolds}

!!!
Our Lagrangian \emph{is} CK-Lagrangian, but
derivative wrt $\dot{q}$ => obtain correct momentum for Hamiltonian formulation.
In Hamiltonian formulation, choose $p_0$ and $q_0$ accordingly

`Contact' Hamiltonian (naive, from CK -> not complete!)
$$ \hat{H} = \frac{p^2}{2m} + V(q) $$
Look at CK, call $p_0 = \ec^{\gamma t}$ and $p = p_1/p_0$ (for now explicit definition). Symplectify, i.e. 
$$ H = p_0 (\frac{1}{2m}\qty(\frac{p_1}{p_0})^2 + V(q)) $$
such that indeed, 
$$ H(p_0, p_1, q)= p_0 \hat{H}(p, q) = p_0 \hat{H}\qty(p_1/p_0, q) $$
and we can use the contact relations given. Clearly, they are equivalent to the CK-method.
HOWEVER:

observe that, $q_0 = \int L \dd{t}$, and that $\pdv{\hat{H}}{q_0} = \frac{\dot{p_0}}{p_0}$.
Hence, the contact Hamiltonian can be modified to incorporate this, and presto, there is Bravetti's Hamiltonian. Hence,
these methods are precisely equivalent through symplectization.
TODO: Lagrangian counterpart, recover from our method what is three to save




%\begin{itemize}
%    \item The \textbf{mirror system} or \textbf{Bateman} approach, doubles the number of system dimensions by including a mirror system that runs opposite in time. Arguably the most flexible of all methods, it is 
%    \item Expressing the Hamiltonian in \textbf{complex coordinates} has also produced promising results: notable are the attempts of \citet{Bopp1974}, \citet{Dedene1980} and the very recent contribution by \citet{Hutters2020b} in the research group to which the author belongs as well.
%    \item A different approach, related to the contact method, are the 
%    \item Contact mechanics
%    \item Mathematical Hamiltonians
%\end{itemize}
%
%[Mention Max as contributor]
