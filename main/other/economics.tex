\chapter{A Geometric Perspective of Economic Engineering}
\label{chap:symplectic_economics}

The discipline of `economic engineering' is a very new one. The theoretical foundations have been developed over the past years at the Delft Center of Systems and Control primarily by prof. em. Mendel, combined with the contributions of several theses that have been recently written about the subject. The purpose of economic engineering is to use tools from various engineering disciplines and physics to improve the predictive power of (macro)economic models.

\section{Symplectic manifolds in economic engineering}
The basic elements of an economy are a collection of goods. These can be physical goods (e.g. bushels of wheat) but also more abstract goods such as capital in the financial analogy \cite{Kruimer2021}. The \emph{economic configuration space} $Q$ is analogous to the configuration space of mechanics, and consists of all the possible combinations of goods in the economy. This may simply be a `flat' space, i.e. a vector space of all the goods, but can also be subject to certain (holonomic) constraints. Hence, in economic engineering, the goods are analogous to the \emph{(generalized) positions} in classical mechanics \cite{Mendel2019}. 

The natural coordinates for this space are the number of each of the goods in the space, denoted by $\vec{q} = (q^1, q^2, \ldots, q^n)$. We say that each of these coordinates is measured in units of `quantity', denoted by `$\qty[\si{\quantity}]$'. In many cases, the economic configuration manifold is simply a vector space containing all the goods, subject to a total constraint on the total \emph{endowment} for each of the goods (i.e. the total number of goods available). In the two-dimensional case, this is also referred to as the \emph{Edgeworth box}.

The tangent space $\tspace{x}{Q}$ to a point $x$ in $Q$ is the vector space of differential changes in goods, also called the \emph{flow} of goods. A vector in the tangent space is denoted by $\vec{\dot{q}} = (\dot{q}^1, \dot{q}^2, \ldots, \dot{q}^n)$. It is very important to make the distinction between a flow of goods and an absolute amount of goods: from a mathematical perspective, the former is a vector in the tangent space, and the latter is a point in the economic configuration manifold. This distinction is often not given much attention in economics, but it is fundamental in economic engineering.

The \emph{dual space} of $\tspace{x}{Q}$ is the cotangent space $\ctspace{x}{Q}$ containing all the linear functions on vectors in the tangent space to produce a number. This is the natural setting of the \emph{prices} in the economy: as a function, they assign a \emph{value to a change in goods}. These prices are measured in units of currency per quantity, i.e. $\qty[\si{\money \per \quantity}]$. A covector in the cotangent space is be denoted by $\vec{p} = (p_1, p_2, \ldots, p_n)$. The action of a price covector on a vector measuring change in goods is: (using the index summation convention)
\begin{equation}
    \vec{p}(\vec{\dot{q}}) = p_i \dot{q}^i,
\end{equation}
i.e. it produces the total value associated to this change in goods.

The \emph{cotangent bundle} $\ctbundle{Q}$ associated to the economic configuration manifold is the space of prices and quantities: we call it the \emph{economic phase space}. Just like in mechanics, a point in this space determines the state of the economic system: it gives the level of all the goods and their price point.

The cotangent bundle of any manifold has a 1-form canonically defined on it: the Liouville form (also called tautological 1-form or canonical 1-form), defined as
\begin{equation} 
    \theta \coloneq  p_i \dd{q}^i.
\end{equation}
Even more so than in mechanics, this Liouville 1-form has a very intuitive interpretation in economic engineering: it relates the goods and their prices. When integrated over a curve in $\ctbundle{Q}$, it measures the total accumulation of value along that curve.

The (negative of) the exterior derivative of the Liouville form is a \emph{symplectic 2-form} $\omega$:
\begin{equation}
    \omega \coloneq -\dd{\theta} = \wedgep{\dd{q}^i}{\dd{p}_i}.
\end{equation}
When integrated over, this form measures the \emph{oriented area} in the economic phase space, with units of currency $[\si{\money}]$. The symplectic 2-form relates every price to the associated quantity and thereby represents the fundamental structure of the economic phase space.  

The link between symplectic geometry and economics has been recognized by (more mathematically inclined) researchers outside the field of economic engineering as well, most notably \citet{Russell2011} and \citet{Swierstra2014}.

The role of symplectic geometry in economics begs the question whether the concepts of Hamiltonian mechanics can be applied to economic dynamical systems as well. In the field of economic engineering, we argue that this is indeed the case. To explain how this works, we start from Lagrangian mechanics, which --- arguably --- have a slightly more intuitive interpretation, after which we make the transition to Hamiltonian mechanics.

\section{Lagrangian mechanics in economic engineering}
The \emph{Lagrangian} is a function on the tangent bundle of the configuration manifold:
$$ L : \tbundle{Q} \to \real. $$
Lagrangian mechanics is based on \emph{Hamilton's principle} which states that the physical motion $\gamma: \interval{t_0}{t_1} \to \tbundle{M}$ is the one for which the action functional
\begin{equation}
    \mathscr{A}[\gamma] = \int_{t_0}^{t_1} (L\circ\gamma)\dd{t},
\end{equation}
is stationary\footnote{Although often referred to as the `Principle of \emph{minimum} action', this is inaccurate: Hamilton's principle only asserts that the first variation of the functional vanishes, which does not necessarily imply a minimum.} A necessary and sufficient condition for a curve to satisfy Hamilton's equations is given by the set of $n$ \emph{Euler-Lagrange equations}:
\begin{equation}
    \dv{}{t}\qty(\pdv{L}{\dot{q}^i}) - \pdv{L}{q^i} = 0.
\end{equation}

In economic engineering, Hamilton's principal is interpreted as an economic agent minimizing her \emph{disutility}, in practice often taken to be the \emph{cost}. The interpretation of the Lagrangian function is then the \emph{running cost} or \emph{running disutility}. This Lagrangian therefore has units of currency per time, e.g. $\qty[\si{\money \per \year}]$.

As mentioned, the Lagrangian is a function of the flow of goods $\dot{\vec{q}}$ and the stock levels $q^i$. The partial derivative of the Lagrangian with respect to the flow of goods --- is equal to the \emph{price vector}:
\begin{equation}
    p_i \coloneq \pdv{L}{\dot{q}^i}. 
\end{equation}
This means that prices and flows of goods are \emph{conjugate variables}. 

\paragraph{Kinetic energy} When the Lagrangian depends quadratically on the flow of goods (analogous to kinetic energy), the price and the flow of goods are linearly related: this is the typical picture of a supply and demand curve. We have:
$$ p_i = m_{ij} \dot{q}^j, $$
where the $m_{ij}$ are referred to as \emph{price elasticities}. In the simplest of cases, the $m_{ij}$ form a diagonal matrix and every good simply has its own price. When cross terms appear however, they refer as the marginal elasticity of one good relative to another. These cross-terms encodes the effect \emph{substitution} of one good with respect to another. 

In mechanics, the part of the Lagrangian that depends on $\dot{\vec{q}}$ is called the \emph{kinetic co-energy}\footnote{We make the distinction between the kinetic energy $T$ and co-energy $T^*$: they dual are representations related through the Legendre transform. Because work is the integral of force over distance, kinetic energy is naturally represented in terms of \emph{momentum}, rather than velocity, for which we need to take the Legendre transform \cite{Jeltsema2009}.} $T^*$:
\begin{equation}
    T^* = \frac{1}{2}m_{ij}\dot{q}^i \dot{q}^j.
\end{equation} 
The kinetic co-energy is equivalent to the \emph{cost} associated with a flow of goods: the factor of one half is there to subtract the market surplus from the total expenditure (which is simply equal to $\vec{p}(\dot{\vec{q}})$).

\begin{figure}
    \centering
    \input{media/tikz/kinetic_energy}
    \caption{Kinetic energy and co-energy in terms of the relation between momentum and velocity. Figure courtesy of B. \citet{Krabbenborg2021}.}
    \label{fig:kinetic_energy}
\end{figure}

Traditionally, microeconomics makes the distinction between \emph{firm theory} and \emph{consumer theory}. In economic engineering, we dispense with this explicit distinction, for we argue that they are fundamentally based on the same mathematical principles. However, it is important to keep in mind that the situation for firms and consumers is typically `mirrored': the cost of one represents the surplus of the other, and vice versa. Also, a flow of goods that a consumer buys from a firm has an opposite direction depending on the perspective of the firm or the consumer: this is the reason why a demand curve typically slopes downwards and the supply curve upwards, because their associated surplus is `flipped'. In the grand scheme of things, both perspectives are two sides of the same coin. The `minimization principle' can therefore just as well be considered to be a `maximization principle' if the signs flip due to a change in perspective.

If the matrix of elasticities (analogous to the mass matrix in economics) is positive definite, it serves as a \emph{Riemannian metric} on the economic configuration manifold. Level lines of the Lagrangian function in function of $\dot{\vec{q}}$ are \emph{indifference curves}: they represent constant level of (dis)utility for different combinations of flows of goods. Furthermore, in more complicated situations, the price elasticities are allowed to vary with the stock levels, i.e. $ m = m(q^1, q^2, \ldots, q^n)$, which would (under appropriate conditions) imply that the  configuration manifold is \emph{curved} in the Riemannian sense.

In the language of bond graphs, we say that the kinetic energy (or market surplus) is stored in an I-element. As such, in economic engineering, I-elements represent a local `piece' of demand.

\paragraph{Potential energy} In mechanics, the part of the Lagrangian that does not depend on $\dot{\vec{q}}$ is called the \emph{potential energy} $V = V(q^1, q^2, \ldots, q^n)$. In economic engineering, we say that potential energy either represents the \emph{benefits} of holding a good, also called \emph{convenience yield}. From the perspective of the firm, the benefits of holding are typically opposite (e.g. storage costs). When the potential energy is quadratic in the $q^i$'s, we have something like a spring force acting on the system. In a bond graph, this is called a C-element: it measures or stores\footnote{With `measuring' we mean that this element makes a particular quantity part of the dynamics of the system, which is to say that they are measurable. For example, if there are no C-elements, one can still conceptualize the `amount of goods', but they do not influence the system and can therefore not be measured.}.

\paragraph{Symplectic geometry in Lagrangian mechanics} 
We will now give a brief description of the differential geometric infrastructure underpinning Lagrangian mechanics and its economic interpretation. For a more detailed account of the geometry of Lagrangian mechanics, the reader is referred to \cref{app:symplectic_geometry}. 

The geometry of Lagrangian mechanics is based on the geometry of the so-called \emph{double tangent bundle} $\tbundle{\tbundle{Q}}$. This is because we consider the amount of goods $q^i$ and the flow of goods $\dot{q}^i$ to be separate coordinates, but of course the flow of goods $\dot{q}^i$ \emph{also} is the time rate of change of the associated amount of goods\footnote{In this context, the `dot' simply distinguishes the coordinates, but does not intrinsically imply that one is the time derivative of the other.}. This extra constraint pairing the $q^i$'s with their associated $\dot{q}^i$ is embedded in the canonical structure of the double tangent bundle. Said otherwise, the significance of this structure is equivalent to Newton's law being second-order.

The pairing of flows and amounts of goods is specified by the \emph{vertical isomorphism}, which is a tensor of valence $(1,1)$ on $\tbundle{Q}$: \cite{Carinena1990}
$$ S = \pdv{}{\dot{q}^i}\otimes \dd{q^i}. $$
Using the vertical isomorphism, the \emph{Lagrange 1-form} is defined as
\begin{equation}
    \theta_L \coloneq \dd{L}\circ S = \pdv{L}{\dot{q}^i}\dd{q^i}.
\end{equation}
The Lagrange 1-form plays an equivalent role to the Liouville form in the previous section. Recall that $\pdv{L}{\dot{q}^i}$ are equal to the prices, so $\theta_L$ computes the `valuation' of a flow of goods based on the price levels dictated by the Lagrangian. 

Similarly, the negative of the exterior derivative of $\theta_L$ yields the \emph{Lagrange 2-form} $\omega_L$:
\begin{equation}
    \omega_L \coloneq -\dd{\theta_L} = \pdv[2]{L}{v^i}{v^j}\wedgep{\dd{q^j}}{\dd{v^i}} + \pdv[2]{L}{q^i}{v^j}\wedgep{\dd{q^j}}{\dd{q^i}}.
\end{equation}
This 2-form has a compelling economic interpretation: the first term is equal to the \emph{price elasticities} associated to each of the goods in the economy. The second term contains the dependency of the price elasticities on the amounts of goods.

The Lagrange 2-form is a \emph{symplectic form} \emph{if} the matrix of price elasticities is regular: in economics this means that there are no `zero price directions'; i.e. there every change in the amounts of goods is associated with some change in value. Usually, an even stronger condition is assumed on $L$, namely that it is \emph{convex} in the flows of products, which is sometimes known as the \emph{Legendre condition}. In economics, this means that the prices are in the same `direciton' as the goods\footnote{This makes intuitive sense, although there are exceptions, for example, the negative yield on some government bonds in recent years.}. If this is indeed the case, the Legendre transform can be used to pass from the Lagrangian representation to the Hamiltonian representation and back, this is the subject of the next section. 

\section{Hamiltonian mechanics in economic engineering}


%<symbol: p> <expl: Price> <tags: letter,econ>
%<symbol: q> <expl: Quantity; amount of goods> <tags: letter,econ>
%<symbol: \dot{q}> <expl: Quantity demanded; quantity supplied; flow of goods> <tags: letter,econ>

