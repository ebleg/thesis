\chapter{Split-Quaternions as Dynamical Systems}
\label{chap:quaternion}
%\lsymb{$\vec{\alpha}$}{A differential form}

In this chapter, the geometric connection is made between the algebra of split-quaternions and the qualitative behavior of two-dimensional linear dynamical systems. 

\section{Split-quaternion algebra}
\subsection{Basic properties}
Like the conventional quaternions, the split-quaternions are a number system that consists of linear combinations of four basis elements, which will be denoted by \quati, \quatj and \quatk. The algebra of split-quaternions is associative but not commutative --- formally speaking, the algebraic structure is a \emph{noncommutative ring}. The multiplication table for the split-quaternion algebra is shown in \cref{tab:quat_table}. The set of split-quaternions is denoted by \spquaternions (since \quaternions is reserved for conventional quaternions).
\begin{table}[ht!]
    \centering
    \caption{Multiplication table for the split-quaternion algebra.}
    \label{tab:quat_table}
    \begin{tabular}{c|cccc}
        \toprule
        &         1      & \quati  & \quatj  & \quatk \\ 
        \midrule
        1       & 1      & \quati  & \quatj  & \quatk \\ 
        \quati  & \quati & -1      & \quatk  & -\quatj \\ 
        \quatj  & \quatj & -\quatk & 1       & -\quati \\ 
        \quatk  & \quatk & \quatj  & \quati  & 1 \\ 
        \bottomrule
    \end{tabular}
\end{table}

The important distinction from conventional quaternions resides in the diagonal elements of \cref{tab:quat_table}. Whereas for quaternions all the nonreal basis elements square to $-1$, this is not the case for the split-quaternions (only \quati does). This is precisely the reason why split-quaternions are `split', for this difference in sign gives rise to an indefinite quadratic form when computing the norm of the split-quadratic form. Because the quadratic form is indefinite, it classifies the set of split-quaternions into several subsets, which is to be discussed later.

\paragraph{Dihedral group} he basis elements of the split-quaternions form a group under multiplication, namely the \emph{dihedral group} \digroup{4}, which represents all the symmetries of a square: the identity, a 90-degree rotation and two reflections (cf. \cref{fig:square_symmetry}).
\begin{figure}[h!]
    \begin{center}
        \input{media/tikz/square_symmetry}
    \end{center}
    \caption{The dihedral group \digroup{4} is the symmetry group of a square. This group is isomorphic to the group formed by $1, \quati, \quatj$ and \quatk under multiplication.}
    \label{fig:square_symmetry}
\end{figure}

The structure of the dihedral group can be visualized by its \emph{cycle graph} in \cref{fig:cycle_graph}. Many important properties of the split-quaternion algebra and the applications in this chapter can be traced back to the topology of this cycle graph. One example is the split nature of the quaternions: the \quati-element generates an order four cycle, while \quatj and \quatk generate order two cycles (in contrast, the cycle graph for conventional quaternions is entirely symmetric for all these elements).
\begin{figure}[h!]
    \begin{center}
        \input{media/tikz/dihedral_group}
    \end{center}
    \caption{Cycle graph of the dihedral group. There are five cycles: one of order four which represents the rotations (or the element \quati), and four order 2 cycles, which are all the possible reflections. The colored element represents the identity.}
    \label{fig:cycle_graph}
\end{figure}

\paragraph{Split-quaternion norm} Complex numbers have a real and imaginary part. Likewise, (split)-quaternions have a similar notion: a \emph{scalar} (or real) and \emph{vector} (or imaginary) components. For an arbitrary split-quaternion $q \in \spquaternions$, \cite{Jafari2014}
$$ h = \quat{h_0}{h_1}{h_2}{h_3} $$
the real part is $\scapart{h} = h_0$ and the vector part is $ \vecpart{h} = \quatvec{h_1}{h_2}{h_3}$. For convenience, the vector part will be referred to in traditional bold vector notation:
$$ \vec{h} = \vecpart{h} = \quatvec{h_1}{h_2}{h_3}. $$

Furthermore, for every split-quaternion there is a unique \emph{conjugate}
$$ \conj{h} = \scapart{h} - \vecpart{h} = h_0 -h_1\quati -h_2\quatj -h_3\quatk, $$
through which the \emph{split-quaternion norm} is defined:
\begin{equation}
    \mathscr{N}(q) = h\conj{h} = h_0^2 + h_1^2 - h_2^2 - h_3^2. 
    \label{eq:quat_norm}
\end{equation}
As mentioned, this norm is not positive definite, in stark contrast to quaternions or complex numbers. Split-quaternions can be categorized into three classes based on their norm being negative, zero or positive. In the tradition of special relativity, these classes are named \emph{spacelike}, \emph{lightlike} and \emph{timelike} respectively: \cite{Misner1970,Landau1971}
\begin{itemize}
    \item \textbf{Timelike}: $ \mathscr{N}(h) > 0 $, with real length $ \norm{h} = \sqrt{h \conj{h}}$. 
    \item \textbf{Lightlike}: $ \mathscr{N}(h) = 0 $, with zero length $\norm{h} = 0$. 
    \item \textbf{Spacelike}: $ \mathscr{N}(h) < 0 $, with imaginary length $\norm{h} = \ii \sqrt{\abs{h\conj{h}}}$.
\end{itemize}
Even though they behave similarly, the imaginary unit $\ii$ is not to be confused with the split-quaternion basis element \quati, because they belong to different number systems.

\paragraph{Vector norm}
Apart from the split-quaternion norm, we can also define a norm that only considers the vector part of the split-quaternion. This norm is defined in accordance with the overall quaternion norm given by \cref{eq:quat_norm}:
$$ \mathscr{N}_v(\vec{h}) = h_1^2 - h^2_2 - h^2_3. $$
The above expression is the Lorentz norm on $\real^3$, the resulting vector space is denoted by $\real^{2, 1}$. \cite{Jafari2014} Observe that this quadratic form is not positive-definite either; in the the same veign as before, we can therefore classify quaternions by the `sign' of their vector part again. We refer to these classes as \emph{timelike (vectors)}, \emph{spacelike (vectors)} and \emph{lightlike (vectors)} in the same way. As such, we can identify a grand total of \emph{nine} categories for split-quaternions, based on each possible combination of quaternion and vector norm `sign' (these can be chosen completely independent from each other). This classification is important because, as discussed in \cref{sec:system_classification}, this classification is precisely equivalent to the qualitative classification of dynamic systems.
 
\subsection{Relation with two-dimensional matrix algebra}
The algebra of split-quaternions is isomorphic to the algebra of real two-dimensional matrices. This fact underlies this entire chapter, for it allows us to find an alternative for the traditional matrix description of linear dynamical systems. 

Formally, an algebra is a vector space combined with a vector space $V$ over a field \field, combined with an addition operation, scalar multiplication, and an \field-bilinear product operation $V\times V \to V$. \cite{Schuller2014}
\begin{itemize}
    \item The split-quaternion algebra is an algebra over the field real numbers ($\field = \real$), where the multiplication is governed by the split-quaternion multiplication rules (see \cref{tab:quat_table}).
    \item The set of $2\times2$-matrices also constitutes an \real-vector space; matrix multiplication makes it into an algebra.
\end{itemize}
An algebra isomorphism is a bijective map between vector sp

\section{Classification of qualitative system behaviour}
\label{sec:system_classification}

\section{Notes}
! orthogonal refers to `regular' orthogonal, Lorentz-orthogonal makes the distinction.

Motivation: $\vec{u}$ seems to be `aligned' with major direction of the elliptic trajectory in the Lorentz-orthogonal subspace, generated by the action of its cross-product. Show this formally by making use of the eigenvectors.

The basis vectors $ \qty{\vec{e}_2, \vec{e}_3}$, where $\vec{e}_2$ is the orthogonal projection of the vector $\vec{e}_1 = \uvec{u}$ on its Lorentz-orthogonal subspace, and $\vec{e}_3 \triangleq \lorcrossp{\vec{e}_1}{\vec{e}_2}$, form the real and imaginary parts of two of the eigenvectors of the matrix $\mat{U}_{\lorcrossp{}{}}$. 

Because the basis vectors $\vec{e}_2$ and $\vec{e}_3$ are also orthogonal in the Euclidean sense, the 

\begin{proof}
    Let $\uvec{u} = u_1\uvec{i} + u_2\uvec{j} + u_3\uvec{k}$. A normal vector to the Lorentz-orthogonal subspace is $
    \uvec{n} = u_1\uvec{i} - u_2\uvec{j} - u_3\uvec{k}$. Then, the basis vectors are
    \begin{equation}
        \begin{split}
            \vec{e}_2 &= 
            \uvec{u} - \frac{ \inner{\uvec{u}}{\uvec{n}} }{ \inner{\uvec{n}}{\uvec{n}} } \uvec{n} \\
            \vec{e}_3 &= \lorcrossp{\uvec{u}}{\vec{e}_2} = -\frac{ \inner{\uvec{u}}{\uvec{n}} }{ \inner{\uvec{n}}{\uvec{n}} } \qty(\lorcrossp{\uvec{u}}{\uvec{n}}),
        \end{split}
    \end{equation}
    because the Lorentz-cross product distributes over addition and $\lorcrossp{\uvec{u}}{\uvec{u}} = \vec{0}$. The proposition above claims that $\vec{e}_2 + \ii\vec{e}_3$ is an eigenvector of the matrix $\mat{U}_{\lorcrossp{}{}}$. Hence, it must be the case that $\mat{U}_{\lorcrossp{}{}}(\vec{e}_2 + \ii\vec{e}_3) = \lambda(\vec{e}_2 + \ii\vec{e}_3)$, where $\lambda$ is then an eigenvalue of the matrix. This can be verified by replacing the action of $\mat{U}_{\lorcrossp{}{}}$ with the cross product. Plugging in the definition and exploiting the linearity of the Lorentz cross-product, we obtain:
    \begin{equation*}
        \begin{split}
            \lorcrossp{\uvec{u}}{\qty(\vec{e}_2 + \ii\vec{e}_3)} 
            &= \lorcrossp{\uvec{u}}{\vec{e}_2} +
        \ii\qty(\lorcrossp{\uvec{u}}{\vec{e}_3}) \\
            &= \vec{e}_3 + \qty(\lorcrossp{\uvec{u}}{\vec{e}_3})\ii \\ 
            &=\vec{e}_3 +  \qty(\lorcrossp{\uvec{u}}{\qty(\lorcrossp{\uvec{u}}{\vec{e}_2})})\ii \\
            &=\vec{e}_3 -  \frac{ \inner{\uvec{u}}{\uvec{n}} }{ \inner{\uvec{n}}{\uvec{n}} }\qty(\lorcrossp{\uvec{u}}{\qty(\lorcrossp{\uvec{u}}{\uvec{n}})})\ii.  \\
        \end{split}
    \end{equation*}
The triple cross-product expansion, or `Lagrange formula', relates the regular cross product to the corresponding dot product:
    $$ \vec{a}\times\qty(\vec{b}\times\vec{c}) = \vec{b}\:\inner{\vec{c}}{\vec{a}} - \vec{c}\:\inner{\vec{a}}{\vec{b}}. $$
This well-known identity generalizes (easily verified) to the Lorentzian counterpart of the cross- and inner products:
    $$ 
        \lorcrossp{\vec{a}}{\qty(\lorcrossp{\vec{b}}{\vec{c}})} 
       = \vec{b}\:\lorinner{\vec{c}}{\vec{a}} - \vec{c}\:\lorinner{\vec{a}}{\vec{b}}. 
    $$
Using the Lagrange formula, the above expression becomes
    \begin{equation*}
        \begin{split}
            & \vec{e}_3 - \frac{ \inner{\uvec{u}}{\uvec{n}} }{ \inner{\uvec{n}}{\uvec{n}} }\qty(\uvec{u}\,\lorinner{\uvec{u}}{\uvec{n}} - \uvec{n}\lorinner{\uvec{u}}{\uvec{u}})\ii \\
            & =\, \vec{e}_3 - \qty(\uvec{u}\,\frac{ \lorinner{\uvec{u}}{\uvec{n}} \, \inner{\uvec{u}}{\uvec{n}} }{ \inner{\uvec{n}}{\uvec{n}} } - \uvec{n}\frac{ \inner{\uvec{u}}{\uvec{n}} }{ \inner{\uvec{n}}{\uvec{n}} })\ii \\
            & =\, \vec{e}_3 - \qty(\uvec{u} - \uvec{n}\frac{ \inner{\uvec{u}}{\uvec{n}} }{ \inner{\uvec{n}}{\uvec{n}} })\ii \\
            & =\, \vec{e}_3 - \vec{e}_2\ii. 
        \end{split}
    \end{equation*}
    The latter is the scalar multiple of the vector $\vec{e}_2 + \vec{e}_3$ by $-\ii$ - hence, this is indeed an eigenvector of the corresponding matrix.
\end{proof}
Because $\vec{e}_2$ and $\vec{e}_3$ are also orthogonal in the normal sense, they are aligned with the major axes of the elliptic trajectories generated by the cross product. Hence, they can be used to find a basis of the invariant subspace which makes the trajectories identical to those in the phase plane.


