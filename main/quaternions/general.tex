\section{The algebra of split-quaternions}
In this section, we present the split-quaternion number system, its basic properties, and its relation with two-dimensional matrices.

\label{sec:general_quat}
\subsection{Basic properties of split-quaternions}
\label{ssec:quat_basics}
Like conventional quaternions, the split-quaternions form a number system that consists of linear combinations of four basis elements, which are denoted by 1, \quati, \quatj, and \quatk.\footnote
{Even though they behave similarly, the imaginary unit \(\ii\) is not to be confused with the split-quaternion basis element \quati, because they each belong to an entirely different number system.}
The multiplication operation for split-quaternions is associative but not commutative --- formally speaking, we are dealing with an algebraic structure called a \emph{noncommutative (unital) ring}. 

The multiplication table for the split-quaternion basis elements is shown in \cref{tab:quat_table}; multiplication of general split-quaternions follows from this table by distributivity. The set of split-quaternions is denoted by \spquaternions, since \quaternions is reserved for conventional quaternions.\footnote
{The set of (split-)quaternions `\(\mathbb{H}/\spquaternions\)' is named in honor of sir William Rowan Hamilton, who also developed the Hamiltonian formalism: the fruits of his work truly form the central theme in this thesis \cite{Stillwell2008}.}
\begin{table}[ht!]
    \centering
    \caption{Multiplication table for the split-quaternion algebra.}
    \label{tab:quat_table}
    \begin{tabular}{c|cccc}
        \toprule
        &         1      & \quati  & \quatj  & \quatk \\ 
        \midrule
        1       & 1      & \quati  & \quatj  & \quatk \\ 
        \quati  & \quati & -1      & \quatk  & -\quatj \\ 
        \quatj  & \quatj & -\quatk & 1       & -\quati \\ 
        \quatk  & \quatk & \quatj  & \quati  & 1 \\ 
        \bottomrule
    \end{tabular}
\end{table}
%<symbol: 1,\quati,\quatj,\quatk> <expl: Split-quaternion basis-elements> <tags: quaternions, letter>
%<symbol: \spquaternions> <expl: Split-quaternions> <tags: numbersets, quaternions>

The distinctive feature that sets split-quaternions apart from conventional quaternions resides in the diagonal elements of \cref{tab:quat_table}. For quaternions, all basis elements but 1 square to \(-1\), which is not the case for the split-quaternions (only \quati does). This is also the reason why split-quaternions are `split', for this difference in sign makes their norm (to be defined later) into an indefinite quadratic form. That is to say, whereas quaternions have a `metric signature' (in a very imprecise sense of the word metric) of \((+, +, +, +)\), the split-quaternions have \((+, +, -, -)\). The different metric signature makes the split-quaternion number system different from its conventional quaternion counterpart.

Importantly, the split-quaternion number system can also be seen as an \emph{algebra}; i.e. a four-dimensional vector space over the real numbers combined with the split-quaternion product operation. More specifically, the split-quaternions form a \emph{unital noncommutative associative algebra}.

\subsubsection{The dihedral group} 
On their own, the basis elements of the split-quaternions \(\qty{1, \quati, \quatj, \quatk}\) form a \emph{finite group} under multiplication, namely the \emph{dihedral group} \digroup{4}. This group represents all the symmetries of a square: the identity, a 90-degree rotation, and two reflections, as illustrated in \cref{fig:square_symmetry} \cite{Dummit2004}.
\begin{figure}[ht!]
    \centering
    \input{media/tikz/square_symmetry}
    \caption{The dihedral group \digroup{4} is the symmetry group of a square. This group is isomorphic to the group formed by \(1, \quati, \quatj\) and \quatk under multiplication.}
    \label{fig:square_symmetry}
\end{figure}
%<symbol: \digroup{n}> <expl: Dihedral group; symmetry group of an $n$-polygon> <tags: group, quaternions>

The structure of the dihedral group can be visualized by means of its \emph{cycle graph} in \cref{fig:cycle_graph}. Many important properties of the split-quaternion algebra and the applications in this chapter can be traced back to the shape of this cycle graph. One example is the `split' nature of the quaternions: the \quati-element generates an order-4 cycle, while \quatj and \quatk generate order-2 cycles. In contrast, the cycle graph for conventional quaternions is entirely symmetric for all these elements \cite{Dummit2004}.
\begin{figure}[h!]
    \centering
    \input{media/tikz/dihedral_group}
    \caption{The cycle graph of the dihedral group $\digroup{4}$. There are five cycles: one of order four which represents the rotations (or the element \quati) of the square, and four order-2 cycles, which are all the possible reflections. The colored element represents the identity.}
    \label{fig:cycle_graph}
\end{figure}

\subsubsection{Split-quaternion (total) norm} 
Similar to conventional quaternions, we make a distinction between the \emph{scalar} or \emph{real part} and the \emph{vector part} of a split-quaternion. For an arbitrary split-quaternion \(a \in \spquaternions\), \cite{Jafari2014}
\begin{equation}
     a = \quat{a_0}{a_1}{a_2}{a_3}
     \label{eq:spquaternion}
\end{equation}
the real part is 
\begin{equation}
    \scapart{a} \coloneq a_0,
\end{equation}
and the vector part is 
\begin{equation} 
    \vecpart{a} \coloneq \quatvec{a_1}{a_2}{a_3}.
\end{equation}
%<symbol: a> <expl: General split-quaternion> <tags: letter, quaternions> <sortkey: aa>
%<symbol: \scapart{a}> <expl: Scalar part of the split-quaternion $a$> <tags: letter, quaternions> <sortkey: a1>
%<symbol: a_0> <expl: Shorthand notation for $\scapart{a}$> <tags: letter, quaternions> <sortkey: a2>
%<symbol: \vecpart{a}> <expl: Vector part of the split-quaternion $a$> <tags: letter, quaternions> <sortkey: a3>
%<symbol: \vec{a}> <expl: Shorthand notation for $\vecpart{a}$> <tags: letter, quaternions> <sortkey: a4>
%<symbol: \uvec{a}> <expl: Unit vector (part)> <tags: letter, quaternions> <sortkey: a5>
%<symbol: \conj{a}> <expl: Split-quaternion conjugate of $a$> <tags: letter, quaternions>
%<symbol: \mathscr{N}(a)> <expl: Squared total norm of $a$> <tags: misc, quaternions>
%<symbol: \norm{a}> <expl: Total norm of $a$> <tags: misc, quaternions>
%<symbol: \mathscr{N}(\vec{a})> <expl: Squared vector norm of $a$> <tags: misc, quaternions>
%<symbol: \norm{\vec{a}}> <expl: Vector norm of $a$> <tags: misc, quaternions>

%<symbol: \lorinner{\,}{}> <expl: Lorentzian inner product> <tags: misc, quaternions>
%<symbol: \lorcrossp{}{}> <expl: Lorentzian cross product> <tags: misc, quaternions>
%<symbol: \inner{\,}{}> <expl: Euclidean inner product> <tags: misc, quaternions>

%<symbol: \phi> <expl: Ring / algebra isomorphism between real $(2\times 2)$-matrices and split-quaternions> <tags: misc, quaternions>

%<symbol: \Re> <expl: Real part (complex number)> <tags: misc, quaternions>
%<symbol: \Im> <expl: Imaginary part (complex number)> <tags: misc, quaternions>

%<symbol: \zeta> <expl: Damping ratio> <tags: greek, quaternions>

Because the vector part and real part are used so often in this chapter, we adopt a more convenient shorthand notation for them, instead of $\scapart{}$ and $\vecpart{}$. Given any split-quaternion, the real part is denoted by the same symbol with a subscript of 0, without having to explicitly define the split-quaternion components as we did in \cref{eq:spquaternion}. In addition, the vector part is denoted by the symbol of the split-quaternion, but set in \textbf{boldface}. For instance, for the split-quaternion $b$, we denote its real part by $b_0 \coloneq \scapart{b}$ and its vector part by $\vec{b} \coloneq \vecpart{b}$. An alternative expression for $b$ is then
\begin{equation}
     b = b_0 + \vec{b}.
\end{equation}

In addition, every split-quaternion has a unique \emph{conjugate} split-quaternion, which has the same real part but the opposite vector part:
\begin{equation}
    \begin{split}
     \conj{a} &\coloneq \scapart{a} - \vecpart{a} \\
              &= a_0 - \vec{a}  \\
              &= a_0 - a_1\quati - a_2\quatj - a_3\quatk.
     \end{split}
\end{equation}

Using the conjugate, we can define the \emph{squared split-quaternion norm}:
\begin{equation}
    \mathscr{N}:\;\spquaternions \to \real:\;\;\mathscr{N}(a) \coloneq a\conj{a} = a_0^2 + a_1^2 - a_2^2 - a_3^2. 
    \label{eq:quat_norm}
\end{equation}

The split-quaternion norm is (in stark contrast to the norm defined for quaternions) \emph{indefinite}: it can be positive, negative or zero. Split-quaternions can therefore be categorized into three regimes based on the sign of their squared norm. In the tradition of special relativity, these regimes are named as follows:
\begin{itemize}
    \item $a$ is \emph{timelike} if \( \mathscr{N}(a) > 0 \),
    \item $a$ is \emph{lightlike} if \( \mathscr{N}(a) = 0 \), 
    \item $a$ is \emph{spacelike} if \( \mathscr{N}(a) < 0 \).
\end{itemize}
Like the space of split-quaternions, Minkowski spacetime is also four-dimensional. However, the signature of the Minkowski metric is different from the split-quaternion signature: it is either \((-, +, +, +)\) or equivalently \( (+, -, -, -)\) depending on the sign convention one chooses to adhere to. The terminology (i.e. spacelike, timelike, lightlike) applies nonetheless \cite{Misner1970,Landau1971}.

Based on the squared split-quaternion norm, the \emph{split-quaternion norm} is defined as
\begin{equation}
     \norm{}:\, \spquaternions \to \complex: \;\: \norm{a} \coloneq \sqrt{\mathscr{N}(a)} = \sqrt{a_0^2 + a_1^2 - a_2^2 - a_3^2}.
\end{equation}
Because of the indefiniteness of $\mathscr{N}$, $\norm{a}$ is an imaginary number if $a$ is spacelike, for its squared norm is negative in that case.

\subsubsection{Vector norm}
Apart from the split-quaternion norm, we may also define a (squared) norm of the \emph{vector part} alone. The \emph{squared vector norm} is defined in accordance with the total squared split-quaternion norm given by \cref{eq:quat_norm}:
\begin{equation}
     \mathscr{N}(\vec{a}) = a_1^2 - a^2_2 - a^2_3.
     \label{eq:vector_norm}
\end{equation}
This is not an abuse of notation, for \(\vec{a}\) can be seen as a split-quaternion in its own right with the same vector part as \(a\) but with a zero scalar part. It is therefore a valid argument for the split-quaternion norm, and we can use the same function with no ambiguity. The \emph{vector norm} is then defined in accordance:
\begin{equation}
    \norm{\vec{a}} = \sqrt{\mathscr{N}(\vec{a})} = \sqrt{a_1^2 - a_2^2 - a_3^2}. 
\end{equation}

In the remainder of this chapter, the distinction between the squared norm of the entire split-quaternion and the squared norm of the vector part plays a crucial role. Therefore, we will refer to \(\mathscr{N}(a)\) as the squared \emph{total} norm, and to \(\mathscr{N}(\vec{a})\) as the squared \emph{vector} norm. Likewise, we refer to $\norm{a}$ as the \emph{total} norm, and to $\norm{\vec{a}}$ as the \emph{vector} norm of the split-quaternion $a$.

The quadratic form given in \cref{eq:vector_norm} is also not positive-definite. As a result, we can establish a classification based on the squared vector norm (instead of the squared total norm) as well:
\begin{itemize}
    \item \vec{a} is \emph{timelike} / $a$ has a timelike vector if $\mathscr{N}(\vec{a}) > 0$,
    \item \vec{a} is \emph{lightlike} / $a$ has a lightlike vector if $\mathscr{N}(\vec{a}) = 0$,
    \item \vec{a} is \emph{spacelike} / $a$ has a spacelike vector if $\mathscr{N}(\vec{a}) < 0$.
\end{itemize}

Because one can classify based on both the (squared) vector norm and the (squared) total norm, one may identify nine hypothetical cases, since each falls into one of three regimes. However, the squared vector norm is not completely independent from the squared total norm: observe that 
\begin{equation}
    \mathscr{N}(a) < 0\quad \Rightarrow \quad \mathscr{N}(\vec{a}) < 0,
\end{equation} 
which is to say that \emph{a spacelike split-quaternion always has a spacelike vector part}. The converse is not necessarily true. Furthermore, \emph{a lightlike split-quaternion must have a lightlike or spacelike vector part}, i.e.
\begin{equation}
    \mathscr{N}(a) = 0 \quad \Rightarrow \quad \mathscr{N}(\vec{a}) \leq 0
\end{equation}
These two statements rule out three hypothetical combinations for the regimes of the total norm and the vector norm (spacelike - timelike, spacelike - lightlike and lightlike - timelike). Hence, six possible combinations remain; they are listed in \cref{tab:class_combinations}. 

\begin{table}[ht]
    \centering
    \caption{All the possible combinations of the regime of the split-quaternion and the regime of its vector part. Spacelike split-quaternions can only have a spacelike vector, while lightlike split-quaternions can only have lightlike or spacelike vector parts. The numbering of these cases coincides with the classification of dynamical systems in \cref{ssec:system_classification}.}
    \label{tab:class_combinations}
    \begin{tabular}{c|cccc}
        \toprule
        &  & \multicolumn{3}{c}{\( \mathscr{N}(\vec{a}) \)} \\[1mm]
        \hline
        & & & & \\[-1.7ex]
        &  & \emph{spacelike} & \emph{lightlike} & \emph{timelike} \\
        & \emph{spacelike} & \circled{1} & --- & --- \\
        & \emph{lightlike} & \circled{2} & \circled{3} & --- \\
        \multirow{-3}{*}{\( \mathscr{N}(a) \)} & \emph{timelike} & \circled{4} & \circled{5} & \circled{6} \\
        \bottomrule
    \end{tabular}
\end{table}
%As such, we can identify a grand total of \emph{nine} categories for split-quaternions, based on each possible combination of quaternion and vector norm `sign' (these can be chosen completely independent from each other). 

The importance of the classification in \cref{tab:class_combinations} will become relevant in \cref{ssec:system_classification}, where it is applied to the qualitative classification of dynamical systems.

In the remainder of this chapter, the split-quaternion properties that are defined above are used extensively. For the convenience of the reader, an overview of these properties and their definitions is provided in \cref{tab:spquat_properties}. 

\renewcommand{\arraystretch}{1.3}
\begin{table}[ht!]
    \centering
    \caption{Overview of the split-quaternion properties that are often used in this chapter.}
    \label{tab:spquat_properties}
    \begin{tabular}{llll}
        \toprule
        \textbf{Terminology} & \textbf{Notation} & \textbf{Definition} & \textbf{Expression} \\
        \midrule
        Split-quaternion & \(a\) & &  \(a_0 + a_1\quati + a_2\quatj + a_3\quatk\) \\
        Conjugate split-quaternion &  \(\conj{a}\) & $ a - \vecpart{a} $ & \(a_0 - a_1\quati - a_2\quatj - a_3\quatk\)\\
        \midrule
        Scalar part & \(\scapart{a} = a_0\) & & \(a_0\) \\
        Vector part & \(\vecpart{a} = \vec{a}\) & & \(a_1\quati + a_2\quatj + a_3\quatk\) \\
        \midrule
        Squared (total) norm & \(\mathscr{N}(a)\) & \(a\conj{a}\) &  
        \(a_0^2 + a_1^2 - a_2^2 - a_3^2\) \\
        (Total) norm & \(\norm{a}\) & \(\sqrt{\mathscr{N}(a)}\) & \(\sqrt{a_0^2 + a_1^2 - a_2^2 - a_3^2}\) \\
        \midrule
        Squared vector norm & \(\mathscr{N}(\vec{a})\) & \( \vec{a}\conj{\vec{a}} \) & \( a_1^2 - a_2^2 - a_3^2 \) \\
        Vector norm & \(\norm{\vec{a}}\) & \(\sqrt{\mathscr{N}(\vec{a})}\) & \(\sqrt{a_1^2 - a_2^2 - a_3^2}\) \\
        \bottomrule
    \end{tabular}
\end{table}
\renewcommand{\arraystretch}{1}
 
\subsubsection{Lorentzian 3-space}
In contrast to the entire split-quaternion, the vector part of the split-quaternion does live in a space with a Lorentz structure, having three dimensions instead of four. In general, the \emph{Lorentzian $n$-space} is defined as the real vector $\real^n$ space equipped with the \emph{Lorentzian inner product}. 
\begin{equation}
     \lorinner{\vec{a}}{\vec{b}} \coloneq a_1b_1 - a_2b_2 - \ldots - a_nb_n, \qquad \vec{a}, \vec{b} \in \real^n.
     \label{eq:lorinner}
\end{equation}
Since the Lorentzian inner product has signature $(+, -, \ldots, -)$, the Lorentzian $n$-space is denoted by $\real^{1, n-1}$. For $n = 4$, the Lorentzian space is equal to \emph{Minkowski spacetime}, which forms the mathematical setting of the theory of special relativity. 

Based on the Lorentzian inner product\footnote
{
    Because the Lorentzian inner product fails to be positive definite, it is not strictly an inner product, but rather a \emph{pseudo-inner product}. Likewise, the Lorentzian norm is called a \emph{pseudonorm}.
}, the \emph{Lorentz norm} can be defined as follows:
\begin{equation}
    \norm{\vec{a}} = \sqrt{\lorinner{\vec{a}}{\vec{a}}},
\end{equation}
For the Lorentzian 3-space $\real^{1, 2}$, the Lorentzian norm coincides with the vector norm for split-quaternions defined in \cref{eq:vector_norm}. Hence, if the vector part of a split-quaternion is regarded as a three-dimensional object in its own right (rather than a split-quaternion with zero real part), it is an element of $\real^{1, 2}$. For this space, we view the split-quaternion basis elements $\quati, \quatj, \quatk$ as \emph{unit basis vectors} to distinguish the vector components.

Next to the Lorentzian inner product, we can also define a \emph{Lorentzian cross product}, which exists only for $\real^{1, 2}$. Given two vectors $\vec{a}, \vec{b}$, in $\real^{1, 2}$
their Lorentzian cross-product is defined as: \cite{Jafari2014}
\begin{gather}
        \lorcrossp{\vec{a}}{\vec{b}} \coloneq \det\mqty(-\quati & \quatj & \quatk \\ a_1 & a_2 & a_3 \\ b_1 & b_2 & b_3)  \\
            = \qty(a_3b_2 - a_2b_3)\quati + \qty(a_3b_1 - a_1b_3)\quatj + \qty(a_1b_2 - a_3b_1)\quatk,
        \label{eq:lorcross}
\end{gather}
where we have assumed $\quati, \quatj, \quatk$ as basis vectors.

The split-quaternion product can be concisely expressed in terms of the Lorentzian inner product and cross product. For two split-quaternions $a$ and $b$ with their respective vector parts $\vec{a}$ and $\vec{b}$, we have the following relation:
\begin{equation}
    ab = a_0 b_0 - \lorinner{\vec{a}}{\vec{b}} + a_0 \vec{b} + b_0 \vec{a} + \lorcrossp{\vec{a}}{\vec{b}}.
\end{equation}

\subsection{Relation with two-dimensional matrix algebra}
\label{ssec:quat_isomorphism}
In this section, we demonstrate how the split-quaternion algebra relates to the algebra of real $2\times2$-matrices.

\subsubsection{Algebra isomorphisms} 
Formally, an algebra is a vector space \(V\) over a field \field, combined with an \field-bilinear product operation \cite{Schuller2014}:
\begin{itemize}
    \item The split-quaternion algebra is an algebra over the field of real numbers (\(\field = \real\)), where the product operation is split-quaternion multiplication (see \cref{tab:quat_table});
    \item The \(2\times2\)-matrices also form an \real-vector space; the product operation is matrix multiplication.
\end{itemize}

An \emph{algebra isomorphism} is an isomorphism between vector spaces that also commutes with the respective product operations in both vector spaces. With slight abuse of notation, let  $\spquaternions$ and $\real^{2\times 2}$ denote the respective algebras of split-quaternions and matrices as well as the underlying sets. A map $\phi: \spquaternions \to \real^{2 \times 2}$ is  an algebra isomorphism if \cite{Lang2002}
\begin{enumerate}[label=(\roman*), align=left, leftmargin=1.5cm]
    \item \(\phi \) is a bijective mapping between $\spquaternions$ and $\real^{2\times 2}$ (as sets);
    \item \(\phi\) is linear with respect to the vector addition and $\real$-multiplication;   
    \item \(\phi\) commutes with the product operations for matrices and split-quaternions. For two split-quaternions $a, b$ and the corresponding matrices $\phi(a)$ and $\phi(b)$, this means that:
    \begin{equation}
        \phi(ab) = \phi(a)\phi(b).
    \end{equation}
\end{enumerate}

Because we are dealing with vector spaces, it is sufficient to map the basis elements of the split-quaternions to four linearly independent `basis' matrices, and show that the resulting matrices observe the same multiplication rules as defined in \cref{tab:quat_table}. Indeed, define the mapping \(\phi\) by 
\begin{equation}
    \begin{split}
        \phi: \: \spquaternions \to \real^{2\times2}: \quad &  
         1 \mapsto  \mqty(1 & 0 \\ 0 & 1) \qquad
        \quati \mapsto  \mqty(0 & 1 \\  -1 & 0) \\
        & \quatj \mapsto  \mqty(0 & 1 \\  1 & 0)\qquad 
        \quatk \mapsto  \mqty(1 & 0 \\  0 & -1). \\
    \end{split}
    \label{eq:basis_elements}
\end{equation}

It is easily verified that (i) these matrices span \(\real^{2\times2}\) and (ii) that the isomorphism commutes with the multiplication operation for split-quaternions and matrices (cf. \cref{tab:quat_table}). Due to the bilinearity of the product operation, any linear combination of the basis elements will therefore satisfy the rules as well. Hence, we have established an algebra isomorphism between the split-quaternions and the \(2\times 2\)-matrices. 

Based on the mapping \(\phi\) for the basis vectors, a general quaternion $a$ maps to:
\begin{equation}
    \phi(\quat{a_0}{a_1}{a_2}{a_3}) \quad = \quad \mqty(a_0 + a_3 & a_1 + a_2 \\ a_2 - a_1 & a_0 - a_3). 
    \label{eq:quat_isom}
\end{equation}
Likewise, the inverse mapping of an arbitrary matrix yields
\begin{equation}
    \phi^{-1}\mqty(b_0 & b_1 \\ b_2 & b_3) \quad = \quad \quat{\frac{b_0 + b_3}{2}}{\qty(\frac{b_1 - b_2}{2})}{\qty(\frac{b_1 + b_2}{2})}{\qty(\frac{b_0 - b_3}{2})}. 
    \label{eq:inv_quat_isom}
\end{equation}

\subsubsection{Relation between matrix and split-quaternion properties} 
A striking feature of the isomorphism \(\phi\) is that it maps the natural properties of the split-quaternion to the natural properties of the associated matrix. Given that \(A = \phi(a)\) with \(a \in \spquaternions\) and \(A \in \real^{2\times2}\), we have the following correspondence: 
\begin{itemize}
    \item The \emph{sum of matrices} corresponds to the \emph{sum of the split-quaternions}. If \(B = \phi(b)\), then
        \begin{equation}
            A + B = \phi(a + b).
        \end{equation}
    \item \emph{Matrix multiplication} corresponds to \emph{split-quaternion multiplication}:
        \begin{equation}
              AB = \phi(ab).
        \end{equation}
    \item The \emph{adjugate} of the matrix maps to the \emph{conjugate} of the split-quaternion:\footnote
        {The adjugate of a matrix is the transpose of its cofactor matrix \cite{Verhaegen2007}.}
        \begin{equation}
             \adjugate(A) = \phi(\conj{a}).
        \end{equation}
    \item The \emph{trace} of the matrix is equal to twice the \emph{real or scalar part} of the split-quaternion:
        \begin{equation}
             \frac{\trace(A)}{2} = \scapart{a} = a_0.
        \end{equation}
    \item The \emph{determinant} of the matrix is equal to the \emph{squared total norm} of the split-quaternion:
        \begin{equation}
              \det(A) = \mathscr{N}(a).
        \end{equation}
    \item The equivalence of the determinant and the split-quaternion norm suggests that the \emph{multiplicative inverse} of a split-quaternion does not always exist: it must be nonzero. In that case, it is clear that
        \begin{equation}
             \phi\qty(a^{-1}) = A^{-1} \qquad \mathscr{N}(a) \neq 0.
        \end{equation}
    The determinant property also shows us what the regime of the product of two split-quaternions is; this is shown in \cref{tab:multiplication_class}.
        \begin{table}[h!]
        \centering
        \caption{Regime transition under the action of split-quaternion multiplication. The timelike split-quaternions form a group under multiplication, the lightlike and spacelike split-quaternions do not: lightlike split-quaternions do not have an inverse and the spacelike split-quaternions are not closed.}
        \label{tab:multiplication_class}
        \begin{tabular}{c|ccc}
            \toprule
            \(\times\) & \emph{space} & \emph{light} & \emph{time} \\[1mm]
            \hline
            \emph{space} & time  & light & space \\
            \emph{light} & light & light & light \\
            \emph{time} &  space & light & time \\
            \bottomrule
        \end{tabular}
        \end{table}
    \item Importantly, the \emph{eigenvalues} of a $2\times2$-matrix $A$ can be expressed in terms of its trace and its determinant:
        \begin{equation}
             \lambda_A = \frac{\trace(A) \pm \sqrt{\trace^2(A) - 4\det(A)}}{2}.
        \end{equation}
        The argument of the square root in the above expression is equal to the \emph{negative of the squared vector norm} of \(a\). We therefore have:
        \begin{equation}
            \lambda_A = \frac{2a_0 \pm \sqrt{4 a_0^2 - 4\mathscr{N}(a)}}{2} = 
                a_0 \pm \ii\norm{\vec{a}},
            \label{eq:quat_eigvals}
        \end{equation}
        where $\norm{\vec{a}}$ is imaginary if $\vec{a}$ is spacelike. 
        Hence, the \emph{real part and the vector norm the split-quaternion coincide with the real and imaginary parts of the eigenvalues of the matrix}, where the latter is multiplied by the imaginary unit $\ii$. When the vector is either spacelike or timelike, the $\ii$ cancels, and the overall eigenvalue is real. This striking correspondence is the main reason for the benefits of the split-quaternion representation of dynamical systems, which is discussed in \cref{ssec:system_classification}.
\end{itemize}
%<symbol: \ii> <expl: Imaginary unit> <tags: letter, quaternions>
%<symbol: \jj> <expl: Hyperbolic unit> <tags: letter, quaternions>
%<symbol: \epsilon> <expl: Idempotent unit> <tags: greek, quaternions>

An overview of the correspondence between matrix and split-quaternion properties is given in \cref{tab:spquat_matrices}.

\renewcommand{\arraystretch}{1.3}
\begin{table}[ht!]
    \centering
    \caption{Overview of the correspondence between the algebra of split-quaternions and the algebra of \(2\times2\) matrices, given that \(A = \phi(a)\) and \(B = \phi(b)\). In the top section, we compare matrices to split-quaternions, which means that they are related by the isomorphism \(\phi\). The bottom section compares scalar properties: these are numerically equal.}
    \label{tab:spquat_matrices}
    \begin{tabular}{lc|cr}
    \toprule
        \multicolumn{2}{c}{\textbf{Matrix}} & \multicolumn{2}{c}{\textbf{Split-quaternion}} \\
    \midrule
        Sum      & \( A + B \)      & \( a + b\) & Sum \\
        Matrix product  & \( AB \)  & \( ab\) & Split-quaternion product \\
        Inverse  & \(A^{-1}\)       & \(a^{-1}\) & Inverse \\
        Adjugate & \(\adjugate(A)\) & \(\conj{a}\) & Conjugate \\
        \midrule
        Determinant & \(\det(A)\) & \(\mathscr{N}(a)\) & Squared norm \\
        Trace       & \(\frac{\trace(A)}{2}\) & \(a_0\) & Real / scalar part \\
        Eigenvalues \hspace{1.5cm} & \(\lambda_{A} \) & \( a_0 + \vec{a}\ii \) & Scalar part \& vector norm \\
    \bottomrule
    \end{tabular}
\end{table}
\renewcommand{\arraystretch}{1}

\section{Dynamical systems as split-quaternions}
\label{sec:system_classification}
In this section, we show how split-quaternions can be used to represent two-dimensional linear dynamical systems in their full generality. We start of in \cref{ssec:vf_algebra} by establishing the split-quaternion representation of a dynamical system. Subsequently, in \cref{ssec:system_classification} we show how the split-quaternion representation leads to a more convenient procedure for system classification. Finally, we exploit the split-quaternion properties to compute the solution of the corresponding dynamical system in \cref{ssec:exponential}.

\subsection{The Lie algebra of vector fields}
\label{ssec:vf_algebra}
A linear dynamical system is specified by a linear vector field on a vector space. In our context, the vector space is $\real^2$. Combined with the Lie bracket, these vector fields form a so-called \emph{Lie algebra}. We demonstrate in this section how the Lie algebra of vector fields can be specified in terms of split-quaternions.

\subsubsection{Lie algebras}
The split-quaternions form an associative, noncommutative unital algebra over the real numbers, which is isomorphic (as an algebra) to the algebra of $2\times 2$-matrices. Every associative algebra can be turned into a \emph{Lie algebra} by defining the \emph{Lie bracket} as the \emph{commutator} of the multiplication operator of the algebra\footnote{By definition, the multiplication operation is bilinear, and the commutator is alternating. The associative property is needed for the Jacobi identity to be satisfied, which is the third criterion for a Lie algebra \cite{bourbaki1975}.}. For the split-quaternion algebra, the Lie bracket is defined as
\begin{equation}
    \liebr{\,}{}:\, \spquaternions \times \spquaternions \to \spquaternions: \;\: [a, b] \coloneq ab - ba.
\end{equation}
In analogous fashion, we have the equivalent definition for the matrix algebra:
\begin{equation}
    \liebr{\,}{}:\, \real^{2\times 2} \times \real^{2\times 2} \to \real^{2\times 2}: \;\: [A, B] \coloneq AB - BA.
\end{equation}
Clearly, these Lie algebras are isomorphic.

The Lie algebras defined above are abstract, which is to say that they are not defined in terms of a specific Lie group. The Lie algebra of $2\times 2$-matrices combined with the bracket defined above is isomorphic to the Lie algebra $\glalg{2}{\real}$ (it is often even defined this way). These are the linear vector fields on a vector space: the vector field is a section of the tangent bundle, and the mapping that defines the section must preserve the linear structure of the vector space. 

The algebra $\glalg{2}{\real}$ is the Lie algebra of the general linear group $\glgroup{2}{\real}$, which is the group of all automorphisms of $\real^2$ (as a vector space). Hence, the elements of $\glgroup{2}{\real}$ are the infinitesimal automorphisms of that vector space. From the vector field perspective, the Lie bracket of vector fields $X$ and $Y$ is equal the \emph{Lie derivative} of $X$ with respect to $Y$:
\begin{equation}
    \liebr{X}{Y} = \lied{X}{Y}.
\end{equation}
If the bracket of $X$ and $Y$ vanishes, $X$ and $Y$ are said to \emph{commute}. If two vector fields commute, then the associated transformations (i.e. elements of $\glgroup{n}{\real}$) do so as well: it does not matter in which order the transformations are applied.
%<symbol: \liebr{\,}{}> <expl: Lie bracket> <tags: misc, quaternions>
%<symbol: \glgroup{n}{\real}> <expl: General linear group over $\real^n$> <tags: group, quaternions>
%<symbol: \glalg{n}{\real}> <expl: Lie algebra of the general linear group over $\real^n$> <tags: group, quaternions>
%<symbol: \slgroup{n}{\real}> <expl: Special linear group over $\real^n$> <tags: group, quaternions>
%<symbol: \slalg{n}{\real}> <expl: Lie algebra of the special linear group over $\real^n$> <tags: group, quaternions>
%<symbol: \spgroup{n}> <expl: Symplectic group group over $\real^n$> <tags: group, quaternions>
%<symbol: \spalg{n}> <expl: Lie algebra of the symplectic group group over $\real^n$> <tags: group, quaternions>
%<symbol: X_1, X_{\quati}, X_{\quatj}, X_{\quatk}> <expl: Vector fields associated with $1, \quati, \quatj, \quatk$> <tags: letter, quaternions>


\subsubsection{Basis vector fields}
Because of the isomorphism between the Lie algebra of split-quaternions and $\glalg{2}{\real}$, the linear vector fields (i.e. linear dynamical systems) on $\real^2$ can be represented by a split-quaternion. Since the linear vector fields are directly represented by a matrix, it suffices to map that matrix to a split-quaternion using \cref{eq:inv_quat_isom}. In particular, because we are dealing with a vector space (of vector fields) we can relate the split-quaternion basis elements each to a specific basis vector field. Any other linear vector field can then be constructed by taking linear combinations of these basis vector fields. 

\begin{figure}[ht!]
    \centering
    \input{media/tikz/basis_vectorfields}
    \caption{Basis vector fields corresponding to the basis elements of the split-quaternions.}
    \label{fig:basis_vf}
\end{figure}

The four basis vector fields and their integral curves are visualized in \cref{fig:basis_vf}.
\begin{itemize}
    \item The identity element 1 corresponds to the identity matrix; the associated vector field $X_1$ is given by $X_1 = x\pdv{}{x} + y\pdv{}{y}$, where $x$ and $y$ are coordinates for $\real^2$. These are \emph{infinitesimal dilations} of the plane. The integral curves are star-shaped.
    \item The element $\quati$ corresponds to the vector field $X_{\quati} = y\pdv{}{x} - x\pdv{}{y}$, which represents an \emph{infinitesimal circular rotation} (clockwise). The integral curves are concentric circles centered at the origin.
    \item The element $\quatj$ corresponds to the vector field $X_{\quatj} = y\pdv{x} + x\pdv{}{y}$, which represents an \emph{infinitesimal squeeze mapping} or \emph{infinitesimal hyperbolic rotations}. The integral curves are rectangular hyperbolae, whose asymptotes are the lines specified by the equations $x = y$ and $x = -y$.  
    \item Finally, $\quatk$ corresponds to the vector field $X_{\quatk} = x\pdv{x} - y\pdv{}{y}$. This vector field also represents an \emph{infinitesimal squeeze mapping} or \emph{hyperbolic rotation}, but the asympotes of the hyperbolae are the $x$- and $y$-axis instead.
\end{itemize}

\paragraph{Volume-preserving vector fields}
Importantly, $X_{\quati}$, $X_{\quatj}$ and $X_{\quatk}$ are \emph{volume-preserving transformations}: the vector fields are divergence-free. Any linear combination of these vector fields also preserves volume. Because the divergence of a linear vector field is equal to the trace of its matrix representation, these are all the matrices with \emph{zero trace}. As a result, the vector part of a split-quaternion (or a split-quaternion with zero real part) represents the volume-preserving component of the vector field. 

The volume-preserving linear transformations form a subgroup of $\glgroup{2}{\real}$: this is the special linear group $\slgroup{2}{\real}$. If represented as a matrix subgroup of $\glgroup{2}{\real}$, $\slgroup{2}{\real}$ consists of all the matrices with a determinant of 1. The associated algebra $\slalg{2}{\real}$ is isomorphic to the algebra of traceless matrices, or equivalently, the split-quaternions with no real part.

Because we are dealing with $\real^2$, the conservation of volume is the same as conservation of \emph{area} --- this is manifestly \emph{not} the case for higher dimensions.  Indeed, the special linear group $\slgroup{n}{\real}$ is isomorphic to the \emph{symplectic group} $\spgroup{n}$ only if $n = 2$. The associated Lie algebra $\spalg{2}$ comprises the volume-preserving vector fields, which are also called \emph{symplectic} or \emph{Hamiltonian}\footnote{In general, every symplectic vector field is Hamiltonian, but not the other way around. As a consequence of the Poincaré Lemma (a special case of the de Rham cohomology) these notions are identical for contractible spaces. Clearly, $\real^2$ falls under this category.}. The Hamiltonian function that generates each of these vector fields through the symplectic form $\omega = \wedgep{\dd{x}}{\dd{y}}$ is simply equal to the implicit equation of the integral curves. An overview of the split-quaternion - vector field correspondence and the Hamiltonian functions (if applicable) is given in \cref{tab:basis_vf}.

\begin{table}[ht!]
    \centering
    \caption{Vector field representation of the split-quaternion basis elements. The Hamiltonian is the function that generates the associated vector field through Hamilton's equations: $\dot{x} = \pdv*{H}{y}$ and $\dot{y} = -\pdv*{H}{x}$.}
    \label{tab:basis_vf}
    \begin{tabular}{ccccl}
        \toprule
        $\spquaternions$ &  $ \real^{2\times 2} $ & \textbf{Vector field} & \textbf{Hamiltonian} & \textbf{Transformation} \\
        \midrule
        $1$ & $\mqty(1 & 0 \\ 0 & 1) $ & $\displaystyle x\pdv{}{x} + y\pdv{}{y} $ & --- & Dilation \\[0.4cm]
        $\quati$ & $\mqty(0 & 1 \\ -1 & 0) $ & $\displaystyle y\pdv{}{x} - x\pdv{}{y} $ & $ \tfrac{1}{2}\qty(x^2 + y^2) $ & Clockwise rotation \\[0.4cm]
        $\quatj$ & $\mqty(0 & 1 \\ 1 & 0) $ & $\displaystyle y\pdv{}{x} + x\pdv{}{y} $ & $ \tfrac{1}{2}\qty(y^2 - x^2) $ & Squeeze mapping \\[0.4cm]
        $\quatk$ & $\mqty(1 & 0 \\ 0 & -1) $ & $\displaystyle x\pdv{}{x}  -y\pdv{}{y} $ & $ xy $ & Squeeze mapping \\[0.4cm]
        \bottomrule
    \end{tabular}
\end{table}

\paragraph{Commuting vector fields}
The \emph{center} of a Lie algebra consists of all those elements for which the Lie bracket operation produces zero, \emph{regardless} of which other algebra element is the second argument. For $\glalg{2}{\real}$, these are all the scalar multiples of the identity, which are the split-quaternions that have \emph{no vector part}. For this reason, the real part and vector part of the split-quaternion coincide with a natural decomposition of the associated vector field into a volume/area preserving component of the vector field, and the infinitesimal increase (or decrease) in volume. These components can be considered \emph{independently}, precisely because the associated transformations commute.

\subsection{System classification with split-quaternions}
\label{ssec:system_classification}
In this section, we demonstrate how the properties of the split-quaternion representation can be exploited to classify the associated dynamical system in a convenient and exhaustive manner. In system theory, the classification of a linear dynamical system gives one an idea about the overall qualitative behavior of the system solution. Moreover, this practice is vital for the study of nonlinear systems too: the linearization of a nonlinear system around one of its fixed points replicates in many cases the correct behavior (cf. the Hartman-Grobmann theorem) \cite{Khalil2015}. This means that qualitative findings derived from the linearized system remain to be true --- at least locally --- for the nonlinear system as well.

Consider the linear dynamical system given by the differential equation
\begin{equation}
    \dot{\vec{x}} = A\vec{x} \qquad A \in \real^{2\times 2},
    \label{eq:dynamical_system}
\end{equation}
where $A$ is the \emph{state matrix}; we henceforth denote the associated split-quaternion by $a \coloneq \phi^{-1}(A)$. Usually, (the fixed point of) a linear dynamical system is classified based on the eigenvalues of $A$ into one of several categories:
\begin{itemize}[nosep,label=-]
    \item saddle point,
    \item source or sink,
    \item spiral,
    \item center,
    \item ...
\end{itemize}
Other types of fixed points may arise when $A$ has one or more zero eigenvalues. As will become clear, it are especially those degenerate cases which are handled remarkably well by the split-quaternion representation, i.e. without being considered exceptions to the rule.

The classification procedure using the split-quaternion representation makes use of three properties (cf. \cref{ssec:quat_isomorphism}): 
\begin{enumerate}[label=(\roman*), align=left, leftmargin=1.5cm]
    \item The regime of the squared total norm $\mathscr{N}(a)$, equal to the determinant of $A$;
    \item The regime of the squared vector norm $\mathscr{N}(\vec{a})$, equal to the square of the imaginary part of the eigenvalues of $A$;
    \item The regime of the real part $a_0$, equal to half the trace of $A$.
\end{enumerate}
The classic \emph{Poincare diagram} can be restated in terms of split-quaternion properties, as shown in \cref{fig:poincare_diagram}. For the split-quaternion representation, this diagram classifies based on the regime (i.e. sign) of both the total and vector norm, and the real part which determines stability in some cases.

\begin{figure}[ht!]
    \centering
    \input{media/tikz/poincare_diagram}
    \caption{The split-quaternion Poincaré diagram is based on the regime combinations defined in \cref{tab:class_combinations}. The determinant axis coincides with the squared norm of the split quaternion being 0. The parabolic double stroke line corresponds to the split-quaternions with zero \emph{vector} norm. 
    A further distinction is made with the scalar part of the split-quaternion, which, for each of the regimes, determines (asymptotic) (in)stability.}
    \label{fig:poincare_diagram}
\end{figure}

However, the classification in \cref{fig:poincare_diagram} is not completely exhaustive, for it does not distinguish between the degenerate cases if $\mathscr{N}(\vec{a}) = 0$.
We will therefore discuss all the regime combinations listed in \cref{tab:class_combinations} and the corresponding class of dynamical systems in more detail (adhering to the same numbering scheme).

\subsubsection*{Spacelike total norm}
    \begin{itemize}
        \item[\circled{1}] For spacelike split-quaternions, there is only one possibility: a negative split-quaternion norm corresponds to a negative determinant, which means that the fixed point is a \emph{saddle point}. We can distinguish one particular case: if the scalar part of the split-quaternion is zero (\(a_0 = 0\)), the saddle is balanced and generates a proper \emph{squeeze mapping}, which is a symplectomorphism of the phase space. The split-quaternion is therefore Hamiltonian. An example of the latter is the linearization of the unstable fixed point of a rotational pendulum.
    \end{itemize}

\subsubsection*{Lightlike total norm}
    \begin{itemize}
        \item[\circled{2}] \emph{Spacelike vector norm}: in this case, there is not just a single fixed point but an entire fixed line in the phase space. This fixed line is stable or unstable depending on the sign of $a_0$. 
        \item[\circled{3}] \emph{Lightlike vector norm}: this case is degenerate to the second degree; it coincides with the origin in the Poincaré diagram. The associated vector field is purely translational. An example is an object in uniform motion.
    \end{itemize}
\subsubsection*{Timelike total norm}
    \begin{itemize}
        \item[\circled{4}] \emph{Spacelike vector norm}: this case gives rise to eigenvalues that are purely real; the fixed point is called a \emph{node}. Depending on the sign of the scalar part, the fixed point can be an unstable node or \emph{source} (\(a_0 > 0\)) or a stable node or \emph{sink} (\(a_0 < 0\)). An example of such a system is the overdamped harmonic oscillator.
        \item[\circled{5}] \emph{Lightlike vector norm}: in this case, the two eigenvalues are equal to each other. This can be easily seen from \cref{eq:quat_eigvals}: 
            \begin{equation}
                \lambda_A = a_0 \pm \norm{\vec{a}}\ii = a_0\qquad a_0 \neq 0,
            \end{equation}
        i.e. both eigenvalues are equal to the real part of a \emph{if} $\norm{\vec{a}} = 0$. 
        %From the perspective of the matrix, we have
        %\begin{equation}
        %    \mathscr{N}(\vec{a}) = \det\qty(A - \frac{\tr A}{2} I).
        %\end{equation}
        If the squared vector norm vanishes, the null space of the matrix $A - a_0 I$ is

        There are then two subcategories to be distinguished, corresponding to whether the associated matrix is diagonalizable or not:
        \begin{enumerate}[label=(\alph*)]
            \item If the matrix is diagonalizable, it \emph{must} be a scalar multiple of the identity \cite{Edwards2018}. This is because the rank of the matrix \( A - \lambda I\) must be equal to 0 for the eigenspace to be two-dimensional; \( A - \lambda I\) i.e. the zero matrix. The corresponding split-quaternion is then \emph{purely real}; i.e. \(a = \lambda\). Because it has no vector part, the vector is then lightlike in the most trivial fashion. The associated fixed point is a \emph{star}, which can either be stable or unstable depending on the sign of the real part (this particular case is not shown in \cref{fig:poincare_diagram}). 
            \item Conversely, if \emph{the vector norm is zero but the vector part is not}, the matrix is not diagonalizable: the null space of \(A - \lambda I\) is one-dimensional, and can therefore not be spanned by two independent eigenvectors. The fixed point is an \emph{improper node}, which is again stable or unstable depending on the sign of the real part.
            An example of this type of system is the critically damped harmonic oscillator.
            %the eigenvalues of the associated matrix are real and equal; this type of fixed point is named a \emph{degenerate node}. More specifically, in the unstable case (\(a_0 > 0\)) it is called a \emph{degenerate source}, while in the stable case it is referred to as a \emph{degenerate sink}. An example is a critically damped harmonic oscillator. 
        \end{enumerate}
        \item[\circled{6}] \emph{Timelike vector norm}: this is the case where the eigenvalues of \(A\) are complex. If \(a_0 = 0\), the eigenvalues are imaginary and the fixed point is a \emph{center}. Again, for \(a_0 > 0\) it is an \emph{unstable spiral node} and for \(a_0 < 0\) a \emph{stable spiral node}. An example is an underdamped (or even undamped) harmonic oscillator.
    \end{itemize}

It is clear from the present discussion that the split-quaternions offer a very natural representation of linear dynamical systems, in particular because of the relation between the split-quaternion norms and real part, and the eigenvalues of the state matrix. All six cases are again summarized in \cref{tab:system_classification}.

\begin{table}[ht]
    \centering
    \caption{Overview of the classification of fixed points based on the regime of the associated split-quaternion and its vector part.}
    \label{tab:system_classification}
    \begin{tabular}{llll}
        \toprule
        \textbf{\#} & \(\mathscr{N}(a)\) & \(\mathscr{N}(\vec{a})\) & \textbf{Fixed point} \\
        \midrule
            \circled{1} & \emph{spacelike} & \emph{spacelike} & Saddle\\ 
            \midrule
            \circled{2} & \emph{lightlike} & \emph{spacelike} & Line \\ 
            \circled{3} & \emph{lightlike} & \emph{lightlike} & Uniform motion \\ 
            \midrule
            \circled{4} & \emph{timelike} &  \emph{spacelike}  & Source / sink \\ 
            \circled{5} & \emph{timelike} &  \emph{lightlike}  & Degenerate node \\ 
            \circled{6} & \emph{timelike} &  \emph{timelike}   & Spiral node / center \\ 
        \bottomrule
    \end{tabular}
\end{table}


\subsection{The exponential function of split-quaternions}
\label{ssec:exponential}
In order to obtain the system solution, one usually computes the matrix exponential of the state matrix $A$. In this section, we demonstrate that the same can be done for the split-quaternion representation, which has some computational advantages. The exponential function for split-quaternions is defined in an analogous fashion to its matrix equivalent, i.e. in terms of a Taylor-like series:
\begin{equation}
     \exp:\:\spquaternions \to \spquaternions:\:\; \exp(a) \coloneq \sum_{k=0}^\infty \frac{a^k}{k!}.
\end{equation}
Because this definition is completely analogous to the one for matrices, the exponentials in the split-quaternion domain or the matrix domain are equivalent, given the isomorphism $\phi$ defined by \cref{eq:quat_isom}:
\begin{equation}
     \exp(a) = \phi^{-1}(\exp(\phi(a))).
\end{equation}
In this expression, the `exp' on the left hand side refers to the split-quaternion exponential, while the `exp' on the right is the matrix exponential.

To evaluate the exponential function of a split-quaternion, let us first use the following property of the (split-quaternion) exponential\footnote{This is a consequence of the Baker-Campbell-Haussdorf formula, which applies to Lie algebras in general.} \cite{Hall2013}
\begin{equation}
    \liebr{a}{b} = 0 \quad \Rightarrow \quad \exp(a + b) = \exp(a)\exp(b),
\end{equation}
i.e. we can only decompose the exponential of a sum if the two elements \emph{commute}. We can regard an arbitrary split-quaternion
\begin{equation}
     a = \quat{a_0}{a_1}{a_2}{a_3}
\end{equation}
as the sum of the real part \(a_0\) and the vector part \(\quatvec{a_1}{a_2}{a_3}\). As discussed in \cref{ssec:vf_algebra}, the real part is distinguished from the other three parts in the sense that it commutes with every other element. As a result, we have:
\begin{equation}
     \exp(a) \, = \,\ec^{a_0}\,\exp(\quatvec{a_1}{a_2}{a_3}).
\end{equation}
It is important to emphasize that this is \emph{not} possible for the other individual vector components, since $\quati$, $\quatj$ and $\quatk$ do \emph{not} commute with each other. We therefore only have to be concerned with the evaluation of \(\exp(\vec{a})\). To do so, recall that we can consider the vector part of a split-quaternion to be a split-quaternion in its own right, but with zero real part. We, have by definition, that \( \conj{\vec{a}} = -\vec{a} \), which means that the squared vector norm is simply the negative of the square of the vector part, i.e.:
\begin{equation}
     \mathscr{N}(\vec{a}) = \vec{a} \conj{\vec{a}} = -\vec{a}^2.
\end{equation}

Let us now introduce the concept of \emph{unit split-quaternion vectors}, which are vector split-quaternions with a vector norm of \(\pm 1\). The unit vector may be obtained by normalization of the vector part:
\begin{equation}
     \hat{\vec{a}} = \frac{\vec{a}}{\sqrt{\abs{\mathscr{N}(\vec{a})}}}, \qquad \mathscr{N}(\vec{a}) \neq 0,
\end{equation}
which squares to
\begin{equation}
     \hat{\vec{a}}^2 = - \mathscr{N}(\hat{\vec{a}}) 
                   = - \frac{\mathscr{N}(\vec{a})}{\abs{\mathscr{N}(\vec{a})}} 
                   = - \sgn(\mathscr{N}(\vec{a})), \qquad \mathscr{N}(\vec{a}) \neq 0.
\end{equation}

Normalizing lightlike vectors is not possible, because they have all the same length of zero: there is no point in making the distinction between vector and unit vector. 

Based on the regime of the vector part, three possibilities arise: \cite{Motter1998,Harkin2004}
\begin{itemize}
    \item If \(\vec{a}\) is timelike, then \(\uvec{a}^2 = -1\). We can therefore say that the unit vector `behaves' like the imaginary unit \(\ii\) (\(\ii^2 = -1\)). In general, we can identify the split-quaternion (with timelike vector part) \( a_0 + \norm{a}\uvec{a}\) with the \emph{complex number} \(a_0 + \norm{\vec{a}}\ii\). 
    \item If \(\vec{a}\) is lightlike, then \(\vec{a}^2 = 0\), and the notion of the unit vector is not well-defined. Because the vector is nilpotent with degree 2, it is analogous to the nilpotent unit \(\epsilon\) (for which we have that \(\epsilon^2 = 0\)). Split-quaternions with timelike vector part can be identified with the \emph{dual number} \(a_0 + \epsilon\). 
    \item Finally, if \(\vec{a}\) is spacelike, then \(\uvec{a}^2 = 1\). The unit vector behaves like the idempotent unit \(\jj\), with defining property \(\jj^2 = 1\) (\(\jj \notin \real\)!).\footnote
        {Again, we must take care not to confuse the hyperbolic unit with the split-quaternion basis element \(\quatj\). They behave the same and are related in the sense that they give rise to `split' behavior, but are part of a very different number systems.}
        Likewise, a split-quaternion with spacelike vector part is analogous to the \emph{split-complex number} (or hyperbolic number) \(a_0 + \norm{\vec{a}}\jj\).
\end{itemize}

The connection between split-quaternions and the generalized complex numbers\footnote
{For a more detailed account of generalized complex numbers, the reader is referred to \citet{Harkin2004}.}
(i.e. complex, dual and split-complex)
sheds some additional light on the behavior of the eigenvalues of the associated matrix \(A\) by means of the root locus plot (see \cref{eq:quat_eigvals}). A typical branch of the  root locus consists of a complex pole pair approaching the real axis when the gain is increased. When they finally collide on the real axis, they each go their opposite ways on the real axis, essentially breaking the symmetry with respect to the real axis. 

In contrast, the split-quaternions and their relation with hypercomplex numbers paint a slightly more elegant picture, which is shown in \cref{fig:root_locus}:
\begin{itemize}
    \item As shown above, when the pole pair is complex, the associated split-quaternion vector is timelike. The eigenvalues are naturally conjugate with respect to the real axis, i.e.
        \begin{equation}
             \lambda_A = a_0 \pm \norm{\vec{a}}\ii.
        \end{equation}
    \item When the pole pair collides on the real axis (often called the \emph{branch point}), the imaginary part of the eigenvalue is zero, and the vector is lightlike. Observe that we can make the case that, because the branches continue separately afterward, they cannot be \emph{exactly} the same. Indeed, the eigenvalues are
        \begin{equation}
             \lambda_A = a_0 \pm \epsilon.
        \end{equation}
        The nilpotent unit \(\epsilon\) is often interpreted as a differential, or an infinitesimally small quantity.\footnote{A common application of dual numbers is automatic differentiation: because higher powers vanish, they can be used to generate first-order polynomial approximations. The unit `circle' for dual numbers consists of two vertical lines crossing the horizontal axis at \(\pm 1\). These lines can again be interpreted as linear approximations of the actual unit circle (or unit hyperbola) associated with (split-)complex numbers. The plane is spanned by the \(\jj\)-axis and the real axis is the split-complex plane. The `projection' to the real axis is in this plane a reflection with respect to the light cone (first diagonal).} We argue that, in this case, the pole pair is still conjugate, but the poles differ only by an infinitesimal amount.
    \item When the gain is increased even further, the poles are real and the symmetry with respect to the real axis is broken. However, we can infer from the preceding discussion that the imaginary part is now hyperbolic instead, i.e.
        \begin{equation}
             \lambda_A = a_0 \pm \norm{\vec{a}}\jj.
        \end{equation}
        Of course, it is possible to project these points on the real axis, but this obscures the natural symmetry of the root locus branch. In \cref{fig:root_locus}, we therefore place the hyperbolic part on a third axis.
\end{itemize}

\begin{figure}[ht]
    \centering
    \input{media/tikz/root_locus}
    \caption{A generalized version of a root locus plot in terms of hypercomplex numbers. The traditional root locus is set in the complex \(s\)-plane (shown in blue), but we added a third axis for the hyperbolic part of the eigenvalue. When the gain is increased, the initially complex pole pair ventures towards the real axis. If the pole pair is critically damped, both poles are separated from the real axis by an infinitesimal distance of \(\epsilon\). Increasing the gain even more pushes the pole pair into the hyperbolic regime (the associated split-quaternion vector is now spacelike). Observe that in this picture, the symmetry with respect to the real axis is preserved. In the traditional root locus, these points are projected onto the real axis, indicated by the dashed lines. }
    \label{fig:root_locus}
\end{figure}

Let us now return to the exponential function. We can manipulate the definition of \(\exp(a)\) as follows:
\begin{equation*}
    \begin{split}
        \exp(a) &= \ec^{a_0}\;\qty(\sum_{k=0}^\infty \frac{\vec{a}^k}{k!} ) \\
                &= \ec^{a_0}\;\qty[\sum_{k=0}^\infty \frac{\qty(\vec{a}^2)^k}{(2k)!}  + \sum_{k=0}^\infty \frac{\vec{a}\qty(\vec{a}^2)^k}{(2k+1)!}]. \\
    \end{split}
\end{equation*}
Furthermore, if \(\vec{a}\) is not lightlike, we have:
\begin{equation*}
    \exp(a) = \ec^{a_0}\;\qty[\sum_{k=0}^\infty \frac{\norm{\vec{a}}^{2k}\, \qty(\uvec{a}^2)^k}{(2k)!}  + \uvec{a}\sum_{k=0}^\infty \frac{\norm{\vec{a}}^{2k+1} \, \qty(\uvec{a}^2)^k}{(2k+1)!}].
\end{equation*}
Once again, there are three possibilities, depending on the regime of \(\vec{a}\):
\begin{itemize}
    \item If \(\vec{a}\) is \emph{timelike}, then the above expression reverts to
        \begin{equation}
            \begin{split}
                \exp(a) &= \ec^{a_0}\qty[\sum_{k=0}^\infty \frac{\norm{\vec{a}}^{2k}\,\qty(-1)^k}{(2k)!} + \uvec{a}\sum_{k=0}^\infty \frac{\norm{\vec{a}}^{2k+1} \, \qty(-1)^k}{(2k+1)!}], \\
                        &= \ec^{a_0}\qty\big[\cos(\norm{\vec{a}})  + \uvec{a}\sin(\norm{\vec{a}})]. \\
            \end{split}
        \end{equation}
        This is roughly equivalent to the Euler identity for complex numbers. 
    \item Secondly, if \(\vec{a}\) is \emph{lightlike}, we can simply use the definition of the exponential in its original form:
        %\footnote{We can also use the `split' expression, defining that \(0^0 \equiv 1\), a common convention in power series and algebra. Observe that the trigonometric functions associated with the dual numbers (i.e. the lightlike vectors) are then equal to the small-angle approximation for \(\sin\) and \(\cos\) \cite{Graham1994, Harkin2004}.}
        \begin{equation}
            \begin{split}
                \exp(a) &= \ec^{a_0}\,\sum^{\infty}_{k=0} \frac{\vec{a}^k}{k!}, \\
                        &= \ec^{a_0}\qty[1 + \vec{a} + \sum^{\infty}_{k=2} \frac{\vec{a}^{k-2}\vec{a}^2}{k!}], \\
                        &= \ec^{a_0}\qty(1 + \vec{a}). \\
            \end{split}
        \end{equation}
    \item Finally, if \(\vec{a}\) is \emph{spacelike}, we have
        \begin{equation}
            \begin{split}
                \exp(a) &= \ec^{a_0}\qty[\sum_{k=0}^\infty \frac{\norm{\vec{a}}^{2k}}{(2k)!} 
                           + \uvec{a}\sum_{k=0}^\infty \frac{\norm{\vec{a}}^{2k+1}}{(2k+1)!}], \\
                        &= \ec^{a_0}\qty\big[\cosh(\norm{\vec{a}}) + \uvec{a}\sinh(\norm{\vec{a}})]. \\
            \end{split}
        \end{equation}
\end{itemize}

The dynamical system given in \cref{eq:dynamical_system} has the following solution \cite{Arnold1984}
\begin{equation}
    \vec{x}(t) = \exp(At)\vec{x}_0 = \phi\big(\exp(at)\big)\vec{x}_0\qquad t \in \real^+,
\end{equation}
where the exponential of $at$ takes the following value: 
\begin{equation}
    \exp(a t) = 
    \begin{cases}
        \phantom \quad \ec^{a_0 t}\qty[\cos(\norm{\vec{a}} t) + \uvec{a}\sin(\norm{\vec{a}} t)] & \vec{a} \text{ timelike}, \\[1.5ex]
        \phantom \quad \ec^{a_0 t}\qty(1 + \norm{\vec{a}}t ) & \vec{a} \text{ lightlike}, \\[1.5ex]
        \phantom \quad \ec^{a_0 t}\qty[\cosh(\norm{\vec{a}} t) + \uvec{a}\sinh(\norm{\vec{a}} t)] & \vec{a} \text{ spacelike}. \\[1.5ex]
    \end{cases}
    \label{eq:system_solution}
\end{equation}

Computing the split-quaternion exponential instead of the traditional matrix exponential avoids the need for either generalized eigenvectors (in the degenerate case) and/or complex eigenvectors, which arguably offers a computational advantage. 

In the next section, we replace the general dynamical system by a mechanical system so as to give the split-quaternion representation a physical interpretation.

