\chapter{Damped harmonic oscillator}
In their most traditional fashion, the Hamiltonian and Lagrangian treatments of mechanical systems do not incorporate energy dissipation; that is, they assume the conservation of (mechanical) energy in the system. The classical theory does allow for an optional explicit time-dependence of the Hamiltonian and Lagrangian, but although this may allow one to incorporate dissipation, it is no direct solution for the dissipation problem. Although this may seem odd from the perspective of the engineering field, where dissipation really is the rule rather than the exception, dissipation is arguably not of primary concern for physicists. This is because dissipation is considered to be a \emph{macro-phenomenon}; that is, it arises because one chooses not to model certain degrees of freedom in the system, while physicists are often concerned with ideal system descriptions on the macro-scale. Nonetheless, the celebrated report by \citet{Dekker1981} provides an overview of the (often fruitful) attempts that have been made to include dissipation in the Hamiltonian and Lagrangian description; the former may allow one to consider dissipation on the quantum level as well --- this is beyond the scope of this text. In addition to these methods, recent developments in the economic engineering group have proposed two new methods to deal with linear damping in mechanical systems, see \citet{Hutters2020a} and \citet{Mendel2021}. In the following section, these methods are placed in a slightly more rigorous (read: geometric) context, after which they serve as the apparatus for the Liouville equation on the damped harmonic oscillator.

\section{Dissipative classical mechanics: an overview}
\begin{figure}[ht]
    \centering
    \input{media/tikz/damper_oscillator}
    \caption{Schematic of the damped harmonic oscillator.}
    \label{fig:dho}
\end{figure}

The damped harmonic oscillator considered in this text is the one that features a damper `in parallel' with the spring, as shown in \cref{fig:dho}. The corresponding second-order differential equations are:\footnote{Although a linear potential force is assumed here, this treatment generalizes to any potential function $U = U(q, t)$ that does not involve the generalized velocity in a straightforward manner.}
\begin{equation}
    \dv{}{t}\mqty(q\\\dot{q}) = \mqty(0 & 1/m\\-k/m & -b/m)\mqty(q\\\dot{q}) \quad \text{or}\quad m\ddot{q} + b\dot{q} + kq = 0.
    \label{eq:dho}
\end{equation}
The state-transition matrix has eigenvalues
$$ \lambda = \frac{1}{2}\qty(-\frac{b}{m}\pm\sqrt{\qty(\frac{b}{m})^2 - 4\frac{k}{m}}) $$
which is often expressed in `polar coordinates', using the \emph{damping ratio} $\zeta$ and the \emph{undamped natural frequency} $\Omega$:
$$ \lambda = -\Omega \qty(\zeta \pm \ii\sqrt{1 - \zeta^2}) $$
Moreover, the system is assumed to be underdamped, or equivalentl $\zeta < 1$. Solutions are then of the form
$$ $$

\section{Lagrangian mechanics}
\label{sec:mendel_lagrangian}
The method proposed by \citet{Mendel2021} is closely related to the time-dependent Caldirola-Kanai Hamiltonian (as mentioned, the corresponding Lagrangian was already devised by Bateman in 1931 \cite{Bateman1931, Dekker1981}). However, there are some important differences: the time-dependent method takes the dissipation into account simply wrapping the Lagrangian with an exponential discount function so as to include the real part of the eigenvalues into the solution.
\towrite{discuss contribution}

This approach for Lagrangian systems to damped systems (the prototypical example here is, of course, the damped harmonic oscillator) revolves around the definition of a nonstandard Lagrangian function on an extended configuration space. Instead of only position $q$, the extended configuration space is a pair that fixes both position and time. The extended space is denoted by $M$, consequently $m \in M$ has natural coordinates $(q, t)$. Hence, whereas the standard configuration manifold is one-dimensional, it is now two-dimensional, which means the corresponding tangent and cotangent bundles are four-dimensional\footnote{The inclusion of time into the configuration space (or phase space in the Hamiltonian context) is a recurring theme in many important works for various reasons. For example \citet[p. 90]{Arnold1989} uses it to apply the Noether theorem to time-invariance, while \cite[p. 332]{Burke1985} uses it to treat time-dependent systems as if they were time-independent (this is essentially equivalent to the method given here). As is discussed later in this section, \citet{Dirac1950} touches upon it in his discussion of homogeneous Lagrangians and the Legendre transform thereof.}.

Because $t$ defines the configuration of the system, it is not an independent coordinate; that is, it can be varied at will. The independent coordinate is denoted by $\tau$, also referred to as the `path indexation variable', for that is its only significance. \citet{Mendel2021} calls this \emph{proper time} as a testament to its parallel in the theory of special relativity \cite{Landau1971}.

Traditionally, Lagrangian mechanics is staged in the tangent bundle to the configuration manifold. The notation used in this section is something of a delicate matter, sinds the traditional dot notation for tangent vectors usually refers to the actual time $t$, not $\tau$. It is considered undesirable to break with this convention, which is why the tangent velocity vectors with respect to the $q$ and $t$-coordinate are denoted by $v_q$ and $v_t$ respectively. Hence, the tangent bundle at issue has the chart-induced coordinates $(q, t, v_q, v_t)$. As \citet{Burke1985} points out, for (proper) time-dependent systems, it is more natural to look at the contact bundle $\contact{M}$ rather than the tangent bundle $\tangent{M}$ because it makes it possible to deal with the explicit $\tau$-dependence directly\footnote{Intuitively, one can think of a contact bundle as a `homogenized' version of a tangent bundle. When two submanifolds are in contact, it means their tangent spaces coincide locally; tangency is a stronger condition that also involves the \emph{magnitude} of the tangent vectors. A \emph{contact element} is an equivalence class of submanifolds in contact at a point. A \emph{contact bundle} is the manifold of points in the underlying base manifold, each paired with a contact element.}. Hence, consider the line-element contact bundle $C\!Q$ with projection map $\pi$,
$$ C\!M \xrightarrow{\pi} M \quad\text{with}\quad \pi: (\tau, q, t, v_q, v_t) \mapsto (\tau, q, t). $$
The idea is, again, now to establish a differential ideal (like in \cref{ssec:ho_liouville_solution}) whose integral manifolds are the solution trajectories of the damped harmonic oscillator system. Although it is not specifically required to use this approach, it helps to sort out some delicacies that appear in taking derivatives that would otherwise be concealed as a consequence of ambiguities in the Leibniz notation.

There are seven forms that constitute the differential ideal: two define the contact structure, two define the system dynamics and one defines a constraint that ties $t$ and $\tau$ together.
\paragraph{Contact structure} Two 1-forms, $\alpha_1$ and $\alpha_2$ define the contact structure. Roughly speaking, they provide the `bookkeeping' of the derivatives. The larger spaces $\contact{M}$ and $\tangent{M}$ essentially offer too much `freedom': not every curve in these spaces coincides to lifted version of the solution curve on $M$. Said otherwise, they guarantee tangency (or contact) when the solution trajectory is brought down to the configuration manifold. These 1-forms are:
    \begin{equation} 
        \begin{split}
            \alpha_1 &= \dd{q} - v_q\dd{\tau}\\
            \alpha_2 &= \dd{t} - v_t\dd{\tau}.
        \end{split}
    \end{equation}
    \paragraph{System dynamics} The mechanics of the system are enforced by two additional 1-forms $\beta_1$ and $\beta_2$. This is where the `proper' Lagrangian comes in to play. The proper Lagrangian $L$ is defined as a discounted version of the naive Lagrangian $L$ which one would use for an undamped system by taking the difference of the kinetic and potential energy of the system. The naive Lagrangian is equal to $$ L_0 = \frac{1}{2}m\dot{q}^2 - \frac{1}{2}kq^2. $$
    However, as a consequence of the extended phase space $\dot{q}$ does not represent a generalized velocity. By means of the chain rule, it can readily be expressed as a function of $v_q$ and $v_t$:
    $$ \dot{q} = \frac{v_q}{v_t}, $$
    which allows to take derivatives with respect to the chosen coordinates of $\contact{M}$. The proper Lagrangian $L$ is defined as:
        $$ L:\,\tangent{M}\to\real:\;L(q, t, v_q, v_t) \equiv v_t \; L_0(q, t, v_q, v_t), $$
    that is, the naive Lagrangian is `discounted' by $v_t$. The term discounting is used here because the solution of $v_t$ will turn out to be an exponential, which makes it analogous to the practice of discounting in economics and finance. As stated by \citet{Burke1985}, these `mechanical' 1-forms have the general form
    \begin{equation}
        \begin{split}
            \beta_1 &= \dd{\qty(\pdv{L}{v_q})} - \pdv{L}{q}\dd{\tau}, \\
            \beta_2 &= \dd{\qty(\pdv{L}{v_t})} - \pdv{L}{t}\dd{\tau}. \\
        \end{split}
    \end{equation}
    To find these $\beta$'s, one must therefore evaluate the appropriate partial derivatives of the Lagrangian. First, the conjugate momenta can be obtained by taking the partial derivative of the Lagrangian with respect to both generalized velocities. Firstly, 
    \begin{equation}
        \pdv{L}{v_q} = v_t \pdv{L_0}{\dot{q}}\pdv{\dot{q}}{v_q} = v_t m \qty(\frac{v_q}{v_t}) \frac{1}{v_t} = m\dot{q} \equiv p,
        \label{eq:dho_lag_v_q}
    \end{equation} 
    which means that the momentum conjugate to $v_q$ is \emph{equal to the classical notion of momentum} $p = m\dot{q}$.
    Secondly,
    \begin{equation}
        \begin{split}
            \pdv{L}{v_t} &= L_0 + v_t\pdv{L_0}{v_t} = L_0 + v_t\pdv{L_0}{\dot{q}}\pdv{\dot{q}}{v_t} \\
                         &= L_0 - v_t\pdv{L_0}{\dot{q}}\frac{v_q}{v_t^2} = -\frac{1}{2}m\dot{q}^2 - \frac{1}{2}kq^2 \equiv W,
            \label{eq:dho_lag_v_t}
        \end{split}
    \end{equation}
    i.e. the momentum conjugate to $v_t$ is the negative of the total mechanical energy of the system\footnote{This is precisely how \citet{Arnold1989} demonstrates the conservation of energy as a consequence of Noether's theorem applied to Lagrangians invariant under time translations.}. When added to an appropriate constant for the initial mechanical energy, $W$ yields the total work dissipated by the damper. The `force' terms are less involved, for they have only a dependence on a single coordinate:
    \begin{equation}
        \pdv{L}{q} = -kq \quad\text{and}\quad \pdv{L}{t} = 0. 
        \label{eq:dho_lag_force}
    \end{equation}
    Taking exterior derivatives of \cref{eq:dho_lag_v_q} and \cref{eq:dho_lag_v_t}, the mechanical 1-forms can be obtained:
    \begin{equation}
        \begin{split}
            \beta_1 &= \frac{m}{v_t}\dd{v_q} - \frac{v_q}{v_t^2}\dd{v_t} + kq\dd{\tau} \\
            \beta_2 &= \qty(\frac{v_q}{v_t})\frac{m}{v_t}\dd{v_q} - \qty(\frac{v_q}{v_t})\frac{m v_q}{v_t^2}\dd{v_t} + kq\dd{q}.
        \end{split}
    \end{equation}

\paragraph{Constraint equation}
Finally, the damping structure of the system is encoded in the `discount rate' of time $t$ with respect to proper time, given by the 1-form
    \begin{equation}
        \phi = \dd{t} - \frac{\dd{\tau}}{\lambda \tau}.
    \end{equation}
This 1-form is, for all intents and purposes, `embarrassingly integrable' --- it provides a direct one-to-one relation between $t$ and $\tau$, and therefore represents a proper time-dependent holonomic (rheonomic) constraint on the system.

\paragraph{Solution of the exterior system}

\begin{aside}{Naive solution}
    The key insight of the method resides in the evaluation of the second time derivative. Use the `second derivative chain rule' from \citet{Bartlett2019}:
    $$ \dv{}{x}\qty(\dv{y}{x}) = \dv[2]{y}{x} - \dv{y}{x}\dv[2]{x}{x}, $$
    where it is important to keep in mind that when $x$ is not the independent variable, the second term is not necessarily equal to 0.
    Hence, evaluating the `momentum' term of the Euler-Lagrange equation,
    $$ \dv{}{\tau}\qty(\dv{q}{t}) = v_t \dv{}{t}\qty(\dv{q}{t}) = v_t\qty(\ddot{q} + \gamma \dot{q}) $$

\end{aside}

\clearpage
\subsection{Harmonic oscillator with parallel and serial damper}
A harmonic oscillator with a damper and spring in series and additional parallel damper is depicted by \cref{fig:ddho}. Here, the damping coefficients of the parallel and serial dampers are denoted by $b_s$ and $b_p$ respectively. Because of the serial damper, an additional degree of freedom in terms of position arises; these are expressed in terms of the coordinates $q_1$ and $q_2$. However, because there is no mass attached to $q_1$ and no spring to $q_2$, the system exhibits coupled first-order dynamics, which may be rewritten as a second-order equation for $q_1$.
\begin{figure}
    \centering
    \input{media/tikz/double_damped_oscillator}
    \label{fig:ddho}
    \caption{Harmonic oscillator with parallel and serial damper.}
\end{figure}
The equations of motion are:
\begin{equation}
    \dv{}{t}\mqty(q_1\\\dot{q}_2) = \mqty(-\lambda_s & 1\\ -\omega_n^2 & -\lambda_p)\mqty(q_1\\\dot{q}_2).
    \label{eq:ddho}
\end{equation}
By taking the time derivative of the first equation and performing the appropriate substitution, a second-order differential equation in $q_1$ can be obtained as well:
\begin{equation}
    0 = \ddot{q}_1 + (\lambda_s + \lambda_p)\dot{q}_1 + (\omega_n^2 + \lambda_p\lambda_s)q_1, 
\end{equation}
which may be regarded as an equivalent parallel system with an adjusted value for the damping and spring constants.

\subsubsection{As the algebra of split-quaternions}
The algebra of $2\times2$ matrices is isomorphic to the algebra of split-quaternions. Expressing the matrix given by \cref{eq:ddho} as a split-quaternion  



\section{Legendre transform}
\label{sssec:mendel_legendre}
The usual story in classical mechanics professes that the Lagrangian representation is equivalent to the Hamiltonian representation, which are connected through the so-called Legendre transform. From a geometric perspective, the Legendre transform switches the Lagrangian function on the tangent bundle in favour of the Hamiltonian function on the cotangent bundle, or vice versa. Along with the transformed function, the associated \emph{variational problem} in the Lagrangian setting converts to the integration of the Hamiltonian vector field generated by the Hamiltonian function. In physics, the deeper signifance of the Legendre transform is often discarded in favour of the expression $\dot{q}^ip_i - L$, which only holds when the Lagrangian is strictly convex, or hyperregular, and assuming on-the-fly that $p_i \equiv \partial L/\partial\dot{q}^i$. In this text a more geometric approach is taken in accordance with \citet{Abraham1978}, where the concept of the `fiber derivative' if favoured over the Legendre transform. For well-behaved Lagrangians the traditional notion of the fiber derivative and the Legendre transform coincide; but if not, there are some subtle complications that are relevant for this discussion. 

As mentioned, the Legendre transform (or fiber derivative) `preserves information' --- that is, it is involutive and unique --- if the the function at issue is strictly convex. The Hessian of $\mathscr{L}$ with respect to the generalized velocities is
$$ \mqty(\pdv[2]{L}{\dot{q}}{v_q} & \pdv[2]{L}{\dot{q}}{v_t} \\ \pdv[2]{L}{\dot{q}}{v_t} & \pdv{}{v_t}\qty(L - \pdv{L}{\dot{q}}\dot{q}) ) = \mqty(\pdv[2]{L}{\dot{q}}{v_q} & \pdv[2]{L}{\dot{q}}{v_t} \\ \pdv[2]{L}{\dot{q}}{v_t} & -\pdv[2]{L}{\dot{q}}{v_t}\dot{q}) = \mqty(\pdv{p}{v_q} & \pdv{p}{v_t} \\ \pdv{p}{v_t} & -\pdv{p}{v_t}\dot{q}) $$
such that the determinant of this Hessian is
$$ \pdv{p}{v_q}\dot{q}\,\pdv{p}{v_t} - \qty(\pdv{p}{v_t})^2\; \stackrel{\footnotemark}{=}\; \qty(\pdv{p}{v_t})^2 - \qty(\pdv{p}{v_t})^2 = 0, $$
\footnotetext{Because $\displaystyle \pdv{p}{v_q}\dot{q}=\pdv{p}{v_t}\pdv{v_t}{\dot{q}}\pdv{\dot{q}}{v_q}\dot{q} = \pdv{q}{v_t}\frac{-v_q}{\dot{q}^2}\frac{1}{v_t}\dot{q} = -\pdv{p}{v_t}$.}i.e. the Hessian is singular and has one vanishing eigenvalue; because the other eigenvalue is positive (the trace of the Hessian can be shown to be positive if $v_t$ is), the Hessian is positive semidefinite. This prevents one to easily effect the Legendre transform of $\mathscr{L}$, for this Hessian is the Jacobian of the fiber derivative $\mathbb{F}\mathscr{L}$, which means that the fiber derivative does not provide a bijective mapping beteen the tangent and cotangent bundles (cf. the implicit function theorem). For the damped harmonic oscillator, the fiber derivative results in
\begin{equation}
    \begin{split}
        p \equiv&\,\pdv{\mathscr{L}}{v_q} = m\frac{v_q}{v_t} \\
        W \equiv&\,\pdv{\mathscr{L}}{v_t} = -\frac{1}{2}\qty(m\qty(\frac{v_q}{v_t})^2 + kq^2).
    \end{split}
    \label{eq:fiber_derivative_dho}
\end{equation}

\Cref{eq:fiber_derivative_dho} shows that there is no unique way to assign the velocity pair $(v_q,\,v_t)$ to a conjugate momentum pair $(p, W)$ through the fiber derivative. Indeed, as discussed by \citet[p. 122]{Cannas2001}, \emph{strict convexity} of a function $\mathscr{L}$, that is, the Hessian of $\mathscr{L}$ be positive definite, is required for the Legendre transform to be a diffeomorphism between $TQ$ and $\cotangent{Q}$. The root of this issue can be found in the fact that $p$, $W$ only depend on $\dot{q}$, which fixes only the relative proportion between $v_q$ and $v_t$ --- roughly speaking, it acts on the \emph{projectivization} of the cotangent space, as shown in \cref{fig:fiber_derivative}.
\begin{figure}[h]
    \centering
    \input{media/tikz/fiber_derivative}
    \label{fig:fiber_derivative}
    \caption{Graphical illustration of the singularity of the Lagrangian. The fiber derivative provides a pointwise mapping between the cotangent space $T_xQ$, where $x = (q,\,t)$, and the cotangent bundle $T^*_x\!Q$, but this mapping is neither injective nor surjective. The mapping $\mathbb{F}\mathscr{L}$ acts injectively on the projectivization of the tangent space --- in this case, $\real^2 / \sim$, where $\sim$ denotes the equivalence relation $(v_q, v_t) \sim (\lambda v_q, \lambda v_t) $ ---  it takes the equivalence classes $[v_q : v_t]$ as an argument. Furthermore, the image of the entire tangent space is restricted to a parabolic subset of the cotangent space.}
\end{figure}

All of this boils down to the fact that the fiber derivative/Legendre transform is unable to express the transformed Lagrangian function completely in terms of the coordinates of the cotangent bundle. In this case, the Lagrangian function is called \emph{degenerate} or \emph{singular}; Lagrangians for which the fiber derivative produces a global diffeomorphism are called \emph{hyperregular} \cite[p. 236]{Abraham1978}.

An additional observation is that the Lagrangian $\mathscr{L}$ is \emph{homogeneous of the first degree} in the generalized velocities $v_q$ and $v_t$; i.e. multiplication of all velocities by a factor $\lambda$ is equal to multiplying the Lagrangian itself by that factor (to the `first power', hence the first degree). This is, as discussed by \citet{Abraham1978} and \citet{Dirac1950}, a classical example of a singular Lagrangian. This makes the homogeneous Lagrangian function subject to the Euler theorem (on homogeneous functions); which means that the Lagrangian is a linear combination of its partial derivatives with respect to the generalized velocities \cite{Dirac1950}. Given that the Lagrangian is homogeneous, the Euler theorem asserts that
$$ \mathscr{L} = v_q \pdv{\mathscr{L}}{v_q} + v_t \pdv{\mathscr{L}}{v_t} = v_q p + v_t W. $$
Substitution by the found expressions for $p$ and $W$ indeed recovers the original definition of the discounted Lagrangian. The point is though, that the above is \emph{precisely} equal to the duality pairing that is used for the Legendre transform; as such, a `naive' Legendre transform $v_q p + Wv_t - \mathscr{L}$ will simply vanish in the strong fashion. Hence, according to the Dirac method,
$$ H = v\phi $$
where $\phi$ is the first-order constraint
$$ W + \frac{1}{2m}p^2 + \frac{1}{2}kq^2 = 0 $$

\begin{aside}{Singular Lagrangians and the Dirac method}
    As mentioned, singular Lagrangians are Lagrangians for which the mass matrix
    $$ \qty[\pdv{\mathscr{L}}{\dot{q}_i}{\dot{q_j}}]$$
    is rank-deficient. With slight abuse of notation, $L$ denotes a general Lagrangian and $\dot{q}$ the corresponding generalized velocities. This prevents one from finding the corresponding Hamiltonian representation in the traditional fashion using the Legendre transform, since this entire process hinges on the above Hessian to provide a bijective mapping between the tangent and cotangent spaces (pointwise), that is, to find a mapping between velocities and momenta. Paul Dirac developed a method to overcome this problem, as discussed by \citet{Dirac1950}, \citet{Kunzle1969}, and \citet{Cisneros-Parra2012}. It is interesting to note that the last author considers degeneracy to be a property reserved for `artificial' Lagrangians; by which he means those which do not correspond to real mechanical systems. This claim is, of course, refuted by the Mendel approach given in this text.

    Because of the singularity of the Hessian, there must be a number of conditions on the conjugate momenta such that there remains an additional dependence between the conjugate momenta:
    $$ \phi_k(\vec{p}, \vec{q}, t) = 0. $$
    Using Dirac's method, the resulting Hamiltonian is of the form: \cite{Cisneros-Parra2012}
    $$ H = H_0 + \sum_k v_k \phi_k, $$
    where $H_0$ denotes the `naive' Hamiltonian found by taking a straightforward Legendre transform, and $v_k$ new independent variables (i.e, additional coordinates of the cotangent space as to span its entirety). Aside from the \emph{primary restrictions} $\phi_k$, the Dirac method also imposes a consistency condition of the form 
    $$ \dot{\phi}_k = 0, $$
    from which the \emph{secondary restrictions} are obtained.

    Make sure to read \url{https://en.wikipedia.org/wiki/First_class_constraint#Geometric_theory} for a geometric interpretation.

    NOTE: Max uses `vanish identically', is the same as strong/weak equality by Dirac
\end{aside}

The Lagrangian 1-form is the pullback of the tautological 1-form under the fiber derivative. Lagrangian 1-form and 2-form, economic interpretation: market elasticities. Lagrange 2-form contains the market elasticities, quite literally the geometric encoding of the corresponding bond graph.
    
\subsection{Hamiltonian mechanics}
\label{sssec:mendel_hamiltonian}
In this section, the method proposed by \citet{Mendel2021} is used to deal with the problem of dissipative systems in the framework of Hamiltonian mechanics. The prototypical example that is the harmonic oscillator with a linear (parallel) damping element. As noted, using a time-dependent Hamiltonian to include dissipative mechanics is not quite a new idea (cf. \citet{Dekker1981}), but the salient point here is the \emph{symplectization} of the contact structure that normally underlies such a system. That is to say, there is an additional dimension on top of $p, q, t$ to allow the manifold to be symplectic in the first place. For the damped harmonic oscillator, this boils down to a 2-dimensional configuration manifold $Q$ with coordinates $(q,\,t)$, with at each point attached a cotangent space which contains elements of the form $\alpha\dd{q} + \beta\dd{t}$. To turn the cotangent bundle into a symplectic manifold by virtue of the bundle structure, define the tautological 1-form
$$ \alpha = p\dd{q} + W\dd{t} \quad \alpha \in \cotangent{(\cotangent{Q})},$$
from which the symplectic 2-form is obtained:
$$ \omega = -\dd{\alpha} = \wedgep{\dd{q}}{\dd{p}} + \wedgep{\dd{t}}{\dd{W}}.$$
This results in a four-dimensional symplectic manifold $(M, \omega)$. 

\subsection{Multi-degree of freedom systems}
As noted by \citet{Udwadia2013}, the general solution of the `inverse problem' in Lagrangian mechanics becomes quickly intractable if the number of degrees of freedom in the grows (although the Helmholtz equations theoretically guarantee a solution). For linear systems, this can be easily understood from simple ideas in linear systems theory (which is not mentioned in the work of \citet{Udwadia2013}). The differential equation of the matrix solution for a general mechanical system has the form:
$$ \mqty(\vec{q}\\\vec{\dot{q}}) = \mqty(0 & I \\ -M^{-1}K & -M^{-1}B) $$
where $M$, $K$ and $B$ are the mass matrix, stiffness matrix and damping matrix respectively. Now, finding the `exponential envelope' that is used in the Caldirola-Kanai style Lagrangians or Hamiltonians becomes a complicated matter in the general case: one needs to decouple the system into individual solutions, each with its discount factor. Naturally, this coincides precisely with an eigenvalue decomposition of the system, i.e.
$$ \mqty(\vec{q}\\\vec{p}) = T\exp(J)T^{-1}\mqty(\vec{q}_0\\\vec{p}_0). $$
If one assumes that all the system dynamics are underdamped and the matrix $A$ is simple, then the $J$ is diagonal with complex entries (each of which is paired with its complex conjugate). This is equivalent to a linear combinations of solutions $e^{\gamma t}\qty(c_1\cos(\Omega t) + c_2\sin(\Omega t))$. Theoretically, one can find a Lagrangian for all the decoupled parts, each with their own discount `envelope' to formulate the Lagrangian of the overall problem. Unfortunately, this is not possible in a closed-form fashion (only up to two degrees of freedom in general, for which it is the maximal polynomial order to which a closed form solution exist for the roots). One could however construct a `numerical Lagrangian', by computing the eigenvalues given the parameters. Of course, this does not make the solution of the ODE's easier, but it the Lagrangian itself can help to offer insights in the nature of the system.

\subsection{Complex Hamiltonian}
Coen's method
